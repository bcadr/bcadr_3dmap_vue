(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~1b36eebf"],{1331:function(e,t,a){"use strict";var i=a("77af"),n=a("2f63"),s=a("7d62"),r=a("e42d"),o=a("ac3b"),c=a("6ef5"),h=a("6dc0"),l=a("6c84"),_=a("a913"),u=a("3664");function d(){this._framebuffer=void 0,this._colorTexture=void 0,this._drawCommand=void 0}function f(e,t){var a=e._framebuffer,n=t.createViewportQuadCommand(u["a"],{framebuffer:a,renderState:h["a"].fromCache({viewport:new i["a"](0,0,256,256)})});e._drawCommand=n}function b(e,t){var a=new _["a"]({context:t,width:256,height:256,pixelFormat:r["a"].RGBA,pixelDatatype:c["a"].UNSIGNED_BYTE,sampler:l["a"].NEAREST});e._colorTexture=a;var i=new o["a"]({context:t,colorTextures:[a],destroyAttachments:!1});e._framebuffer=i}Object.defineProperties(d.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),d.prototype.update=function(e){if(!Object(n["a"])(this._colorTexture)){var t=e.context;b(this,t),f(this,t),this._drawCommand.execute(t),this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),Object(s["a"])(this)},t["a"]=d},"141c":function(e,t,a){"use strict";var i={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};t["a"]=Object.freeze(i)},"1e82":function(e,t,a){"use strict";var i={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"};t["a"]=Object.freeze(i)},"2cc3":function(e,t,a){"use strict";var i=a("670c"),n=a("be18"),s=a("a561"),r=a("2bb9"),o=a("abab"),c=a("2f63"),h=a("7d62"),l=a("e42d"),_=a("b997"),u=a("6ef5"),d=a("6c84"),f=a("a913");function b(e,t,a){if(this._attributes=t,this._numberOfInstances=a,0!==t.length){var n=p(t),r=e.floatingPointTexture,o=n===u["a"].FLOAT&&!r,c=g(t,o),h=T(c,t,o),l=Math.floor(_["a"].maximumTextureSize/h),d=Math.min(a,l),f=h*d,b=Math.ceil(a/d),m=1/f,O=.5*m,A=1/b,v=.5*A;this._textureDimensions=new i["a"](f,b),this._textureStep=new s["a"](m,O,A,v),this._pixelDatatype=o?u["a"].UNSIGNED_BYTE:n,this._packFloats=o,this._offsets=c,this._stride=h,this._texture=void 0;var y=4*f*b;this._batchValues=n!==u["a"].FLOAT||o?new Uint8Array(y):new Float32Array(y),this._batchValuesDirty=!1}}function p(e){for(var t=!1,a=e.length,i=0;i<a;++i)if(e[i].componentDatatype!==o["a"].UNSIGNED_BYTE){t=!0;break}return t?u["a"].FLOAT:u["a"].UNSIGNED_BYTE}function m(e,t){var a=e[t].componentsPerAttribute;return 2===a?i["a"]:3===a?n["a"]:4===a?s["a"]:Number}function g(e,t){for(var a=new Array(e.length),i=0,n=e.length,s=0;s<n;++s){var r=e[s],c=r.componentDatatype;a[s]=i,c!==o["a"].UNSIGNED_BYTE&&t?i+=4:++i}return a}function T(e,t,a){var i=e.length,n=e[i-1],s=t[i-1],r=s.componentDatatype;return r!==o["a"].UNSIGNED_BYTE&&a?n+4:n+1}Object.defineProperties(b.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var O=new s["a"];function A(e,t,a){var i=s["a"].unpack(e,t,O),n=s["a"].unpackFloat(i);i=s["a"].unpack(e,t+4,O);var r=s["a"].unpackFloat(i);i=s["a"].unpack(e,t+8,O);var o=s["a"].unpackFloat(i);i=s["a"].unpack(e,t+12,O);var c=s["a"].unpackFloat(i);return s["a"].fromElements(n,r,o,c,a)}function v(e,t,a){var i=s["a"].packFloat(e.x,O);s["a"].pack(i,t,a),i=s["a"].packFloat(e.y,i),s["a"].pack(i,t,a+4),i=s["a"].packFloat(e.z,i),s["a"].pack(i,t,a+8),i=s["a"].packFloat(e.w,i),s["a"].pack(i,t,a+12)}var y=new s["a"];b.prototype.getBatchedAttribute=function(e,t,a){var i,n=this._attributes,r=this._offsets[t],o=this._stride,h=4*o*e+4*r;i=this._packFloats&&n[t].componentDatatype!==u["a"].UNSIGNED_BYTE?A(this._batchValues,h,y):s["a"].unpack(this._batchValues,h,y);var l=m(n,t);return Object(c["a"])(l.fromCartesian4)?l.fromCartesian4(i,a):Object(c["a"])(l.clone)?l.clone(i,a):i.x};var D=[void 0,void 0,new i["a"],new n["a"],new s["a"]],x=new s["a"];function S(e,t){var a=e._textureDimensions;e._texture=new f["a"]({context:t,pixelFormat:l["a"].RGBA,pixelDatatype:e._pixelDatatype,width:a.x,height:a.y,sampler:d["a"].NEAREST,flipY:!1})}function E(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}function C(e){var t=e._stride;return 1===e._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+t+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+t+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n"}function I(e){return 1===e?"float":"vec"+e}function N(e){return 1===e?".x":2===e?".xy":3===e?".xyz":""}function R(e,t){var a=e._attributes,i=a[t],n=i.componentsPerAttribute,s=i.functionName,r=I(n),c=N(n),h=e._offsets[t],l=r+" "+s+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+h+"); \n";return e._packFloats&&i.componentDatatype!==u["a"].UNSIGNED_BYTE?l+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":l+="    vec4 textureValue = texture2D(batchTexture, st); \n",l+="    "+r+" value = textureValue"+c+"; \n",e._pixelDatatype!==u["a"].UNSIGNED_BYTE||i.componentDatatype!==o["a"].UNSIGNED_BYTE||i.normalize?e._pixelDatatype===u["a"].FLOAT&&i.componentDatatype===o["a"].UNSIGNED_BYTE&&i.normalize&&(l+="value /= 255.0; \n"):l+="value *= 255.0; \n",l+="    return value; \n} \n",l}b.prototype.setBatchedAttribute=function(e,t,a){var i=this._attributes,n=D[i[t].componentsPerAttribute],r=this.getBatchedAttribute(e,t,n),o=m(this._attributes,t),h=Object(c["a"])(o.equals)?o.equals(r,a):r===a;if(!h){var l=x;l.x=Object(c["a"])(a.x)?a.x:a,l.y=Object(c["a"])(a.y)?a.y:0,l.z=Object(c["a"])(a.z)?a.z:0,l.w=Object(c["a"])(a.w)?a.w:0;var _=this._offsets[t],d=this._stride,f=4*d*e+4*_;this._packFloats&&i[t].componentDatatype!==u["a"].UNSIGNED_BYTE?v(l,this._batchValues,f):s["a"].pack(l,this._batchValues,f),this._batchValuesDirty=!0}},b.prototype.update=function(e){Object(c["a"])(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,Object(c["a"])(this._texture)||S(this,e.context),E(this))},b.prototype.getUniformMapCallback=function(){var e=this;return function(t){if(0===e._attributes.length)return t;var a={batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}};return Object(r["a"])(t,a)}},b.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(0===e.length)return function(e){return e};var t="uniform highp sampler2D batchTexture; \n";t+=C(this)+"\n";for(var a=e.length,i=0;i<a;++i)t+=R(this,i);return function(e){var a=e.indexOf("void main"),i=e.substring(0,a),n=e.substring(a);return i+"\n"+t+"\n"+n}},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),Object(h["a"])(this)},t["a"]=b},"30d2":function(e,t,a){"use strict";var i=a("daa2"),n={ZERO:i["a"].ZERO,ONE:i["a"].ONE,SOURCE_COLOR:i["a"].SRC_COLOR,ONE_MINUS_SOURCE_COLOR:i["a"].ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:i["a"].DST_COLOR,ONE_MINUS_DESTINATION_COLOR:i["a"].ONE_MINUS_DST_COLOR,SOURCE_ALPHA:i["a"].SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:i["a"].ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:i["a"].DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:i["a"].ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:i["a"].CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:i["a"].ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:i["a"].CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:i["a"].ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:i["a"].SRC_ALPHA_SATURATE};t["a"]=Object.freeze(n)},"3e44":function(e,t,a){"use strict";var i=a("77af"),n=a("670c"),s=a("be18"),r=a("a561"),o=a("bef8"),c=a("bd8d"),h=a("71ce"),l=a("535a"),_=a("2f63"),u=a("aee6"),d=a("52f0"),f=a("6dfc"),b=a("d4ed"),p=a("2d75"),m=a("f61d"),g=a("a307"),T=a("0c80"),O=a("05e5");function A(e,t){e=Object(l["a"])(e,l["a"].EMPTY_OBJECT);var a=e.translucencyByDistance,i=e.pixelOffsetScaleByDistance,r=e.scaleByDistance,o=e.distanceDisplayCondition;Object(_["a"])(a)&&(a=f["a"].clone(a)),Object(_["a"])(i)&&(i=f["a"].clone(i)),Object(_["a"])(r)&&(r=f["a"].clone(r)),Object(_["a"])(o)&&(o=u["a"].clone(o)),this._show=Object(l["a"])(e.show,!0),this._position=s["a"].clone(Object(l["a"])(e.position,s["a"].ZERO)),this._actualPosition=s["a"].clone(this._position),this._pixelOffset=n["a"].clone(Object(l["a"])(e.pixelOffset,n["a"].ZERO)),this._translate=new n["a"](0,0),this._eyeOffset=s["a"].clone(Object(l["a"])(e.eyeOffset,s["a"].ZERO)),this._heightReference=Object(l["a"])(e.heightReference,p["a"].NONE),this._verticalOrigin=Object(l["a"])(e.verticalOrigin,O["a"].CENTER),this._horizontalOrigin=Object(l["a"])(e.horizontalOrigin,m["a"].CENTER),this._scale=Object(l["a"])(e.scale,1),this._color=c["a"].clone(Object(l["a"])(e.color,c["a"].WHITE)),this._rotation=Object(l["a"])(e.rotation,0),this._alignedAxis=s["a"].clone(Object(l["a"])(e.alignedAxis,s["a"].ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=r,this._translucencyByDistance=a,this._pixelOffsetScaleByDistance=i,this._sizeInMeters=Object(l["a"])(e.sizeInMeters,!1),this._distanceDisplayCondition=o,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=Object(l["a"])(e.collection,t),this._pickId=void 0,this._pickPrimitive=Object(l["a"])(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;var d=e.image,b=e.imageId;Object(_["a"])(d)&&(Object(_["a"])(b)||(b="string"===typeof d?d:Object(_["a"])(d.src)?d.src:Object(h["a"])()),this._imageId=b,this._image=d),Object(_["a"])(e.imageSubRegion)&&(this._imageId=b,this._imageSubRegion=e.imageSubRegion),Object(_["a"])(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=g["a"].SCENE3D,this._clusterShow=!0,this._outlineColor=c["a"].clone(Object(l["a"])(e.outlineColor,c["a"].BLACK)),this._outlineWidth=Object(l["a"])(e.outlineWidth,0),this._updateClamping()}var v=A.SHOW_INDEX=0,y=A.POSITION_INDEX=1,D=A.PIXEL_OFFSET_INDEX=2,x=A.EYE_OFFSET_INDEX=3,S=A.HORIZONTAL_ORIGIN_INDEX=4,E=A.VERTICAL_ORIGIN_INDEX=5,C=A.SCALE_INDEX=6,I=A.IMAGE_INDEX_INDEX=7,N=A.COLOR_INDEX=8,R=A.ROTATION_INDEX=9,P=A.ALIGNED_AXIS_INDEX=10,L=A.SCALE_BY_DISTANCE_INDEX=11,B=A.TRANSLUCENCY_BY_DISTANCE_INDEX=12,U=A.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,w=A.DISTANCE_DISPLAY_CONDITION=14,j=A.DISABLE_DEPTH_DISTANCE=15;A.TEXTURE_COORDINATE_BOUNDS=16;var M=A.SDF_INDEX=17;function F(e,t){var a=e._billboardCollection;Object(_["a"])(a)&&(a._updateBillboard(e,t),e._dirty=!0)}A.NUMBER_OF_PROPERTIES=18,Object.defineProperties(A.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,F(this,v))}},position:{get:function(){return this._position},set:function(e){var t=this._position;s["a"].equals(t,e)||(s["a"].clone(e,t),s["a"].clone(e,this._actualPosition),this._updateClamping(),F(this,y))}},heightReference:{get:function(){return this._heightReference},set:function(e){var t=this._heightReference;e!==t&&(this._heightReference=e,this._updateClamping(),F(this,y))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){var t=this._pixelOffset;n["a"].equals(t,e)||(n["a"].clone(e,t),F(this,D))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){var t=this._scaleByDistance;f["a"].equals(t,e)||(this._scaleByDistance=f["a"].clone(e,t),F(this,L))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){var t=this._translucencyByDistance;f["a"].equals(t,e)||(this._translucencyByDistance=f["a"].clone(e,t),F(this,B))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){var t=this._pixelOffsetScaleByDistance;f["a"].equals(t,e)||(this._pixelOffsetScaleByDistance=f["a"].clone(e,t),F(this,U))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){var t=this._eyeOffset;s["a"].equals(t,e)||(s["a"].clone(e,t),F(this,x))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,F(this,S))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,F(this,E))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,F(this,C))}},color:{get:function(){return this._color},set:function(e){var t=this._color;c["a"].equals(t,e)||(c["a"].clone(e,t),F(this,N))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,F(this,R))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){var t=this._alignedAxis;s["a"].equals(t,e)||(s["a"].clone(e,t),F(this,P))}},width:{get:function(){return Object(l["a"])(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,F(this,I))}},height:{get:function(){return Object(l["a"])(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,F(this,I))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,F(this,N))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){u["a"].equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=u["a"].clone(e,this._distanceDisplayCondition),F(this,w))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,F(this,j))}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(_["a"])(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,Object(_["a"])(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){Object(_["a"])(e)?"string"===typeof e?this.setImage(e,e):e instanceof b["a"]?this.setImage(e.url,e):Object(_["a"])(e.src)?this.setImage(e.src,e):this.setImage(Object(h["a"])(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,F(this,I))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=s["a"].clone(e,this._actualClampedPosition),F(this,y)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,F(this,v))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){var t=this._outlineColor;c["a"].equals(t,e)||(c["a"].clone(e,t),F(this,M))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,F(this,M))}}}),A.prototype.getPickId=function(e){return Object(_["a"])(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},A.prototype._updateClamping=function(){A._updateClamping(this._billboardCollection,this)};var k=new o["a"],V=new s["a"];A._updateClamping=function(e,t){var a=e._scene;if(Object(_["a"])(a)&&Object(_["a"])(a.globe)){var i=a.globe,n=i.ellipsoid,r=i._surface,c=a.frameState.mode,h=c!==t._mode;if(t._mode=c,(t._heightReference===p["a"].NONE||h)&&Object(_["a"])(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference!==p["a"].NONE&&Object(_["a"])(t._position)){var l=n.cartesianToCartographic(t._position);if(Object(_["a"])(l)){Object(_["a"])(t._removeCallbackFunc)&&t._removeCallbackFunc(),t._removeCallbackFunc=r.updateHeight(l,d),o["a"].clone(l,k);var u=i.getHeight(l);Object(_["a"])(u)&&(k.height=u),n.cartographicToCartesian(k,V),d(V)}else t._actualClampedPosition=void 0}}function d(e){if(t._heightReference===p["a"].RELATIVE_TO_GROUND)if(t._mode===g["a"].SCENE3D){var a=n.cartesianToCartographic(e,k);a.height+=l.height,n.cartographicToCartesian(a,e)}else e.x+=l.height;t._clampedPosition=s["a"].clone(e,t._clampedPosition)}},A.prototype._loadImage=function(){var e,t=this._billboardCollection._textureAtlas,a=this._imageId,n=this._image,s=this._imageSubRegion;if(Object(_["a"])(n)&&(e=t.addImage(a,n)),Object(_["a"])(s)&&(e=t.addSubRegion(a,s)),this._imageIndexPromise=e,Object(_["a"])(e)){var r=this;e.then((function(e){if(r._imageId===a&&r._image===n&&i["a"].equals(r._imageSubRegion,s)){var o=t.textureCoordinates[e];r._imageWidth=t.texture.width*o.width,r._imageHeight=t.texture.height*o.height,r._imageIndex=e,r._ready=!0,r._image=void 0,r._imageIndexPromise=void 0,F(r,I)}})).otherwise((function(e){r._imageIndexPromise=void 0}))}},A.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,Object(_["a"])(this._billboardCollection._textureAtlas)&&this._loadImage())},A.prototype.setImageSubRegion=function(e,t){this._imageId===e&&i["a"].equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=i["a"].clone(t),Object(_["a"])(this._billboardCollection._textureAtlas)&&this._loadImage())},A.prototype._setTranslate=function(e){var t=this._translate;n["a"].equals(t,e)||(n["a"].clone(e,t),F(this,D))},A.prototype._getActualPosition=function(){return Object(_["a"])(this._clampedPosition)?this._clampedPosition:this._actualPosition},A.prototype._setActualPosition=function(e){Object(_["a"])(this._clampedPosition)||s["a"].clone(e,this._actualPosition),F(this,y)};var H=new r["a"];A._computeActualPosition=function(e,t,a,i){return Object(_["a"])(e._clampedPosition)?(a.mode!==e._mode&&e._updateClamping(),e._clampedPosition):a.mode===g["a"].SCENE3D?t:(d["a"].multiplyByPoint(i,t,H),T["a"].computeActualWgs84Position(a,H))};var z=new s["a"];A._computeScreenSpacePosition=function(e,t,a,i,s,r){var o=d["a"].multiplyByPoint(e,t,z),c=T["a"].wgs84WithEyeOffsetToWindowCoordinates(s,o,a,r);if(Object(_["a"])(c))return n["a"].add(c,i,c),c};var W=new n["a"](0,0);A.prototype.computeScreenSpacePosition=function(e,t){var a=this._billboardCollection;Object(_["a"])(t)||(t=new n["a"]),n["a"].clone(this._pixelOffset,W),n["a"].add(W,this._translate,W);var i=a.modelMatrix,s=this._position;if(Object(_["a"])(this._clampedPosition)&&(s=this._clampedPosition,e.mode!==g["a"].SCENE3D)){var r=e.mapProjection,o=r.ellipsoid,c=r.unproject(s,k);s=o.cartographicToCartesian(c,z),i=d["a"].IDENTITY}var h=A._computeScreenSpacePosition(i,s,this._eyeOffset,W,e,t);return h},A.getScreenSpaceBoundingBox=function(e,t,a){var n=e.width,s=e.height,r=e.scale;n*=r,s*=r;var o=t.x;e.horizontalOrigin===m["a"].RIGHT?o-=n:e.horizontalOrigin===m["a"].CENTER&&(o-=.5*n);var c=t.y;return e.verticalOrigin===O["a"].BOTTOM||e.verticalOrigin===O["a"].BASELINE?c-=s:e.verticalOrigin===O["a"].CENTER&&(c-=.5*s),Object(_["a"])(a)||(a=new i["a"]),a.x=o,a.y=c,a.width=n,a.height=s,a},A.prototype.equals=function(e){return this===e||Object(_["a"])(e)&&this._id===e._id&&s["a"].equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&i["a"].equals(this._imageSubRegion,e._imageSubRegion)&&c["a"].equals(this._color,e._color)&&n["a"].equals(this._pixelOffset,e._pixelOffset)&&n["a"].equals(this._translate,e._translate)&&s["a"].equals(this._eyeOffset,e._eyeOffset)&&f["a"].equals(this._scaleByDistance,e._scaleByDistance)&&f["a"].equals(this._translucencyByDistance,e._translucencyByDistance)&&f["a"].equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&u["a"].equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},A.prototype._destroy=function(){Object(_["a"])(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),Object(_["a"])(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0},t["a"]=A},"5d9a":function(e,t,a){"use strict";var i=a("be18"),n=a("535a"),s=a("93da"),r=new i["a"](1,1,1);function o(e){e=Object(n["a"])(e,r),this._dimensions=i["a"].clone(e)}Object.defineProperties(o.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){i["a"].clone(e,this._dimensions)}}});var c=new i["a"];o.prototype.emit=function(e){var t=this._dimensions,a=i["a"].multiplyByScalar(t,.5,c),n=s["a"].randomBetween(-a.x,a.x),r=s["a"].randomBetween(-a.y,a.y),o=s["a"].randomBetween(-a.z,a.z);e.position=i["a"].fromElements(n,r,o,e.position),e.velocity=i["a"].normalize(e.position,e.velocity)},t["a"]=o},"61aa":function(e,t,a){"use strict";var i=a("be18"),n=a("bd8d"),s=a("abab"),r=a("535a"),o=a("2f63"),c=a("45c5"),h=a("7d62"),l=a("e856"),_=a("52f0"),u=a("b82e"),d=a("283e"),f=a("d289"),b=a("b08e"),p=a("6596"),m=a("5af0"),g=a("9889"),T=a("b80d"),O=a("ce35"),A=a("e349"),v=a("8a9e");function y(e,t,a,i,n){this._tileset=e,this._tile=t,this._resource=a,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._classificationType=e.vectorClassificationOnly?void 0:e.classificationType,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,R(this,i,n)}y._deprecationWarning=c["a"],Object.defineProperties(y.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var D=Uint32Array.BYTES_PER_ELEMENT;function x(e){var t=A["a"].getAttributeOrUniformBySemantic(e,"_BATCHID");return Object(o["a"])(t)||(t=A["a"].getAttributeOrUniformBySemantic(e,"BATCHID"),Object(o["a"])(t)&&y._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")),t}function S(e){return function(t,a){var i=e._batchTable,n=!Object(o["a"])(e._classificationType),s=e._model.gltf;Object(o["a"])(s)&&(e._batchIdAttributeName=x(s),e._diffuseAttributeOrUniformName[a]=A["a"].getDiffuseAttributeOrUniform(s,a));var r=i.getVertexShaderCallback(n,e._batchIdAttributeName,e._diffuseAttributeOrUniformName[a]);return Object(o["a"])(r)?r(t):t}}function E(e){return function(t,a){var i=e._batchTable,n=!Object(o["a"])(e._classificationType),s=e._model.gltf;Object(o["a"])(s)&&(e._diffuseAttributeOrUniformName[a]=A["a"].getDiffuseAttributeOrUniform(s,a));var r=i.getFragmentShaderCallback(n,e._diffuseAttributeOrUniformName[a],!1);return Object(o["a"])(r)?r(t):t}}function C(e){return function(){return e._batchTable.getPickId()}}function I(e){return function(t){var a=e._batchTable,i=a.getClassificationFragmentShaderCallback();return Object(o["a"])(i)?i(t):t}}function N(e){return function(t,a){e._model.updateCommands(t,a)}}function R(e,t,a){var n=e._tileset,c=e._tile,h=e._resource,m=Object(r["a"])(a,0);a=m;var A=new Uint8Array(t),x=new DataView(t);a+=D;var R=x.getUint32(a,!0);if(1!==R)throw new d["a"]("Only Batched 3D Model version 1 is supported.  Version "+R+" is not.");a+=D;var P=x.getUint32(a,!0);a+=D;var L=x.getUint32(a,!0);a+=D;var B=x.getUint32(a,!0);a+=D;var U=x.getUint32(a,!0);a+=D;var w,j,M=x.getUint32(a,!0);a+=D,U>=570425344?(a-=2*D,w=L,U=B,M=0,L=0,B=0,y._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):M>=570425344&&(a-=D,w=U,U=L,M=B,L=0,B=0,y._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")),0===L?j={BATCH_LENGTH:Object(r["a"])(w,0)}:(j=Object(l["a"])(A,a,L),a+=L);var F=new Uint8Array(t,a,B);a+=B;var k,V,H,z=new g["a"](j,F);w=z.getGlobalProperty("BATCH_LENGTH"),z.featuresLength=w,U>0&&(k=Object(l["a"])(A,a,U),a+=U,M>0&&(V=new Uint8Array(t,a,M),V=new Uint8Array(V),a+=M)),Object(o["a"])(e._classificationType)&&(H=N(e));var W=new p["a"](e,w,k,V,H);e._batchTable=W;var X,G=m+P-a;if(0===G)throw new d["a"]("glTF byte length must be greater than 0.");a%4===0?X=new Uint8Array(t,a,G):(y._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),X=new Uint8Array(A.subarray(a,a+G)));var Y={content:e,primitive:n};e._rtcCenterTransform=_["a"].IDENTITY;var q=z.getGlobalProperty("RTC_CENTER",s["a"].FLOAT,3);Object(o["a"])(q)&&(e._rtcCenterTransform=_["a"].fromTranslation(i["a"].fromArray(q))),e._contentModelMatrix=_["a"].multiply(c.computedTransform,e._rtcCenterTransform,new _["a"]),Object(o["a"])(e._classificationType)?e._model=new T["a"]({gltf:X,cull:!1,basePath:h,requestType:u["a"].TILES3D,modelMatrix:e._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:b["a"].X,debugWireframe:n.debugWireframe,vertexShaderLoaded:S(e),classificationShaderLoaded:I(e),uniformMapLoaded:W.getUniformMapCallback(),pickIdLoaded:C(e),classificationType:e._classificationType,batchTable:W}):(e._model=new O["a"]({gltf:X,cull:!1,releaseGltfJson:!0,opaquePass:f["a"].CESIUM_3D_TILE,basePath:h,requestType:u["a"].TILES3D,modelMatrix:e._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:b["a"].X,shadows:n.shadows,debugWireframe:n.debugWireframe,incrementallyLoadTextures:!1,vertexShaderLoaded:S(e),fragmentShaderLoaded:E(e),uniformMapLoaded:W.getUniformMapCallback(),pickIdLoaded:C(e),addBatchIdToGeneratedShaders:w>0,pickObject:Y,imageBasedLightingFactor:n.imageBasedLightingFactor,lightColor:n.lightColor,luminanceAtZenith:n.luminanceAtZenith,sphericalHarmonicCoefficients:n.sphericalHarmonicCoefficients,specularEnvironmentMaps:n.specularEnvironmentMaps,backFaceCulling:n.backFaceCulling}),e._model.readyPromise.then((function(e){e.activeAnimations.addAll({loop:v["a"].REPEAT})})))}function P(e){var t=e.featuresLength;if(!Object(o["a"])(e._features)&&t>0){for(var a=new Array(t),i=0;i<t;++i)a[i]=new m["a"](e,i);e._features=a}}y.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},y.prototype.getFeature=function(e){return P(this),this._features[e]},y.prototype.applyDebugSettings=function(e,t){t=e?t:n["a"].WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)},y.prototype.applyStyle=function(e){if(0===this.featuresLength){var t=Object(o["a"])(e)&&Object(o["a"])(e.color),a=Object(o["a"])(e)&&Object(o["a"])(e.show);this._model.color=t?e.color.evaluateColor(void 0,this._model.color):n["a"].clone(n["a"].WHITE,this._model.color),this._model.show=!a||e.show.evaluate(void 0)}else this._batchTable.applyStyle(e)},y.prototype.update=function(e,t){var a=t.commandList.length;this._batchTable.update(e,t),this._contentModelMatrix=_["a"].multiply(this._tile.computedTransform,this._rtcCenterTransform,this._contentModelMatrix),this._model.modelMatrix=this._contentModelMatrix,this._model.shadows=this._tileset.shadows,this._model.imageBasedLightingFactor=this._tileset.imageBasedLightingFactor,this._model.lightColor=this._tileset.lightColor,this._model.luminanceAtZenith=this._tileset.luminanceAtZenith,this._model.sphericalHarmonicCoefficients=this._tileset.sphericalHarmonicCoefficients,this._model.specularEnvironmentMaps=this._tileset.specularEnvironmentMaps,this._model.backFaceCulling=this._tileset.backFaceCulling,this._model.debugWireframe=this._tileset.debugWireframe;var i=this._tileset.clippingPlanes;this._model.referenceMatrix=this._tileset.clippingPlanesOriginMatrix,Object(o["a"])(i)&&this._tile.clippingPlanesDirty&&(this._model._clippingPlanes=i.enabled&&this._tile._isClipped?i:void 0),Object(o["a"])(i)&&Object(o["a"])(this._model._clippingPlanes)&&this._model._clippingPlanes!==i&&(this._model._clippingPlanes=i),this._model.update(t);var n=t.commandList.length;a<n&&(t.passes.render||t.passes.pick)&&!Object(o["a"])(this._classificationType)&&this._batchTable.addDerivedCommands(t,a)},y.prototype.isDestroyed=function(){return!1},y.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),Object(h["a"])(this)},t["a"]=y},"6f00":function(e,t,a){"use strict";var i=a("daa2"),n={ADD:i["a"].FUNC_ADD,SUBTRACT:i["a"].FUNC_SUBTRACT,REVERSE_SUBTRACT:i["a"].FUNC_REVERSE_SUBTRACT,MIN:i["a"].MIN,MAX:i["a"].MAX};t["a"]=Object.freeze(n)},"8f7c":function(e,t,a){"use strict";var i,n,s=a("c8d1"),r=a("cef5"),o=a("670c"),c=a("be18"),h=a("bd8d"),l=a("abab"),_=a("535a"),u=a("2f63"),d=a("7d62"),f=a("6cbd"),b=a("0123"),p=a("93da"),m=a("52f0"),g=a("daa2"),T=a("f20a"),O=a("8b68"),A=a("b997"),v=a("a894"),y=a("d289"),D=a("6dc0"),x=a("e90c"),S=a("5770"),E=a("9d80"),C=a("6d53"),I=a("d3d4"),N=a("3e44"),R=a("b7c8"),P=a("141c"),L=a("2d75"),B=a("f61d"),U=a("a307"),w=a("d9a9"),j=a("7eb3"),M=a("05e5"),F=N["a"].SHOW_INDEX,k=N["a"].POSITION_INDEX,V=N["a"].PIXEL_OFFSET_INDEX,H=N["a"].EYE_OFFSET_INDEX,z=N["a"].HORIZONTAL_ORIGIN_INDEX,W=N["a"].VERTICAL_ORIGIN_INDEX,X=N["a"].SCALE_INDEX,G=N["a"].IMAGE_INDEX_INDEX,Y=N["a"].COLOR_INDEX,q=N["a"].ROTATION_INDEX,Z=N["a"].ALIGNED_AXIS_INDEX,Q=N["a"].SCALE_BY_DISTANCE_INDEX,K=N["a"].TRANSLUCENCY_BY_DISTANCE_INDEX,J=N["a"].PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,$=N["a"].DISTANCE_DISPLAY_CONDITION,ee=N["a"].DISABLE_DEPTH_DISTANCE,te=N["a"].TEXTURE_COORDINATE_BOUNDS,ae=N["a"].SDF_INDEX,ie=N["a"].NUMBER_OF_PROPERTIES,ne={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},se={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12};function re(e){e=Object(_["a"])(e,_["a"].EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(ie),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new r["a"],this._baseVolumeWC=new r["a"],this._baseVolume2D=new r["a"],this._boundingVolume=new r["a"],this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=Object(_["a"])(e.show,!0),this.modelMatrix=m["a"].clone(Object(_["a"])(e.modelMatrix,m["a"].IDENTITY)),this._modelMatrix=m["a"].clone(m["a"].IDENTITY),this.debugShowBoundingVolume=Object(_["a"])(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=Object(_["a"])(e.debugShowTextureAtlas,!1),this.blendOption=Object(_["a"])(e.blendOption,P["a"].OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=U["a"].SCENE3D,this._buffersUsage=[O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW,O["a"].STATIC_DRAW],this._highlightColor=h["a"].clone(h["a"].WHITE);var t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};var a=this._scene;Object(u["a"])(a)&&Object(u["a"])(a.terrainProviderChanged)&&(this._removeCallbackFunc=a.terrainProviderChanged.addEventListener((function(){for(var e=this._billboards,t=e.length,a=0;a<t;++a)Object(u["a"])(e[a])&&e[a]._updateClamping()}),this))}function oe(e){for(var t=e.length,a=0;a<t;++a)e[a]&&e[a]._destroy()}function ce(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;for(var t=[],a=e._billboards,i=a.length,n=0,s=0;n<i;++n){var r=a[n];r&&(r._index=s++,t.push(r))}e._billboards=t}}function he(e){var t=16384,a=e.cache.billboardCollection_indexBufferBatched;if(Object(u["a"])(a))return a;for(var i=6*t-6,n=new Uint16Array(i),s=0,r=0;s<i;s+=6,r+=4)n[s]=r,n[s+1]=r+1,n[s+2]=r+2,n[s+3]=r+0,n[s+4]=r+2,n[s+5]=r+3;return a=T["a"].createIndexBuffer({context:e,typedArray:n,usage:O["a"].STATIC_DRAW,indexDatatype:b["a"].UNSIGNED_SHORT}),a.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=a,a}function le(e){var t=e.cache.billboardCollection_indexBufferInstanced;return Object(u["a"])(t)||(t=T["a"].createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:O["a"].STATIC_DRAW,indexDatatype:b["a"].UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function _e(e){var t=e.cache.billboardCollection_vertexBufferInstanced;return Object(u["a"])(t)||(t=T["a"].createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:O["a"].STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}function ue(e,t,a,n,s,r){var o=[{index:i.positionHighAndScale,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[k]},{index:i.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[k]},{index:i.compressedAttribute0,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[V]},{index:i.compressedAttribute1,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[K]},{index:i.compressedAttribute2,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[Y]},{index:i.eyeOffset,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[H]},{index:i.scaleByDistance,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[Q]},{index:i.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[J]},{index:i.compressedAttribute3,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[$]},{index:i.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:l["a"].FLOAT,usage:a[te]}];n&&o.push({index:i.direction,componentsPerAttribute:2,componentDatatype:l["a"].FLOAT,vertexBuffer:_e(e)}),Object(u["a"])(s)&&o.push({index:i.a_batchId,componentsPerAttribute:1,componentDatatype:l["a"].FLOAT,bufferUsage:O["a"].STATIC_DRAW}),r&&o.push({index:i.sdf,componentsPerAttribute:2,componentDatatype:l["a"].FLOAT,usage:a[ae]});var c=n?t:4*t;return new E["a"](e,o,c,n)}Object.defineProperties(re.prototype,{length:{get:function(){return ce(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}}),re.prototype.add=function(e){var t=new N["a"](e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t},re.prototype.remove=function(e){return!!this.contains(e)&&(this._billboards[e._index]=null,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},re.prototype.removeAll=function(){oe(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},re.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]},re.prototype.contains=function(e){return Object(u["a"])(e)&&e._billboardCollection===this},re.prototype.get=function(e){return ce(this),this._billboards[e]},re.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,a=this._propertiesChanged,i=0;i<ie;++i){var n=0===a[i]?O["a"].STATIC_DRAW:O["a"].STREAM_DRAW;t=t||e[i]!==n,e[i]=n}return t};var de=new f["a"];function fe(e,t,a,n,s){var o,c=n[i.positionHighAndScale],h=n[i.positionLowAndRotation],l=s._getActualPosition();e._mode===U["a"].SCENE3D&&(r["a"].expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),f["a"].fromCartesian(l,de);var _=s.scale,u=s.rotation;0!==u&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,_);var d=de.high,b=de.low;e._instanced?(o=s._index,c(o,d.x,d.y,d.z,_),h(o,b.x,b.y,b.z,u)):(o=4*s._index,c(o+0,d.x,d.y,d.z,_),c(o+1,d.x,d.y,d.z,_),c(o+2,d.x,d.y,d.z,_),c(o+3,d.x,d.y,d.z,_),h(o+0,b.x,b.y,b.z,u),h(o+1,b.x,b.y,b.z,u),h(o+2,b.x,b.y,b.z,u),h(o+3,b.x,b.y,b.z,u))}var be=new o["a"],pe=32768,me=65536,ge=4096,Te=256,Oe=128,Ae=32,ve=8,ye=4,De=1/256,xe=0,Se=2,Ee=3,Ce=1;function Ie(e,t,a,n,r){var o,c=n[i.compressedAttribute0],h=r.pixelOffset,l=h.x,_=h.y,u=r._translate,d=u.x,f=u.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+d),Math.abs(-_+f));var b=r.horizontalOrigin,m=r._verticalOrigin,g=r.show&&r.clusterShow;0===r.color.alpha&&(g=!1),m===M["a"].BASELINE&&(m=M["a"].BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&b===B["a"].CENTER,e._allVerticalCenter=e._allVerticalCenter&&m===M["a"].CENTER;var T=0,O=0,A=0,v=0,y=r._imageIndex;if(-1!==y){var D=a[y];T=D.x,O=D.y,A=D.width,v=D.height}var x=T+A,S=O+v,E=Math.floor(p["a"].clamp(l,-pe,pe)+pe)*Oe;E+=(b+1)*Ae,E+=(m+1)*ve,E+=(g?1:0)*ye;var C=Math.floor(p["a"].clamp(_,-pe,pe)+pe)*Te,I=Math.floor(p["a"].clamp(d,-pe,pe)+pe)*Te,N=(p["a"].clamp(f,-pe,pe)+pe)*De,R=Math.floor(N),P=Math.floor((N-R)*Te);C+=R,I+=P,be.x=T,be.y=O;var L=s["a"].compressTextureCoordinates(be);be.x=x;var U=s["a"].compressTextureCoordinates(be);be.y=S;var w=s["a"].compressTextureCoordinates(be);be.x=T;var j=s["a"].compressTextureCoordinates(be);e._instanced?(o=r._index,c(o,E,C,I,L)):(o=4*r._index,c(o+0,E+xe,C,I,L),c(o+1,E+Se,C,I,U),c(o+2,E+Ee,C,I,w),c(o+3,E+Ce,C,I,j))}function Ne(e,t,a,n,r){var o,h=n[i.compressedAttribute1],l=r.alignedAxis;c["a"].equals(l,c["a"].ZERO)||(e._shaderAlignedAxis=!0);var d=0,f=1,b=1,m=1,g=r.translucencyByDistance;Object(u["a"])(g)&&(d=g.near,f=g.nearValue,b=g.far,m=g.farValue,1===f&&1===m||(e._shaderTranslucencyByDistance=!0));var T=0,O=r._imageIndex;if(-1!==O){var A=a[O];T=A.width}var v=e._textureAtlas.texture.width,y=Math.round(Object(_["a"])(r.width,v*T));e._maxSize=Math.max(e._maxSize,y);var D=p["a"].clamp(y,0,me),x=0;Math.abs(c["a"].magnitudeSquared(l)-1)<p["a"].EPSILON6&&(x=s["a"].octEncodeFloat(l)),f=p["a"].clamp(f,0,1),f=1===f?255:255*f|0,D=D*Te+f,m=p["a"].clamp(m,0,1),m=1===m?255:255*m|0,x=x*Te+m,e._instanced?(o=r._index,h(o,D,x,d,b)):(o=4*r._index,h(o+0,D,x,d,b),h(o+1,D,x,d,b),h(o+2,D,x,d,b),h(o+3,D,x,d,b))}function Re(e,t,a,n,s){var r,o=n[i.compressedAttribute2],l=s.color,d=Object(u["a"])(e._batchTable)?h["a"].WHITE:s.getPickId(t.context).color,f=s.sizeInMeters?1:0,b=Math.abs(c["a"].magnitudeSquared(s.alignedAxis)-1)<p["a"].EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&1===f;var m=0,g=s._imageIndex;if(-1!==g){var T=a[g];m=T.height}var O=e._textureAtlas.texture.dimensions,A=Math.round(Object(_["a"])(s.height,O.y*m));e._maxSize=Math.max(e._maxSize,A);var v=Object(_["a"])(s._labelHorizontalOrigin,-2);v+=2;var y=A*ye+v,D=h["a"].floatToByte(l.red),x=h["a"].floatToByte(l.green),S=h["a"].floatToByte(l.blue),E=D*me+x*Te+S;D=h["a"].floatToByte(d.red),x=h["a"].floatToByte(d.green),S=h["a"].floatToByte(d.blue);var C=D*me+x*Te+S,I=h["a"].floatToByte(l.alpha)*me+h["a"].floatToByte(d.alpha)*Te;I+=2*f+b,e._instanced?(r=s._index,o(r,E,C,I,y)):(r=4*s._index,o(r+0,E,C,I,y),o(r+1,E,C,I,y),o(r+2,E,C,I,y),o(r+3,E,C,I,y))}function Pe(e,t,a,n,r){var o,c=n[i.eyeOffset],h=r.eyeOffset,l=h.z;if(r._heightReference!==L["a"].NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(h.x),Math.abs(h.y),Math.abs(l)),e._instanced){var _=0,u=0,d=r._imageIndex;if(-1!==d){var f=a[d];_=f.width,u=f.height}be.x=_,be.y=u;var b=s["a"].compressTextureCoordinates(be);o=r._index,c(o,h.x,h.y,l,b)}else o=4*r._index,c(o+0,h.x,h.y,l,0),c(o+1,h.x,h.y,l,0),c(o+2,h.x,h.y,l,0),c(o+3,h.x,h.y,l,0)}function Le(e,t,a,n,s){var r,o=n[i.scaleByDistance],c=0,h=1,l=1,_=1,d=s.scaleByDistance;Object(u["a"])(d)&&(c=d.near,h=d.nearValue,l=d.far,_=d.farValue,1===h&&1===_||(e._shaderScaleByDistance=!0)),e._instanced?(r=s._index,o(r,c,h,l,_)):(r=4*s._index,o(r+0,c,h,l,_),o(r+1,c,h,l,_),o(r+2,c,h,l,_),o(r+3,c,h,l,_))}function Be(e,t,a,n,s){var r,o=n[i.pixelOffsetScaleByDistance],c=0,h=1,l=1,_=1,d=s.pixelOffsetScaleByDistance;Object(u["a"])(d)&&(c=d.near,h=d.nearValue,l=d.far,_=d.farValue,1===h&&1===_||(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(r=s._index,o(r,c,h,l,_)):(r=4*s._index,o(r+0,c,h,l,_),o(r+1,c,h,l,_),o(r+2,c,h,l,_),o(r+3,c,h,l,_))}function Ue(e,t,a,n,s){var r,o=n[i.compressedAttribute3],c=0,h=Number.MAX_VALUE,l=s.distanceDisplayCondition;Object(u["a"])(l)&&(c=l.near,h=l.far,c*=c,h*=h,e._shaderDistanceDisplayCondition=!0);var d,f,b=s.disableDepthTestDistance,m=s.heightReference===L["a"].CLAMP_TO_GROUND&&t.context.depthTexture;if(Object(u["a"])(b)||(b=m?5e3:0),b*=b,(m||b>0)&&(e._shaderDisableDepthDistance=!0,b===Number.POSITIVE_INFINITY&&(b=-1)),Object(u["a"])(s._labelDimensions))f=s._labelDimensions.x,d=s._labelDimensions.y;else{var g=0,T=0,O=s._imageIndex;if(-1!==O){var A=a[O];g=A.height,T=A.width}d=Math.round(Object(_["a"])(s.height,e._textureAtlas.texture.dimensions.y*g));var v=e._textureAtlas.texture.width;f=Math.round(Object(_["a"])(s.width,v*T))}var y=Math.floor(p["a"].clamp(f,0,ge)),D=Math.floor(p["a"].clamp(d,0,ge)),x=y*ge+D;e._instanced?(r=s._index,o(r,c,h,b,x)):(r=4*s._index,o(r+0,c,h,b,x),o(r+1,c,h,b,x),o(r+2,c,h,b,x),o(r+3,c,h,b,x))}function we(e,t,a,n,s){if(s.heightReference===L["a"].CLAMP_TO_GROUND){var r=e._scene,o=t.context,c=t.globeTranslucencyState.translucent,h=Object(u["a"])(r.globe)&&r.globe.depthTestAgainstTerrain;e._shaderClampToGround=o.depthTexture&&!c&&h}var l,_=n[i.textureCoordinateBoundsOrLabelTranslate];if(A["a"].maximumVertexTextureImageUnits>0){var d=0,f=0;return Object(u["a"])(s._labelTranslate)&&(d=s._labelTranslate.x,f=s._labelTranslate.y),void(e._instanced?(l=s._index,_(l,d,f,0,0)):(l=4*s._index,_(l+0,d,f,0,0),_(l+1,d,f,0,0),_(l+2,d,f,0,0),_(l+3,d,f,0,0)))}var b=0,p=0,m=0,g=0,T=s._imageIndex;if(-1!==T){var O=a[T];b=O.x,p=O.y,m=O.width,g=O.height}var v=b+m,y=p+g;e._instanced?(l=s._index,_(l,b,p,v,y)):(l=4*s._index,_(l+0,b,p,v,y),_(l+1,b,p,v,y),_(l+2,b,p,v,y),_(l+3,b,p,v,y))}function je(e,t,a,n,s){if(Object(u["a"])(e._batchTable)){var r,o=n[i.a_batchId],c=s._batchIndex;e._instanced?(r=s._index,o(r,c)):(r=4*s._index,o(r+0,c),o(r+1,c),o(r+2,c),o(r+3,c))}}function Me(e,t,a,n,s){if(e._sdf){var r,o=n[i.sdf],c=s.outlineColor,l=s.outlineWidth,_=h["a"].floatToByte(c.red),u=h["a"].floatToByte(c.green),d=h["a"].floatToByte(c.blue),f=_*me+u*Te+d,b=l/w["a"].RADIUS,p=h["a"].floatToByte(c.alpha)*me+h["a"].floatToByte(b)*Te;e._instanced?(r=s._index,o(r,f,p)):(r=4*s._index,o(r+0,f+xe,p),o(r+1,f+Se,p),o(r+2,f+Ee,p),o(r+3,f+Ce,p))}}function Fe(e,t,a,i,n){fe(e,t,a,i,n),Ie(e,t,a,i,n),Ne(e,t,a,i,n),Re(e,t,a,i,n),Pe(e,t,a,i,n),Le(e,t,a,i,n),Be(e,t,a,i,n),Ue(e,t,a,i,n),we(e,t,a,i,n),je(e,t,a,i,n),Me(e,t,a,i,n)}function ke(e,t,a,i,n,s){var o;i.mode===U["a"].SCENE3D?(o=e._baseVolume,e._boundingVolumeDirty=!0):o=e._baseVolume2D;for(var c=[],h=0;h<a;++h){var l=t[h],_=l.position,d=N["a"]._computeActualPosition(l,_,i,n);Object(u["a"])(d)&&(l._setActualPosition(d),s?c.push(d):r["a"].expand(o,d,o))}s&&r["a"].fromPoints(c,o)}function Ve(e,t){var a=t.mode,i=e._billboards,n=e._billboardsToUpdate,s=e._modelMatrix;e._createVertexArray||e._mode!==a||a!==U["a"].SCENE3D&&!m["a"].equals(s,e.modelMatrix)?(e._mode=a,m["a"].clone(e.modelMatrix,s),e._createVertexArray=!0,a!==U["a"].SCENE3D&&a!==U["a"].SCENE2D&&a!==U["a"].COLUMBUS_VIEW||ke(e,i,i.length,t,s,!0)):a===U["a"].MORPHING?ke(e,i,i.length,t,s,!0):a!==U["a"].SCENE2D&&a!==U["a"].COLUMBUS_VIEW||ke(e,n,e._billboardsToUpdateIndex,t,s,!1)}function He(e,t,a){var i=1;e._allSizedInMeters&&0===e._maxPixelOffset||(i=t.camera.getPixelSize(a,t.context.drawingBufferWidth,t.context.drawingBufferHeight));var n=i*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(n*=.5);var s=i*e._maxPixelOffset+e._maxEyeOffset;a.radius+=n+s}function ze(e,t){var a;a="uniform sampler2D billboard_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    gl_FragColor = texture2D(billboard_texture, v_textureCoordinates); \n} \n";var i=t.createViewportQuadCommand(a,{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return i.pass=y["a"].OVERLAY,i}var We=[];re.prototype.update=function(e){if(ce(this),this.show){var t=this._billboards,a=t.length,s=e.context;this._instanced=s.instancedArrays,i=this._instanced?se:ne,n=this._instanced?le:he;var o=this._textureAtlas;if(!Object(u["a"])(o)){o=this._textureAtlas=new j["a"]({context:s});for(var c=0;c<a;++c)t[c]._loadImage()}var h=o.textureCoordinates;if(0!==h.length){Ve(this,e),t=this._billboards,a=t.length;var l,_=this._billboardsToUpdate,d=this._billboardsToUpdateIndex,f=this._propertiesChanged,b=o.guid,p=this._createVertexArray||this._textureAtlasGUID!==b;this._textureAtlasGUID=b;var T=e.passes,O=T.pick;if(p||!O&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var E=0;E<ie;++E)f[E]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),a>0){this._vaf=ue(s,a,this._buffersUsage,this._instanced,this._batchTable,this._sdf),l=this._vaf.writers;for(var N=0;N<a;++N){var L=this._billboards[N];L._dirty=!1,Fe(this,e,h,l,L)}this._vaf.commit(n(s))}this._billboardsToUpdateIndex=0}else if(d>0){var B=We;B.length=0,(f[k]||f[q]||f[X])&&B.push(fe),(f[G]||f[V]||f[z]||f[W]||f[F])&&(B.push(Ie),this._instanced&&B.push(Pe)),(f[G]||f[Z]||f[K])&&(B.push(Ne),B.push(Re)),(f[G]||f[Y])&&B.push(Re),f[H]&&B.push(Pe),f[Q]&&B.push(Le),f[J]&&B.push(Be),(f[$]||f[ee]||f[G]||f[k])&&B.push(Ue),(f[G]||f[k])&&B.push(we),f[ae]&&B.push(Me);var M=B.length;if(l=this._vaf.writers,d/a>.1){for(var te=0;te<d;++te){var re=_[te];re._dirty=!1;for(var oe=0;oe<M;++oe)B[oe](this,e,h,l,re)}this._vaf.commit(n(s))}else{for(var _e=0;_e<d;++_e){var de=_[_e];de._dirty=!1;for(var be=0;be<M;++be)B[be](this,e,h,l,de);this._instanced?this._vaf.subCommit(de._index,1):this._vaf.subCommit(4*de._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(d>1.5*a&&(_.length=a),Object(u["a"])(this._vaf)&&Object(u["a"])(this._vaf.va)){var pe;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,r["a"].transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var me=m["a"].IDENTITY;e.mode===U["a"].SCENE3D?(me=this.modelMatrix,pe=r["a"].clone(this._baseVolumeWC,this._boundingVolume)):pe=r["a"].clone(this._baseVolume2D,this._boundingVolume),He(this,e,pe);var ge,Te,Oe,Ae,ve,ye=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,ye){this._blendOption===P["a"].OPAQUE||this._blendOption===P["a"].OPAQUE_AND_TRANSLUCENT?this._rsOpaque=D["a"].fromCache({depthTest:{enabled:!0,func:g["a"].LESS},depthMask:!0}):this._rsOpaque=void 0;var De=this._blendOption===P["a"].TRANSLUCENT;this._blendOption===P["a"].TRANSLUCENT||this._blendOption===P["a"].OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=D["a"].fromCache({depthTest:{enabled:!0,func:De?g["a"].LEQUAL:g["a"].LESS},depthMask:De,blending:R["a"].ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance;var xe=A["a"].maximumVertexTextureImageUnits>0;if(ye||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){ge=I["a"],Te=C["a"],ve=[],Object(u["a"])(this._batchTable)&&(ve.push("VECTOR_TILE"),ge=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(ge),Te=this._batchTable.getFragmentShaderCallback(!1,void 0)(Te)),Oe=new S["a"]({defines:ve,sources:[ge]}),this._instanced&&Oe.defines.push("INSTANCED"),this._shaderRotation&&Oe.defines.push("ROTATION"),this._shaderAlignedAxis&&Oe.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&Oe.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&Oe.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&Oe.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&Oe.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&Oe.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(xe?Oe.defines.push("VERTEX_DEPTH_CHECK"):Oe.defines.push("FRAGMENT_DEPTH_CHECK"));var Se=1-w["a"].CUTOFF;this._sdf&&Oe.defines.push("SDF");var Ee=Object(u["a"])(this._batchTable)?"VECTOR_TILE":"";this._blendOption===P["a"].OPAQUE_AND_TRANSLUCENT&&(Ae=new S["a"]({defines:["OPAQUE",Ee],sources:[Te]}),this._shaderClampToGround&&(xe?Ae.defines.push("VERTEX_DEPTH_CHECK"):Ae.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Ae.defines.push("SDF"),Ae.defines.push("SDF_EDGE "+Se)),this._sp=x["a"].replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:Oe,fragmentShaderSource:Ae,attributeLocations:i}),Ae=new S["a"]({defines:["TRANSLUCENT",Ee],sources:[Te]}),this._shaderClampToGround&&(xe?Ae.defines.push("VERTEX_DEPTH_CHECK"):Ae.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Ae.defines.push("SDF"),Ae.defines.push("SDF_EDGE "+Se)),this._spTranslucent=x["a"].replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:Oe,fragmentShaderSource:Ae,attributeLocations:i})),this._blendOption===P["a"].OPAQUE&&(Ae=new S["a"]({defines:[Ee],sources:[Te]}),this._shaderClampToGround&&(xe?Ae.defines.push("VERTEX_DEPTH_CHECK"):Ae.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Ae.defines.push("SDF"),Ae.defines.push("SDF_EDGE "+Se)),this._sp=x["a"].replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:Oe,fragmentShaderSource:Ae,attributeLocations:i})),this._blendOption===P["a"].TRANSLUCENT&&(Ae=new S["a"]({defines:[Ee],sources:[Te]}),this._shaderClampToGround&&(xe?Ae.defines.push("VERTEX_DEPTH_CHECK"):Ae.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(Ae.defines.push("SDF"),Ae.defines.push("SDF_EDGE "+Se)),this._spTranslucent=x["a"].replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:Oe,fragmentShaderSource:Ae,attributeLocations:i})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}var Ce=e.commandList;if(T.render||T.pick){var je,ke=this._colorCommands,Xe=this._blendOption===P["a"].OPAQUE,Ge=this._blendOption===P["a"].OPAQUE_AND_TRANSLUCENT,Ye=this._vaf.va,qe=Ye.length,Ze=this._uniforms;Object(u["a"])(this._batchTable)?(Ze=this._batchTable.getUniformMapCallback()(Ze),je=this._batchTable.getPickId()):je="v_pickColor",ke.length=qe;for(var Qe=Ge?2*qe:qe,Ke=0;Ke<Qe;++Ke){var Je=ke[Ke];Object(u["a"])(Je)||(Je=ke[Ke]=new v["a"]);var $e=Xe||Ge&&Ke%2===0;Je.pass=$e||!Ge?y["a"].OPAQUE:y["a"].TRANSLUCENT,Je.owner=this;var et=Ge?Math.floor(Ke/2):Ke;Je.boundingVolume=pe,Je.modelMatrix=me,Je.count=Ye[et].indicesCount,Je.shaderProgram=$e?this._sp:this._spTranslucent,Je.uniformMap=Ze,Je.vertexArray=Ye[et].va,Je.renderState=$e?this._rsOpaque:this._rsTranslucent,Je.debugShowBoundingVolume=this.debugShowBoundingVolume,Je.pickId=je,this._instanced&&(Je.count=6,Je.instanceCount=a),Ce.push(Je)}this.debugShowTextureAtlas&&(Object(u["a"])(this.debugCommand)||(this.debugCommand=ze(this,e.context)),Ce.push(this.debugCommand))}}}}},re.prototype.isDestroyed=function(){return!1},re.prototype.destroy=function(){return Object(u["a"])(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),oe(this._billboards),Object(d["a"])(this)},t["a"]=re},b08e:function(e,t,a){"use strict";var i=a("93da"),n=a("df07"),s=a("52f0"),r={X:0,Y:1,Z:2};r.Y_UP_TO_Z_UP=s["a"].fromRotationTranslation(n["a"].fromRotationX(i["a"].PI_OVER_TWO)),r.Z_UP_TO_Y_UP=s["a"].fromRotationTranslation(n["a"].fromRotationX(-i["a"].PI_OVER_TWO)),r.X_UP_TO_Z_UP=s["a"].fromRotationTranslation(n["a"].fromRotationY(-i["a"].PI_OVER_TWO)),r.Z_UP_TO_X_UP=s["a"].fromRotationTranslation(n["a"].fromRotationY(i["a"].PI_OVER_TWO)),r.X_UP_TO_Y_UP=s["a"].fromRotationTranslation(n["a"].fromRotationZ(i["a"].PI_OVER_TWO)),r.Y_UP_TO_X_UP=s["a"].fromRotationTranslation(n["a"].fromRotationZ(-i["a"].PI_OVER_TWO)),r.fromName=function(e){return r[e]},t["a"]=Object.freeze(r)},b7c8:function(e,t,a){"use strict";var i=a("6f00"),n=a("30d2"),s={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:i["a"].ADD,equationAlpha:i["a"].ADD,functionSourceRgb:n["a"].SOURCE_ALPHA,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n["a"].ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:i["a"].ADD,equationAlpha:i["a"].ADD,functionSourceRgb:n["a"].ONE,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n["a"].ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:i["a"].ADD,equationAlpha:i["a"].ADD,functionSourceRgb:n["a"].SOURCE_ALPHA,functionSourceAlpha:n["a"].ONE,functionDestinationRgb:n["a"].ONE,functionDestinationAlpha:n["a"].ONE})};t["a"]=Object.freeze(s)},c078:function(e,t,a){"use strict";var i=a("7229"),n=a("8dfe"),s=a("535a"),r=a("2f63"),o=a("21d7"),c=a("93da"),h=a("eace"),l=a("d4ed"),_=a("283e"),u=a("a89b"),d=a("d3a0"),f=a("a58e"),b=a("1e82"),p=a("1360"),m=a("64ac");function g(e){e=Object(s["a"])(e,s["a"].EMPTY_OBJECT);var t=e.key;this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=1,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._key=t,this._resource=l["a"].createIfNeeded(e.url),this._resource.appendForwardSlash(),this._tileProtocol=e.tileProtocol,this._mapStyle=Object(s["a"])(e.mapStyle,b["a"].AERIAL),this._culture=Object(s["a"])(e.culture,""),this._tileDiscardPolicy=e.tileDiscardPolicy,Object(r["a"])(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new p["a"]),this._proxy=e.proxy,this._credit=new n["a"]('<a href="http://www.bing.com"><img src="'+g.logoUrl+'" title="Bing Imagery"/></a>'),this._tilingScheme=new d["a"]({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new o["a"],this._ready=!1,this._readyPromise=f["a"].defer();var a=this._tileProtocol;if(Object(r["a"])(a))a.length>0&&":"===a[a.length-1]&&(a=a.substr(0,a.length-1));else{var i=document.location.protocol;a="http:"===i?"http":"https"}var m,T=this._resource.getDerivedResource({url:"REST/v1/Imagery/Metadata/"+this._mapStyle,queryParameters:{incl:"ImageryProviders",key:this._key,uriScheme:a}}),O=this;function A(e){if(1===e.resourceSets.length){var t=e.resourceSets[0].resources[0];O._tileWidth=t.imageWidth,O._tileHeight=t.imageHeight,O._maximumLevel=t.zoomMax-1,O._imageUrlSubdomains=t.imageUrlSubdomains,O._imageUrlTemplate=t.imageUrl;var a=O._attributionList=t.imageryProviders;a||(a=O._attributionList=[]);for(var i=0,s=a.length;i<s;++i){var r=a[i];if(r.credit instanceof n["a"])break;r.credit=new n["a"](r.attribution);for(var o=r.coverageAreas,l=0,_=r.coverageAreas.length;l<_;++l){var d=o[l],f=d.bbox;d.bbox=new h["a"](c["a"].toRadians(f[1]),c["a"].toRadians(f[0]),c["a"].toRadians(f[3]),c["a"].toRadians(f[2]))}}O._ready=!0,O._readyPromise.resolve(!0),u["a"].handleSuccess(m)}else v()}function v(e){var t="An error occurred while accessing "+T.url+".";m=u["a"].handleError(m,O,O._errorEvent,t,void 0,void 0,void 0,D),O._readyPromise.reject(new _["a"](t))}var y=T.url;function D(){var e=T.fetchJsonp("jsonp");g._metadataCache[y]=e,e.then(A).otherwise(v)}var x=g._metadataCache[y];Object(r["a"])(x)?x.then(A).otherwise(v):D()}Object.defineProperties(g.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});var T=new h["a"];function O(e,t,a,i,n){var s=e._imageUrlTemplate,r=e._imageUrlSubdomains,o=(t+a+i)%r.length;return e._resource.getDerivedResource({url:s,request:n,templateValues:{quadkey:g.tileXYToQuadKey(t,a,i),subdomain:r[o],culture:e._culture},queryParameters:{n:"z"}})}g.prototype.getTileCredits=function(e,t,a){var i=this._tilingScheme.tileXYToRectangle(e,t,a,T),n=v(this._attributionList,a,i);return n},g.prototype.requestImage=function(e,t,a,i){var n=m["a"].loadImage(this,O(this,e,t,a,i));if(Object(r["a"])(n))return n.otherwise((function(e){return Object(r["a"])(e.blob)&&0===e.blob.size?p["a"].EMPTY_IMAGE:f["a"].reject(e)}))},g.prototype.pickFeatures=function(e,t,a,i,n){},g.tileXYToQuadKey=function(e,t,a){for(var i="",n=a;n>=0;--n){var s=1<<n,r=0;0!==(e&s)&&(r|=1),0!==(t&s)&&(r|=2),i+=r}return i},g.quadKeyToTileXY=function(e){for(var t=0,a=0,i=e.length-1,n=i;n>=0;--n){var s=1<<n,r=+e[i-n];0!==(1&r)&&(t|=s),0!==(2&r)&&(a|=s)}return{x:t,y:a,level:i}},g._logoUrl=void 0,Object.defineProperties(g,{logoUrl:{get:function(){return Object(r["a"])(g._logoUrl)||(g._logoUrl=Object(i["a"])("Assets/Images/bing_maps_credit.png")),g._logoUrl},set:function(e){g._logoUrl=e}}});var A=new h["a"];function v(e,t,a){++t;for(var i=[],n=0,s=e.length;n<s;++n){for(var o=e[n],c=o.coverageAreas,l=!1,_=0,u=o.coverageAreas.length;!l&&_<u;++_){var d=c[_];if(t>=d.zoomMin&&t<=d.zoomMax){var f=h["a"].intersection(a,d.bbox,A);Object(r["a"])(f)&&(l=!0)}}l&&i.push(o.credit)}return i}g._metadataCache={},t["a"]=g}}]);