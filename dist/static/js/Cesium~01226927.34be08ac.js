(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~01226927"],{"0a40":function(e,t,a){"use strict";var r=a("2f63"),i=a("7d62"),n=a("fe57"),o=a("e90c"),s=a("0249"),c=a("a307");function d(e,t,a,r,i){this.numberOfDayTextures=e,this.flags=t,this.material=a,this.shaderProgram=r,this.clippingShaderState=i}function u(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function l(e){var t,a="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }",r="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }",i="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }";switch(e){case c["a"].SCENE3D:t=a;break;case c["a"].SCENE2D:case c["a"].COLUMBUS_VIEW:t=r;break;case c["a"].MORPHING:t=i;break}return t}function h(e){var t="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }",a="float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }";return e?a:t}u.prototype.getShaderProgram=function(e){var t=e.frameState,a=e.surfaceTile,i=e.numberOfDayTextures,c=e.applyBrightness,u=e.applyContrast,p=e.applyHue,m=e.applySaturation,f=e.applyGamma,g=e.applyAlpha,_=e.applyDayNightAlpha,y=e.applySplit,v=e.showReflectiveOcean,T=e.showOceanWaves,b=e.enableLighting,A=e.dynamicAtmosphereLighting,C=e.dynamicAtmosphereLightingFromSun,S=e.showGroundAtmosphere,O=e.perFragmentGroundAtmosphere,x=e.hasVertexNormals,E=e.useWebMercatorProjection,D=e.enableFog,F=e.enableClippingPlanes,w=e.clippingPlanes,L=e.clippedByBoundaries,P=e.hasImageryLayerCutout,N=e.colorCorrect,R=e.highlightFillTile,I=e.colorToAlpha,M=e.showUndergroundColor,B=e.translucent,j=0,k="",U=a.renderedMesh,H=U.encoding,G=H.quantization;G===n["a"].BITS12&&(j=1,k="QUANTIZATION_BITS12");var V=0,Y="";L&&(V=1,Y="TILE_LIMIT_RECTANGLE");var q=0,W="";P&&(q=1,W="APPLY_IMAGERY_CUTOUT");var z=t.mode,K=z|c<<2|u<<3|p<<4|m<<5|f<<6|g<<7|v<<8|T<<9|b<<10|A<<11|C<<12|S<<13|O<<14|x<<15|E<<16|D<<17|j<<18|y<<19|F<<20|V<<21|q<<22|N<<23|R<<24|I<<25|M<<26|B<<27|_<<28,X=0;Object(r["a"])(w)&&w.length>0&&(X=F?w.clippingPlanesState:0);var Q=a.surfaceShader;if(Object(r["a"])(Q)&&Q.numberOfDayTextures===i&&Q.flags===K&&Q.material===this.material&&Q.clippingShaderState===X)return Q.shaderProgram;var Z=this._shadersByTexturesFlags[i];if(Object(r["a"])(Z)||(Z=this._shadersByTexturesFlags[i]=[]),Q=Z[K],!Object(r["a"])(Q)||Q.material!==this.material||Q.clippingShaderState!==X){var J=this.baseVertexShaderSource.clone(),$=this.baseFragmentShaderSource.clone();0!==X&&$.sources.unshift(Object(s["a"])(w,t.context)),J.defines.push(k),$.defines.push("TEXTURE_UNITS "+i,Y,W),c&&$.defines.push("APPLY_BRIGHTNESS"),u&&$.defines.push("APPLY_CONTRAST"),p&&$.defines.push("APPLY_HUE"),m&&$.defines.push("APPLY_SATURATION"),f&&$.defines.push("APPLY_GAMMA"),g&&$.defines.push("APPLY_ALPHA"),_&&$.defines.push("APPLY_DAY_NIGHT_ALPHA"),v&&($.defines.push("SHOW_REFLECTIVE_OCEAN"),J.defines.push("SHOW_REFLECTIVE_OCEAN")),T&&$.defines.push("SHOW_OCEAN_WAVES"),I&&$.defines.push("APPLY_COLOR_TO_ALPHA"),M&&(J.defines.push("UNDERGROUND_COLOR"),$.defines.push("UNDERGROUND_COLOR")),B&&(J.defines.push("TRANSLUCENT"),$.defines.push("TRANSLUCENT")),b&&(x?(J.defines.push("ENABLE_VERTEX_LIGHTING"),$.defines.push("ENABLE_VERTEX_LIGHTING")):(J.defines.push("ENABLE_DAYNIGHT_SHADING"),$.defines.push("ENABLE_DAYNIGHT_SHADING"))),A&&($.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),C&&$.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN")),S&&(J.defines.push("GROUND_ATMOSPHERE"),$.defines.push("GROUND_ATMOSPHERE"),O&&$.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),J.defines.push("INCLUDE_WEB_MERCATOR_Y"),$.defines.push("INCLUDE_WEB_MERCATOR_Y"),D&&(J.defines.push("FOG"),$.defines.push("FOG")),y&&$.defines.push("APPLY_SPLIT"),F&&$.defines.push("ENABLE_CLIPPING_PLANES"),N&&$.defines.push("COLOR_CORRECT"),R&&$.defines.push("HIGHLIGHT_FILL_TILE");var ee="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";P&&(ee+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(var te=0;te<i;++te)ee+=P?"        cutoutAndColorResult = u_dayTextureCutoutRectangles["+te+"];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n":"        color = sampleAndBlend(\n",ee+="            color,\n            u_dayTextures["+te+"],\n            u_dayTextureUseWebMercatorT["+te+"] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle["+te+"],\n            u_dayTextureTranslationAndScale["+te+"],\n            "+(g?"u_dayTextureAlpha["+te+"]":"1.0")+",\n            "+(_?"u_dayTextureNightAlpha["+te+"]":"1.0")+",\n"+(_?"u_dayTextureDayAlpha["+te+"]":"1.0")+",\n"+(c?"u_dayTextureBrightness["+te+"]":"0.0")+",\n            "+(u?"u_dayTextureContrast["+te+"]":"0.0")+",\n            "+(p?"u_dayTextureHue["+te+"]":"0.0")+",\n            "+(m?"u_dayTextureSaturation["+te+"]":"0.0")+",\n            "+(f?"u_dayTextureOneOverGamma["+te+"]":"0.0")+",\n            "+(y?"u_dayTextureSplit["+te+"]":"0.0")+",\n            "+(I?"u_colorsToAlpha["+te+"]":"vec4(0.0)")+",\n        nightBlend        );\n",P&&(ee+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");ee+="        return color;\n    }",$.sources.push(ee),J.sources.push(l(z)),J.sources.push(h(E));var ae=o["a"].fromCache({context:t.context,vertexShaderSource:J,fragmentShaderSource:$,attributeLocations:H.getAttributeLocations()});Q=Z[K]=new d(i,K,this.material,ae,X)}return a.surfaceShader=Q,Q.shaderProgram},u.prototype.destroy=function(){var e,t,a=this._shadersByTexturesFlags;for(var n in a)if(a.hasOwnProperty(n)){var o=a[n];if(!Object(r["a"])(o))continue;for(e in o)o.hasOwnProperty(e)&&(t=o[e],Object(r["a"])(t)&&t.shaderProgram.destroy())}return Object(i["a"])(this)},t["a"]=u},2856:function(e,t,a){"use strict";var r=a("cef5"),i=a("be18"),n=a("a561"),o=a("2f63"),s=a("0123"),c=a("5410"),d=a("78e5"),u=a("e42d"),l=a("2ac3"),h=a("de66"),p=a("8a39"),m=a("b82e"),f=a("a89b"),g=a("f20a"),_=a("8b68"),y=a("6ef5"),v=a("6c84"),T=a("a913"),b=a("3022"),A=a("03f1"),C=a("23b6"),S=a("7c5e"),O=a("a58e"),x=a("dddf"),E=a("f1b3"),D=a("a307"),F=a("4c22");function w(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new n["a"](0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.orientedBoundingBox=void 0,this.boundingVolumeSourceTile=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new i["a"],this.terrainState=F["a"].UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new r["a"],this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}function L(e,t,a,r,n,s){if(e.decodePosition(r,n,s),Object(o["a"])(t)&&t!==D["a"].SCENE3D){var c=a.ellipsoid,d=c.cartesianToCartographic(s);a.project(d,s),i["a"].fromElements(s.z,s.x,s.y,s)}return s}Object.defineProperties(w.prototype,{eligibleForUnloading:{get:function(){for(var e=this.terrainState,t=e===F["a"].RECEIVING||e===F["a"].TRANSFORMING,a=!t,r=this.imagery,i=0,n=r.length;a&&i<n;++i){var s=r[i];a=!Object(o["a"])(s.loadingImagery)||s.loadingImagery.state!==x["a"].TRANSITIONING}return a}},renderedMesh:{get:function(){return Object(o["a"])(this.vertexArray)?this.mesh:Object(o["a"])(this.fill)?this.fill.mesh:void 0}}});var P=new i["a"],N=new i["a"],R=new i["a"];function I(e,t,a){var r=t.getTileDataAvailable(e.x,e.y,e.level);if(!Object(o["a"])(r)&&Object(o["a"])(e.parent)){var i=e.parent,n=i.data;Object(o["a"])(n)&&Object(o["a"])(n.terrainData)&&(r=n.terrainData.isChildAvailable(i.x,i.y,e.x,e.y))}!1===r&&(e.data.terrainState=F["a"].FAILED);for(var s=0,c=a.length;s<c;++s){var d=a.get(s);d.show&&d._createTileImagerySkeletons(e,t)}}function M(e,t,a,r,i){var n=e.data,s=e.parent;if(n.terrainState===F["a"].FAILED&&void 0!==s){var c=void 0!==s.data&&void 0!==s.data.terrainData&&!1!==s.data.terrainData.canUpsample;c||w.processStateMachine(s,t,a,r,!0)}if(n.terrainState===F["a"].FAILED&&B(n,e,t,a,e.x,e.y,e.level),n.terrainState===F["a"].UNLOADED&&j(n,a,e.x,e.y,e.level),n.terrainState===F["a"].RECEIVED&&U(n,t,a,e.x,e.y,e.level),n.terrainState===F["a"].TRANSFORMED&&H(n,t.context,a,e.x,e.y,e.level,i),n.terrainState>=F["a"].RECEIVED&&void 0===n.waterMaskTexture&&a.hasWaterMask){var d=n.terrainData;if(void 0!==d.waterMask)V(t.context,n);else{var u=n._findAncestorTileWithTerrainData(e);Object(o["a"])(u)&&Object(o["a"])(u.data.waterMaskTexture)&&(n.waterMaskTexture=u.data.waterMaskTexture,++n.waterMaskTexture.referenceCount,n._computeWaterMaskTranslationAndScale(e,u,n.waterMaskTranslationAndScale))}}}function B(e,t,a,r,i,n,s){var c=t.parent;if(c){var d=c.data.terrainData,u=c.x,l=c.y,h=c.level;if(Object(o["a"])(d)){var p=d.upsample(r.tilingScheme,u,l,h,i,n,s);Object(o["a"])(p)&&(e.terrainState=F["a"].RECEIVING,Object(O["a"])(p,(function(t){e.terrainData=t,e.terrainState=F["a"].RECEIVED}),(function(){e.terrainState=F["a"].FAILED})))}}else t.state=E["a"].FAILED}function j(e,t,a,r,i){function n(t){e.terrainData=t,e.terrainState=F["a"].RECEIVED,e.request=void 0}function s(){if(e.request.state===p["a"].CANCELLED)return e.terrainData=void 0,e.terrainState=F["a"].UNLOADED,void(e.request=void 0);e.terrainState=F["a"].FAILED,e.request=void 0;var n="Failed to obtain terrain tile X: "+a+" Y: "+r+" Level: "+i+".";t._requestError=f["a"].handleError(t._requestError,t,t.errorEvent,n,a,r,i,c)}function c(){var c=new h["a"]({throttle:!1,throttleByServer:!0,type:m["a"].TERRAIN});e.request=c;var d=t.requestTileGeometry(a,r,i,c);Object(o["a"])(d)?(e.terrainState=F["a"].RECEIVING,Object(O["a"])(d,n,s)):(e.terrainState=F["a"].UNLOADED,e.request=void 0)}c()}w.prototype.pick=function(e,t,a,r,i){var n=this.renderedMesh;if(Object(o["a"])(n)){for(var s=n.vertices,d=n.indices,u=n.encoding,h=d.length,p=Number.MAX_VALUE,m=0;m<h;m+=3){var f=d[m],g=d[m+1],_=d[m+2],y=L(u,t,a,s,f,P),v=L(u,t,a,s,g,N),T=L(u,t,a,s,_,R),b=c["a"].rayTriangleParametric(e,y,v,T,r);Object(o["a"])(b)&&b<p&&b>=0&&(p=b)}return p!==Number.MAX_VALUE?l["a"].getPoint(e,p,i):void 0}},w.prototype.freeResources=function(){Object(o["a"])(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=F["a"].UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();for(var e=this.imagery,t=0,a=e.length;t<a;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},w.prototype.freeVertexArray=function(){w._freeVertexArray(this.vertexArray),this.vertexArray=void 0,w._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},w.initialize=function(e,t,a){var r=e.data;Object(o["a"])(r)||(r=e.data=new w),e.state===E["a"].START&&(I(e,t,a),e.state=E["a"].LOADING)},w.processStateMachine=function(e,t,a,r,i,n){w.initialize(e,a,r);var s=e.data;if(e.state===E["a"].LOADING&&M(e,t,a,r,i),!n){var c=e.renderable;e.renderable=Object(o["a"])(s.vertexArray);var d=s.terrainState===F["a"].READY;e.upsampledFromParent=Object(o["a"])(s.terrainData)&&s.terrainData.wasCreatedByUpsampling();var u=s.processImagery(e,a,t);if(d&&u){var l=e._loadedCallbacks,h={};for(var p in l)l.hasOwnProperty(p)&&(l[p](e)||(h[p]=l[p]));e._loadedCallbacks=h,e.state=E["a"].DONE}c&&(e.renderable=!0)}},w.prototype.processImagery=function(e,t,a,r){var i,n,s=e.data,c=e.upsampledFromParent,d=!1,u=!0,l=s.imagery;for(i=0,n=l.length;i<n;++i){var h=l[i];if(Object(o["a"])(h.loadingImagery)){if(h.loadingImagery.state===x["a"].PLACEHOLDER){var p=h.loadingImagery.imageryLayer;if(p.imageryProvider.ready){h.freeResources(),l.splice(i,1),p._createTileImagerySkeletons(e,t,i),--i,n=l.length;continue}c=!1}var m=h.processStateMachine(e,a,r);u=u&&m,d=d||m||Object(o["a"])(h.readyImagery),c=c&&Object(o["a"])(h.loadingImagery)&&(h.loadingImagery.state===x["a"].FAILED||h.loadingImagery.state===x["a"].INVALID)}else c=!1}return e.upsampledFromParent=c,e.renderable=e.renderable&&(d||u),u};var k={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,throttle:!0};function U(e,t,a,r,n,s){var c=a.tilingScheme,u=k;u.tilingScheme=c,u.x=r,u.y=n,u.level=s,u.exaggeration=t.terrainExaggeration,u.throttle=!0;var l=e.terrainData,h=l.createMesh(u);Object(o["a"])(h)&&(e.terrainState=F["a"].TRANSFORMING,Object(O["a"])(h,(function(t){e.mesh=t,e.orientedBoundingBox=d["a"].clone(t.orientedBoundingBox,e.orientedBoundingBox),e.occludeePointInScaledSpace=i["a"].clone(t.occludeePointInScaledSpace,e.occludeePointInScaledSpace),e.terrainState=F["a"].TRANSFORMED}),(function(){e.terrainState=F["a"].FAILED})))}function H(e,t,a,r,i,n,o){e.vertexArray=w._createVertexArrayForMesh(t,e.mesh),e.terrainState=F["a"].READY,e.fill=e.fill&&e.fill.destroy(o)}function G(e){var t=e.cache.tile_waterMaskData;if(!Object(o["a"])(t)){var a=T["a"].create({context:e,pixelFormat:u["a"].LUMINANCE,pixelDatatype:y["a"].UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});a.referenceCount=1;var r=new v["a"]({wrapS:C["a"].CLAMP_TO_EDGE,wrapT:C["a"].CLAMP_TO_EDGE,minificationFilter:A["a"].LINEAR,magnificationFilter:b["a"].LINEAR});t={allWaterTexture:a,sampler:r,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function V(e,t){var a,r=t.terrainData.waterMask,i=G(e),o=r.length;if(1===o){if(0===r[0])return;a=i.allWaterTexture}else{var s=Math.sqrt(o);a=T["a"].create({context:e,pixelFormat:u["a"].LUMINANCE,pixelDatatype:y["a"].UNSIGNED_BYTE,source:{width:s,height:s,arrayBufferView:r},sampler:i.sampler,flipY:!1}),a.referenceCount=0}++a.referenceCount,t.waterMaskTexture=a,n["a"].fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}w._createVertexArrayForMesh=function(e,t){var a=t.vertices,r=g["a"].createVertexBuffer({context:e,typedArray:a,usage:_["a"].STATIC_DRAW}),i=t.encoding.getAttributes(r),n=t.indices.indexBuffers||{},c=n[e.id];if(!Object(o["a"])(c)||c.isDestroyed()){var d=t.indices;c=g["a"].createIndexBuffer({context:e,typedArray:d,usage:_["a"].STATIC_DRAW,indexDatatype:s["a"].fromSizeInBytes(d.BYTES_PER_ELEMENT)}),c.vertexArrayDestroyable=!1,c.referenceCount=1,n[e.id]=c,t.indices.indexBuffers=n}else++c.referenceCount;return new S["a"]({context:e,attributes:i,indexBuffer:c})},w._freeVertexArray=function(e){if(Object(o["a"])(e)){var t=e.indexBuffer;e.destroy(),Object(o["a"])(t)&&!t.isDestroyed()&&Object(o["a"])(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},w.prototype._findAncestorTileWithTerrainData=function(e){var t=e.parent;while(Object(o["a"])(t)&&(!Object(o["a"])(t.data)||!Object(o["a"])(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling()))t=t.parent;return t},w.prototype._computeWaterMaskTranslationAndScale=function(e,t,a){var r=t.rectangle,i=e.rectangle,n=i.width,o=i.height,s=n/r.width,c=o/r.height;return a.x=s*(i.west-r.west)/n,a.y=c*(i.south-r.south)/o,a.z=s,a.w=c,a},t["a"]=w},3209:function(e,t,a){"use strict";var r=a("cef5"),i=a("b081"),n=a("670c"),o=a("be18"),s=a("a561"),c=a("bef8"),d=a("dc1c"),u=a("bd8d"),l=a("9541"),h=a("2bb9"),p=a("535a"),m=a("2f63"),f=a("7d62"),g=a("21d7"),_=a("d9403"),y=a("c1e2"),v=a("0123"),T=a("66bf"),b=a("93da"),A=a("52f0"),C=a("6dfc"),S=a("78e5"),O=a("713f"),x=a("1b8d"),E=a("eace"),D=a("98f6"),F=a("fe57"),w=a("2368"),L=a("1184"),P=a("f20a"),N=a("8b68"),R=a("b997"),I=a("a894"),M=a("d289"),B=a("6dc0"),j=a("7c5e"),k=a("b7c8"),U=a("43ee"),H=a("06f0"),G=a("2856"),V=a("ad4a"),Y=a("dddf"),q=a("3a8e"),W=a("894b"),z=a("f1b3"),K=a("a307"),X=a("c86b"),Q=a("2221"),Z=a("4c22"),J=a("1ec0"),$=a("ee78");function ee(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=X["a"].RECEIVE_ONLY,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new g["a"],this._imageryLayers.layerAdded.addEventListener(ee.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(ee.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(ee.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(ee.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new g["a"],this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new u["a"](0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=E["a"].clone(E["a"].MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1}function te(e,t){var a=e.loadingImagery;Object(m["a"])(a)||(a=e.readyImagery);var r=t.loadingImagery;return Object(m["a"])(r)||(r=t.readyImagery),a.imageryLayer._layerIndex-r.imageryLayer._layerIndex}function ae(e,t){var a=t.creditDisplay;e._terrainProvider.ready&&Object(m["a"])(e._terrainProvider.credit)&&a.addCredit(e._terrainProvider.credit);for(var r=e._imageryLayers,i=0,n=r.length;i<n;++i){var o=r.get(i).imageryProvider;o.ready&&Object(m["a"])(o.credit)&&a.addCredit(o.credit)}}function re(e,t){var a=t.globeTranslucencyState;if(a.translucent){var r=e.renderState.blending.enabled;a.pushDerivedCommands(e,r,t)}else t.commandList.push(e)}Object.defineProperties(ee.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=s["a"].fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,Object(m["a"])(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){U["a"].setOwner(e,this,"_clippingPlanes")}}}),ee.prototype.update=function(e){this._imageryLayers._update()},ee.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(te)}))),ae(this,e);for(var t=this._vertexArraysToDestroy,a=t.length,r=0;r<a;++r)G["a"]._freeVertexArray(t[r]);t.length=0},ee.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,a=0,r=t.length;a<r;++a){var i=t[a];Object(m["a"])(i)&&(i.length=0)}var n=this._clippingPlanes;Object(m["a"])(n)&&n.enabled&&n.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},ee.prototype.endUpdate=function(e){if(!Object(m["a"])(this._renderState)){this._renderState=B["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:H["a"].LESS}}),this._blendRenderState=B["a"].fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:H["a"].LESS_OR_EQUAL},blending:k["a"].ALPHA_BLEND});var t=Object(d["a"])(this._renderState,!0);t.cull.enabled=!1,this._disableCullingRenderState=B["a"].fromCache(t),t=Object(d["a"])(this._blendRenderState,!0),t.cull.enabled=!1,this._disableCullingBlendRenderState=B["a"].fromCache(t)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&Q["a"].updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);for(var a=this._tilesToRenderByTextureCount,r=0,i=a.length;r<i;++r){var n=a[r];if(Object(m["a"])(n))for(var o=0,s=n.length;o<s;++o){var c=n[o],u=c.data.tileBoundingRegion;je(this,c,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,u.minimumHeight)}}},ee.prototype.updateForPick=function(e){for(var t=this._drawCommands,a=0,r=this._usedDrawCommands;a<r;++a)re(t[a],e)},ee.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},ee.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},ee.prototype.loadTile=function(e,t){var a,r=t.data,i=!0;Object(m["a"])(r)&&(i=r.boundingVolumeSourceTile!==t||t._lastSelectionResult===$["a"].CULLED_BUT_NEEDED,a=r.terrainState),G["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this._vertexArraysToDestroy,i),r=t.data,i&&a!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==w["a"].NONE&&r.boundingVolumeSourceTile===t&&(i=!1,G["a"].processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this._vertexArraysToDestroy,i))};var ie=new r["a"],ne=new E["a"],oe=new E["a"],se=new c["a"];function ce(e,t){if(t.west<t.east)return t;var a=E["a"].clone(t,oe),r=E["a"].center(e,se);return r.longitude>0?a.east=b["a"].PI:a.west=-b["a"].PI,a}function de(e,t){if(t.cameraUnderground)return!0;if(t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;var a=e._clippingPlanes;return!(!Object(m["a"])(a)||!a.enabled)||!E["a"].equals(e.cartographicLimitRectangle,E["a"].MAX_VALUE)}ee.prototype.computeTileVisibility=function(e,t,a){var i=this.computeDistanceToTile(e,t);e._distance=i;var n=de(this,t);if(t.fog.enabled&&!n&&b["a"].fog(i,t.fog.density)>=1)return w["a"].NONE;var s=e.data,c=s.tileBoundingRegion;if(void 0===s.boundingVolumeSourceTile)return w["a"].PARTIAL;var d=t.cullingVolume,u=s.orientedBoundingBox;!Object(m["a"])(u)&&Object(m["a"])(s.renderedMesh)&&(u=s.renderedMesh.boundingSphere3D),s.clippedByBoundaries=!1;var l=ce(e.rectangle,this.cartographicLimitRectangle),h=E["a"].simpleIntersection(l,e.rectangle,ne);if(!Object(m["a"])(h))return w["a"].NONE;if(E["a"].equals(h,e.rectangle)||(s.clippedByBoundaries=!0),t.mode!==K["a"].SCENE3D&&(u=ie,r["a"].fromRectangleWithHeights2D(e.rectangle,t.mapProjection,c.minimumHeight,c.maximumHeight,u),o["a"].fromElements(u.center.z,u.center.x,u.center.y,u.center),t.mode===K["a"].MORPHING&&Object(m["a"])(s.renderedMesh)&&(u=r["a"].union(s.renderedMesh.boundingSphere3D,u,u))),!Object(m["a"])(u))return w["a"].PARTIAL;var p,f=this._clippingPlanes;if(Object(m["a"])(f)&&f.enabled){var g=f.computeIntersectionWithBoundingVolume(u);if(e.isClipped=g!==T["a"].INSIDE,g===T["a"].OUTSIDE)return w["a"].NONE}var _=d.computeVisibility(u);if(_===T["a"].OUTSIDE?p=w["a"].NONE:_===T["a"].INTERSECTING?p=w["a"].PARTIAL:_===T["a"].INSIDE&&(p=w["a"].FULL),p===w["a"].NONE)return p;var y=t.mode===K["a"].SCENE3D&&t.camera.frustum instanceof O["a"];if(t.mode===K["a"].SCENE3D&&!y&&Object(m["a"])(a)&&!n){var v=s.occludeePointInScaledSpace;return Object(m["a"])(v)?a.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(v,c.minimumHeight)?p:w["a"].NONE:p}return p},ee.prototype.canRefine=function(e){if(Object(m["a"])(e.data.terrainData))return!0;var t=this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1);return void 0!==t};var ue=[],le=[];ee.prototype.canRenderWithoutLosingDetail=function(e,t){var a=e.data,r=ue;r.length=this._imageryLayers.length;var i,n,o,s=!1,c=!1;for(Object(m["a"])(a)&&(s=a.terrainState===Z["a"].READY,c=!0,i=a.imagery),n=0,o=r.length;n<o;++n)r[n]=c;if(Object(m["a"])(i))for(n=0,o=i.length;n<o;++n){var d=i[n],u=d.loadingImagery,l=!Object(m["a"])(u)||u.state===Y["a"].FAILED||u.state===Y["a"].INVALID,h=(d.loadingImagery||d.readyImagery).imageryLayer._layerIndex;r[h]=l&&r[h]}var p=this.quadtree._lastSelectionFrameNumber,f=le;f.length=0,f.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);while(f.length>0){var g=f.pop(),_=g._lastSelectionResultFrame===p?g._lastSelectionResult:$["a"].NONE;if(_===$["a"].RENDERED){var y=g.data;if(!Object(m["a"])(y))continue;if(!s&&g.data.terrainState===Z["a"].READY)return!1;var v=g.data.imagery;for(n=0,o=v.length;n<o;++n){var T=v[n],b=T.loadingImagery,A=!Object(m["a"])(b)||b.state===Y["a"].FAILED||b.state===Y["a"].INVALID,C=(T.loadingImagery||T.readyImagery).imageryLayer._layerIndex;if(A&&!r[C])return!1}}else _===$["a"].REFINED&&f.push(g.southwestChild,g.southeastChild,g.northwestChild,g.northeastChild)}return!0};var he=new o["a"];ee.prototype.computeTileLoadPriority=function(e,t){var a=e.data;if(void 0===a)return 0;var r=a.orientedBoundingBox;if(void 0===r)return 0;var i=t.camera.positionWC,n=t.camera.directionWC,s=o["a"].subtract(r.center,i,he),c=o["a"].magnitude(s);return c<b["a"].EPSILON5?0:(o["a"].divideByScalar(s,c,s),(1-o["a"].dot(s,n))*e._distance)};var pe=new A["a"],me=new A["a"],fe=new s["a"],ge=new s["a"],_e=new s["a"],ye=new o["a"],ve=new o["a"],Te=new o["a"],be=new o["a"];ee.prototype.showTileThisFrame=function(e,t){for(var a=0,r=e.data.imagery,i=0,n=r.length;i<n;++i){var o=r[i];Object(m["a"])(o.readyImagery)&&0!==o.readyImagery.imageryLayer.alpha&&++a}var s=this._tilesToRenderByTextureCount[a];Object(m["a"])(s)||(s=[],this._tilesToRenderByTextureCount[a]=s),s.push(e);var c=e.data;Object(m["a"])(c.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;var d=this._debug;++d.tilesRendered,d.texturesRendered+=a};var Ae=[new o["a"],new o["a"],new o["a"],new o["a"]];function Ce(e,t,a,r,i,n){var s=e.quadtree._occluders.ellipsoid,c=s.ellipsoid,d=Ae;return o["a"].fromRadians(a.west,a.south,i,c,d[0]),o["a"].fromRadians(a.east,a.south,i,c,d[1]),o["a"].fromRadians(a.west,a.north,i,c,d[2]),o["a"].fromRadians(a.east,a.north,i,c,d[3]),s.computeHorizonCullingPointPossiblyUnderEllipsoid(t,d,r,n)}function Se(e,t,a){var r=e.data;void 0===r&&(r=e.data=new G["a"]),void 0===r.tileBoundingRegion&&(r.tileBoundingRegion=new J["a"]({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:0,maximumHeight:0}));var i=r.terrainData,n=r.mesh,o=r.tileBoundingRegion;if(void 0!==n&&void 0!==n.minimumHeight&&void 0!==n.maximumHeight)return o.minimumHeight=n.minimumHeight,o.maximumHeight=n.maximumHeight,e;if(void 0!==i&&void 0!==i._minimumHeight&&void 0!==i._maximumHeight)return o.minimumHeight=i._minimumHeight*a.terrainExaggeration,o.maximumHeight=i._maximumHeight*a.terrainExaggeration,e;o.minimumHeight=Number.NaN,o.maximumHeight=Number.NaN;var s=e.parent;while(void 0!==s){var c=s.data;if(void 0!==c){var d=c.mesh;if(void 0!==d&&void 0!==d.minimumHeight&&void 0!==d.maximumHeight)return o.minimumHeight=d.minimumHeight,o.maximumHeight=d.maximumHeight,s;var u=c.terrainData;if(void 0!==u&&void 0!==u._minimumHeight&&void 0!==u._maximumHeight)return o.minimumHeight=u._minimumHeight*a.terrainExaggeration,o.maximumHeight=u._maximumHeight*a.terrainExaggeration,s}s=s.parent}}function Oe(e,t,a){return function(r){var i,n,o,s=-1,c=r.data.imagery,d=c.length;for(o=0;o<d;++o)if(i=c[o],n=Object(p["a"])(i.readyImagery,i.loadingImagery),n.imageryLayer===t){s=o;break}if(-1!==s){var u=s+e;if(i=c[u],n=Object(m["a"])(i)?Object(p["a"])(i.readyImagery,i.loadingImagery):void 0,!Object(m["a"])(n)||n.imageryLayer!==t)return!t._createTileImagerySkeletons(r,a,u);for(o=s;o<u;++o)c[o].freeResources();c.splice(s,e)}return!0}}ee.prototype.computeDistanceToTile=function(e,t){var a=Se(e,this.terrainProvider,t),r=e.data,i=r.tileBoundingRegion;if(void 0===a)return 9999999999;if(r.boundingVolumeSourceTile!==a){r.boundingVolumeSourceTile=a;var n=e.rectangle;Object(m["a"])(n)&&(r.orientedBoundingBox=S["a"].fromRectangle(e.rectangle,i.minimumHeight,i.maximumHeight,e.tilingScheme.ellipsoid,r.orientedBoundingBox),r.occludeePointInScaledSpace=Ce(this,r.orientedBoundingBox.center,e.rectangle,i.minimumHeight,i.maximumHeight,r.occludeePointInScaledSpace))}var o=i.minimumHeight,s=i.maximumHeight;if(r.boundingVolumeSourceTile!==e){var c=t.camera.positionCartographic.height,d=Math.abs(c-o),u=Math.abs(c-s);d>u?(i.minimumHeight=o,i.maximumHeight=o):(i.minimumHeight=s,i.maximumHeight=s)}var l=i.distanceToCamera(t);return i.minimumHeight=o,i.maximumHeight=s,l},ee.prototype.isDestroyed=function(){return!1},ee.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(f["a"])(this)},ee.prototype._onLayerAdded=function(e,t){if(e.show){var a=this._terrainProvider,r=this,i=e.imageryProvider,n=this._imageryLayersUpdatedEvent;i._reload=function(){e._imageryCache={},r._quadtree.forEachLoadedTile((function(t){if(!Object(m["a"])(t._loadedCallbacks[e._layerIndex])){var r,i=t.data.imagery,n=i.length,o=-1,s=0;for(r=0;r<n;++r){var c=i[r],d=Object(p["a"])(c.readyImagery,c.loadingImagery);if(d.imageryLayer===e)-1===o&&(o=r),++s;else if(-1!==o)break}if(-1!==o){var u=o+s;e._createTileImagerySkeletons(t,a,u)&&(t._loadedCallbacks[e._layerIndex]=Oe(s,e,a),t.state=z["a"].LOADING)}}}))},this._quadtree.forEachLoadedTile((function(t){e._createTileImagerySkeletons(t,a)&&(t.state=z["a"].LOADING,0===t.level||t._lastSelectionResultFrame===r.quadtree._lastSelectionFrameNumber&&t._lastSelectionResult===$["a"].RENDERED||(t.renderable=!1))})),this._layerOrderChanged=!0,n.raiseEvent()}},ee.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){for(var a=t.data.imagery,r=-1,i=0,n=0,o=a.length;n<o;++n){var s=a[n],c=s.loadingImagery;if(Object(m["a"])(c)||(c=s.readyImagery),c.imageryLayer===e)-1===r&&(r=n),s.freeResources(),++i;else if(-1!==r)break}-1!==r&&a.splice(r,i)})),Object(m["a"])(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},ee.prototype._onLayerMoved=function(e,t,a){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},ee.prototype._onLayerShownOrHidden=function(e,t,a){a?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var xe,Ee,De,Fe=new A["a"],we=new A["a"];function Le(e,t){var a={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,a=A["a"].multiplyByPoint(t,this.properties.rtc,ve);return A["a"].setTranslation(t,a,pe),pe},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,a=e.context.uniformState.projection,r=A["a"].multiplyByPoint(t,this.properties.rtc,ve);return A["a"].setTranslation(t,r,me),A["a"].multiply(a,me,me),me},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){var a=t._clippingPlanes;return Object(m["a"])(a)&&Object(m["a"])(a.texture)?a.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){var a=t._clippingPlanes,r=Object(m["a"])(a)?A["a"].multiply(e.context.uniformState.view,a.modelMatrix,Fe):A["a"].IDENTITY;return A["a"].inverseTranspose(r,we)},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},properties:{initialColor:new s["a"](0,0,.5,1),fillHighlightColor:new u["a"](0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new n["a"](65e5,9e6),nightFadeDistance:new n["a"](1e7,4e7),hsbShift:new o["a"],center3D:void 0,rtc:new o["a"],modifiedModelView:new A["a"],tileRectangle:new s["a"],dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new n["a"],southMercatorYAndOneOverHeight:new n["a"],waterMask:void 0,waterMaskTranslationAndScale:new s["a"],minMaxHeight:new n["a"],scaleAndBias:new A["a"],clippingPlanesEdgeColor:u["a"].clone(u["a"].WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new s["a"],frontFaceAlphaByDistance:new s["a"],backFaceAlphaByDistance:new s["a"],localizedTranslucencyRectangle:new s["a"],undergroundColor:u["a"].clone(u["a"].TRANSPARENT),undergroundColorAlphaByDistance:new s["a"]}};return Object(m["a"])(t.materialUniformMap)?Object(h["a"])(a,t.materialUniformMap):a}function Pe(e,t,a){var r,i,n=a.data;if(Object(m["a"])(n.vertexArray)?(r=n.mesh,i=n.vertexArray):Object(m["a"])(n.fill)&&Object(m["a"])(n.fill.vertexArray)&&(r=n.fill.mesh,i=n.fill.vertexArray),Object(m["a"])(r)&&Object(m["a"])(i)){if(Object(m["a"])(n.wireframeVertexArray)){if(n.wireframeVertexArray.mesh===r)return;n.wireframeVertexArray.destroy(),n.wireframeVertexArray=void 0}n.wireframeVertexArray=Ne(e,i,r),n.wireframeVertexArray.mesh=r}}function Ne(e,t,a){var r=a.indices,i={indices:r,primitiveType:x["a"].TRIANGLES};y["a"].toWireframe(i);var n=i.indices,o=P["a"].createIndexBuffer({context:e,typedArray:n,usage:N["a"].STATIC_DRAW,indexDatatype:v["a"].fromSizeInBytes(n.BYTES_PER_ELEMENT)});return new j["a"]({context:e,attributes:t._attributes,indexBuffer:o})}(function(){var e,t,a=new _["a"]({geometry:i["a"].fromDimensions({dimensions:new o["a"](2,2,2)})}),r=new _["a"]({geometry:new D["a"]({radius:1})}),n=new A["a"];function s(e){return new W["a"]({geometryInstances:e,appearance:new q["a"]({translucent:!1,flat:!0}),asynchronous:!1})}xe=function(r,i){return r===e||(De(),e=r,n=A["a"].fromRotationTranslation(r.halfAxes,r.center,n),a.modelMatrix=n,a.attributes.color=l["a"].fromColor(i),t=s(a)),t},Ee=function(a,i){return a===e||(De(),e=a,n=A["a"].fromTranslation(a.center,n),n=A["a"].multiplyByUniformScale(n,a.radius,n),r.modelMatrix=n,r.attributes.color=l["a"].fromColor(i),t=s(r)),t},De=function(){Object(m["a"])(t)&&(t.destroy(),t=void 0,e=void 0)}})();var Re=new s["a"](0,0,0,0),Ie={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0},Me=u["a"].TRANSPARENT,Be=new C["a"];function je(e,t,a){var i=t.data;Object(m["a"])(i.vertexArray)||(void 0===i.fill&&(i.fill=new Q["a"](t)),i.fill.update(e,a));var n=a.creditDisplay,c=i.terrainData;if(Object(m["a"])(c)&&Object(m["a"])(c.credits))for(var d=c.credits,l=0,h=d.length;l<h;++l)n.addCredit(d[l]);var f=R["a"].maximumTextureImageUnits,g=i.waterMaskTexture,_=i.waterMaskTranslationAndScale;!Object(m["a"])(g)&&Object(m["a"])(i.fill)&&(g=i.fill.waterMaskTexture,_=i.fill.waterMaskTranslationAndScale);var y=a.cameraUnderground,v=a.globeTranslucencyState,T=v.translucent,C=v.frontFaceAlphaByDistance,O=v.backFaceAlphaByDistance,D=v.rectangle,w=Object(p["a"])(e.undergroundColor,Me),P=Object(p["a"])(e.undergroundColorAlphaByDistance,Be),N=de(e,a)&&a.mode===K["a"].SCENE3D&&w.alpha>0&&(P.nearValue>0||P.farValue>0),B=e.hasWaterMask&&Object(m["a"])(g),j=e.oceanNormalMap,k=B&&Object(m["a"])(j),U=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,H=a.fog.enabled&&!y,G=e.showGroundAtmosphere&&a.mode===K["a"].SCENE3D,Y=X["a"].castShadows(e.shadows)&&!T,q=X["a"].receiveShadows(e.shadows)&&!T,W=e.hueShift,z=e.saturationShift,Z=e.brightnessShift,J=!(b["a"].equalsEpsilon(W,0,b["a"].EPSILON7)&&b["a"].equalsEpsilon(z,0,b["a"].EPSILON7)&&b["a"].equalsEpsilon(Z,0,b["a"].EPSILON7)),$=!1;if(G){var ee=o["a"].magnitude(a.camera.positionWC),te=e.nightFadeOutDistance;$=ee>te}B&&--f,k&&--f,Object(m["a"])(a.shadowState)&&a.shadowState.shadowsEnabled&&--f,Object(m["a"])(e.clippingPlanes)&&e.clippingPlanes.enabled&&--f,f-=v.numberOfTextureUniforms;var ae=i.renderedMesh,ie=ae.center,oe=ae.encoding,se=fe,ue=0,le=0,he=0,pe=0,me=!1;if(a.mode!==K["a"].SCENE3D){var ve=a.mapProjection,Ae=ve.project(E["a"].southwest(t.rectangle),Te),Ce=ve.project(E["a"].northeast(t.rectangle),be);if(se.x=Ae.x,se.y=Ae.y,se.z=Ce.x,se.w=Ce.y,a.mode!==K["a"].MORPHING&&(ie=ye,ie.x=0,ie.y=.5*(se.z+se.x),ie.z=.5*(se.w+se.y),se.x-=ie.y,se.y-=ie.z,se.z-=ie.y,se.w-=ie.z),a.mode===K["a"].SCENE2D&&oe.quantization===F["a"].BITS12){var Se=1/(Math.pow(2,12)-1)*.5,Oe=(se.z-se.x)*Se,Fe=(se.w-se.y)*Se;se.x-=Oe,se.y-=Fe,se.z+=Oe,se.w+=Fe}ve instanceof L["a"]&&(ue=t.rectangle.south,le=t.rectangle.north,he=L["a"].geodeticLatitudeToMercatorAngle(ue),pe=1/(L["a"].geodeticLatitudeToMercatorAngle(le)-he),me=!0)}var we=Ie;we.frameState=a,we.surfaceTile=i,we.showReflectiveOcean=B,we.showOceanWaves=k,we.enableLighting=e.enableLighting,we.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,we.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,we.showGroundAtmosphere=G,we.perFragmentGroundAtmosphere=$,we.hasVertexNormals=U,we.useWebMercatorProjection=me,we.clippedByBoundaries=i.clippedByBoundaries;var Ne=i.imagery,je=0,ke=Ne.length,Ue=e.showSkirts&&!y&&!T,He=e.backFaceCulling&&!y&&!T,Ge=He?e._renderState:e._disableCullingRenderState,Ve=He?e._blendRenderState:e._disableCullingBlendRenderState,Ye=Ge,qe=e._firstPassInitialColor,We=a.context;Object(m["a"])(e._debug.boundingSphereTile)||De();var ze=e._materialUniformMap!==e.materialUniformMap;if(ze){e._materialUniformMap=e.materialUniformMap;for(var Ke=e._drawCommands.length,Xe=0;Xe<Ke;++Xe)e._uniformMaps[Xe]=Le(a,e)}do{var Qe,Ze,Je=0;if(e._drawCommands.length<=e._usedDrawCommands?(Qe=new I["a"],Qe.owner=t,Qe.cull=!1,Qe.boundingVolume=new r["a"],Qe.orientedBoundingBox=void 0,Ze=Le(a,e),e._drawCommands.push(Qe),e._uniformMaps.push(Ze)):(Qe=e._drawCommands[e._usedDrawCommands],Ze=e._uniformMaps[e._usedDrawCommands]),Qe.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){var $e=i.orientedBoundingBox;Object(m["a"])($e)?xe($e,u["a"].RED).update(a):Object(m["a"])(ae)&&Object(m["a"])(ae.boundingSphere3D)&&Ee(ae.boundingSphere3D,u["a"].RED).update(a)}var et=Ze.properties;s["a"].clone(qe,et.initialColor),et.oceanNormalMap=j,et.lightingFadeDistance.x=e.lightingFadeOutDistance,et.lightingFadeDistance.y=e.lightingFadeInDistance,et.nightFadeDistance.x=e.nightFadeOutDistance,et.nightFadeDistance.y=e.nightFadeInDistance,et.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;var tt=y?O:C,at=y?C:O;Object(m["a"])(tt)&&(s["a"].fromElements(tt.near,tt.nearValue,tt.far,tt.farValue,et.frontFaceAlphaByDistance),s["a"].fromElements(at.near,at.nearValue,at.far,at.farValue,et.backFaceAlphaByDistance)),s["a"].fromElements(P.near,P.nearValue,P.far,P.farValue,et.undergroundColorAlphaByDistance),u["a"].clone(w,et.undergroundColor);var rt=!Object(m["a"])(i.vertexArray)&&Object(m["a"])(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;rt&&u["a"].clone(e.fillHighlightColor,et.fillHighlightColor),et.center3D=ae.center,o["a"].clone(ie,et.rtc),s["a"].clone(se,et.tileRectangle),et.southAndNorthLatitude.x=ue,et.southAndNorthLatitude.y=le,et.southMercatorYAndOneOverHeight.x=he,et.southMercatorYAndOneOverHeight.y=pe;var it=ge,nt=ce(t.rectangle,e.cartographicLimitRectangle),ot=_e,st=ce(t.rectangle,D);o["a"].fromElements(W,z,Z,et.hsbShift);var ct=t.rectangle,dt=1/ct.width,ut=1/ct.height;it.x=(nt.west-ct.west)*dt,it.y=(nt.south-ct.south)*ut,it.z=(nt.east-ct.west)*dt,it.w=(nt.north-ct.south)*ut,s["a"].clone(it,et.localizedCartographicLimitRectangle),ot.x=(st.west-ct.west)*dt,ot.y=(st.south-ct.south)*ut,ot.z=(st.east-ct.west)*dt,ot.w=(st.north-ct.south)*ut,s["a"].clone(ot,et.localizedTranslucencyRectangle);var lt=H&&b["a"].fog(t._distance,a.fog.density)>b["a"].EPSILON3;J=J&&(lt||G);var ht=!1,pt=!1,mt=!1,ft=!1,gt=!1,_t=!1,yt=!1,vt=!1,Tt=!1,bt=!1;while(Je<f&&je<ke){var At=Ne[je],Ct=At.readyImagery;if(++je,Object(m["a"])(Ct)&&0!==Ct.imageryLayer.alpha){var St=At.useWebMercatorT?Ct.textureWebMercator:Ct.texture,Ot=Ct.imageryLayer;Object(m["a"])(At.textureTranslationAndScale)||(At.textureTranslationAndScale=Ot._calculateTextureTranslationAndScale(t,At)),et.dayTextures[Je]=St,et.dayTextureTranslationAndScale[Je]=At.textureTranslationAndScale,et.dayTextureTexCoordsRectangle[Je]=At.textureCoordinateRectangle,et.dayTextureUseWebMercatorT[Je]=At.useWebMercatorT,et.dayTextureAlpha[Je]=Ot.alpha,_t=_t||1!==et.dayTextureAlpha[Je],et.dayTextureNightAlpha[Je]=Ot.nightAlpha,yt=yt||1!==et.dayTextureNightAlpha[Je],et.dayTextureDayAlpha[Je]=Ot.dayAlpha,yt=yt||1!==et.dayTextureDayAlpha[Je],et.dayTextureBrightness[Je]=Ot.brightness,ht=ht||et.dayTextureBrightness[Je]!==V["a"].DEFAULT_BRIGHTNESS,et.dayTextureContrast[Je]=Ot.contrast,pt=pt||et.dayTextureContrast[Je]!==V["a"].DEFAULT_CONTRAST,et.dayTextureHue[Je]=Ot.hue,mt=mt||et.dayTextureHue[Je]!==V["a"].DEFAULT_HUE,et.dayTextureSaturation[Je]=Ot.saturation,ft=ft||et.dayTextureSaturation[Je]!==V["a"].DEFAULT_SATURATION,et.dayTextureOneOverGamma[Je]=1/Ot.gamma,gt=gt||et.dayTextureOneOverGamma[Je]!==1/V["a"].DEFAULT_GAMMA,et.dayTextureSplit[Je]=Ot.splitDirection,vt=vt||0!==et.dayTextureSplit[Je];var xt=et.dayTextureCutoutRectangles[Je];if(Object(m["a"])(xt)||(xt=et.dayTextureCutoutRectangles[Je]=new s["a"]),s["a"].clone(s["a"].ZERO,xt),Object(m["a"])(Ot.cutoutRectangle)){var Et=ce(ct,Ot.cutoutRectangle),Dt=E["a"].simpleIntersection(Et,ct,ne);Tt=Object(m["a"])(Dt)||Tt,xt.x=(Et.west-ct.west)*dt,xt.y=(Et.south-ct.south)*ut,xt.z=(Et.east-ct.west)*dt,xt.w=(Et.north-ct.south)*ut}var Ft=et.colorsToAlpha[Je];Object(m["a"])(Ft)||(Ft=et.colorsToAlpha[Je]=new s["a"]);var wt=Object(m["a"])(Ot.colorToAlpha)&&Ot.colorToAlphaThreshold>0;if(bt=bt||wt,wt){var Lt=Ot.colorToAlpha;Ft.x=Lt.red,Ft.y=Lt.green,Ft.z=Lt.blue,Ft.w=Ot.colorToAlphaThreshold}else Ft.w=-1;if(Object(m["a"])(Ct.credits))for(var Pt=Ct.credits,Nt=0,Rt=Pt.length;Nt<Rt;++Nt)n.addCredit(Pt[Nt]);++Je}}et.dayTextures.length=Je,et.waterMask=g,s["a"].clone(_,et.waterMaskTranslationAndScale),et.minMaxHeight.x=oe.minimumHeight,et.minMaxHeight.y=oe.maximumHeight,A["a"].clone(oe.matrix,et.scaleAndBias);var It=e._clippingPlanes,Mt=Object(m["a"])(It)&&It.enabled&&t.isClipped;Mt&&(et.clippingPlanesEdgeColor=u["a"].clone(It.edgeColor,et.clippingPlanesEdgeColor),et.clippingPlanesEdgeWidth=It.edgeWidth),we.numberOfDayTextures=Je,we.applyBrightness=ht,we.applyContrast=pt,we.applyHue=mt,we.applySaturation=ft,we.applyGamma=gt,we.applyAlpha=_t,we.applyDayNightAlpha=yt,we.applySplit=vt,we.enableFog=lt,we.enableClippingPlanes=Mt,we.clippingPlanes=It,we.hasImageryLayerCutout=Tt,we.colorCorrect=J,we.highlightFillTile=rt,we.colorToAlpha=bt,we.showUndergroundColor=N,we.translucent=T;var Bt=i.renderedMesh.indices.length;Ue||(Bt=i.renderedMesh.indexCountWithoutSkirts),Qe.shaderProgram=e._surfaceShaderSet.getShaderProgram(we),Qe.castShadows=Y,Qe.receiveShadows=q,Qe.renderState=Ye,Qe.primitiveType=x["a"].TRIANGLES,Qe.vertexArray=i.vertexArray||i.fill.vertexArray,Qe.count=Bt,Qe.uniformMap=Ze,Qe.pass=M["a"].GLOBE,e._debug.wireframe&&(Pe(We,e,t),Object(m["a"])(i.wireframeVertexArray)&&(Qe.vertexArray=i.wireframeVertexArray,Qe.primitiveType=x["a"].LINES,Qe.count=2*Bt));var jt=Qe.boundingVolume,kt=Qe.orientedBoundingBox;if(a.mode!==K["a"].SCENE3D){var Ut=i.tileBoundingRegion;r["a"].fromRectangleWithHeights2D(t.rectangle,a.mapProjection,Ut.minimumHeight,Ut.maximumHeight,jt),o["a"].fromElements(jt.center.z,jt.center.x,jt.center.y,jt.center),a.mode===K["a"].MORPHING&&(jt=r["a"].union(ae.boundingSphere3D,jt,jt))}else Qe.boundingVolume=r["a"].clone(ae.boundingSphere3D,jt),Qe.orientedBoundingBox=S["a"].clone(i.orientedBoundingBox,kt);Qe.dirty=!0,T&&v.updateDerivedCommands(Qe,a),re(Qe,a),Ye=Ve,qe=Re}while(je<ke)}t["a"]=ee},"324a":function(e,t,a){"use strict";var r=a("7229"),i=a("8dfe"),n=a("535a"),o=a("2f63"),s=a("21d7"),c=a("5d5c"),d=a("eace"),u=a("d4ed"),l=a("283e"),h=a("a89b"),p=a("d3a0"),m=a("a58e"),f=a("64ac");function g(e){e=Object(n["a"])(e,{}),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=1.9,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;var t=e.url,a=Object(n["a"])(e.path,"/default_map"),r=u["a"].createIfNeeded(t).getDerivedResource({url:"/"===a[0]?a.substring(1):a});r.appendForwardSlash(),this._resource=r,this._url=t,this._path=a,this._tileDiscardPolicy=e.tileDiscardPolicy,this._channel=e.channel,this._requestType="ImageryMaps",this._credit=new i["a"]('<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="'+g.logoUrl+'" title="Google Imagery"/></a>'),this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=e.maximumLevel,this._errorEvent=new s["a"],this._ready=!1,this._readyPromise=m["a"].defer();var f,_=r.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),y=this;function v(t){var a,r,i;try{a=JSON.parse(t)}catch(s){a=JSON.parse(t.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(var n=0;n<a.layers.length;n++)if(a.layers[n].id===y._channel){r=a.layers[n];break}if(!Object(o["a"])(r))throw i="Could not find layer with channel (id) of "+y._channel+".",f=h["a"].handleError(f,y,y._errorEvent,i,void 0,void 0,void 0,b),new l["a"](i);if(!Object(o["a"])(r.version))throw i="Could not find a version in channel (id) "+y._channel+".",f=h["a"].handleError(f,y,y._errorEvent,i,void 0,void 0,void 0,b),new l["a"](i);if(y._version=r.version,Object(o["a"])(a.projection)&&"flat"===a.projection)y._tilingScheme=new c["a"]({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new d["a"](-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:e.ellipsoid});else{if(Object(o["a"])(a.projection)&&"mercator"!==a.projection)throw i="Unsupported projection "+a.projection+".",f=h["a"].handleError(f,y,y._errorEvent,i,void 0,void 0,void 0,b),new l["a"](i);y._tilingScheme=new p["a"]({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid})}y._ready=!0,y._readyPromise.resolve(!0),h["a"].handleSuccess(f)}function T(e){var t="An error occurred while accessing "+_.url+".";f=h["a"].handleError(f,y,y._errorEvent,t,void 0,void 0,void 0,b),y._readyPromise.reject(new l["a"](t))}function b(){var e=_.fetchText();Object(m["a"])(e,v,T)}b()}Object.defineProperties(g.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),g.prototype.getTileCredits=function(e,t,a){},g.prototype.requestImage=function(e,t,a,r){var i=this._resource.getDerivedResource({url:"query",request:r,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:a+1}});return f["a"].loadImage(this,i)},g.prototype.pickFeatures=function(e,t,a,r,i){},g._logoUrl=void 0,Object.defineProperties(g,{logoUrl:{get:function(){return Object(o["a"])(g._logoUrl)||(g._logoUrl=Object(r["a"])("Assets/Images/google_earth_credit.png")),g._logoUrl},set:function(e){g._logoUrl=e}}}),t["a"]=g},5225:function(e,t,a){"use strict";var r=a("2f63"),i=a("6dfc"),n=a("eace");function o(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=n["a"].clone(n["a"].MAX_VALUE)}Object.defineProperties(o.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){this._frontFaceAlphaByDistance=i["a"].clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){this._backFaceAlphaByDistance=i["a"].clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){Object(r["a"])(e)||(e=n["a"].clone(n["a"].MAX_VALUE)),n["a"].clone(e,this._rectangle)}}}),t["a"]=o},"548a":function(e,t,a){"use strict";var r=a("8dfe"),i=a("6673"),n=a("535a"),o=a("2f63"),s=a("21d7"),c=a("5d5c"),d=a("9e72"),u=a("d69d"),l=a("93da"),h=a("eace"),p=a("de66"),m=a("d4ed"),f=a("283e"),g=a("a89b"),_=a("e39e"),y=a("a58e");function v(){this._image=new Image}function T(e){var t;if(e=Object(n["a"])(e,n["a"].EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,Object(o["a"])(e.metadata))t=e.metadata;else{var a=m["a"].createIfNeeded(e.url);t=new d["a"](a)}this._metadata=t,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new c["a"]({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new h["a"](-l["a"].PI,-l["a"].PI,l["a"].PI,l["a"].PI),ellipsoid:e.ellipsoid});var i=e.credit;"string"===typeof i&&(i=new r["a"](i)),this._credit=i,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,Object(o["a"])(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new v),this._errorEvent=new s["a"],this._ready=!1;var u,p=this;this._readyPromise=t.readyPromise.then((function(e){if(!t.imageryPresent){var a=new f["a"]("The server "+t.url+" doesn't have imagery");return u=g["a"].handleError(u,p,p._errorEvent,a.message,void 0,void 0,void 0,a),y["a"].reject(a)}return g["a"].handleSuccess(u),p._ready=e,e})).otherwise((function(e){return u=g["a"].handleError(u,p,p._errorEvent,e.message,void 0,void 0,void 0,e),y["a"].reject(e)}))}function b(e,t,a,r,i,n){var s=d["a"].tileXYToQuadKey(a,r,i),c=t.imageryVersion;return c=Object(o["a"])(c)&&c>0?c:1,e._metadata.resource.getDerivedResource({url:"flatfile?f1-0"+s+"-i."+c.toString(),request:n})}function A(e){var t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3))return"image/jpeg";var a="PNG";return e[1]===a.charCodeAt(0)&&e[2]===a.charCodeAt(1)&&e[3]===a.charCodeAt(2)?"image/png":void 0}function C(e){var t=_["a"].Reader.create(e),a=t.len,r={};while(t.pos<a){var i=t.uint32();switch(i>>>3){case 1:r.imageType=t.uint32();break;case 2:r.imageData=t.bytes();break;case 3:r.alphaType=t.uint32();break;case 4:r.imageAlpha=t.bytes();break;case 5:var n=r.copyrightIds;if(Object(o["a"])(n)||(n=r.copyrightIds=[]),2===(7&i)){var s=t.uint32()+t.pos;while(t.pos<s)n.push(t.uint32())}else n.push(t.uint32());break;default:t.skipType(7&i);break}}var c=r.imageType;if(Object(o["a"])(c))switch(c){case 0:r.imageType="image/jpeg";break;case 4:r.imageType="image/png";break;default:throw new f["a"]("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}var d=r.alphaType;return Object(o["a"])(d)&&0!==d&&(delete r.alphaType,delete r.imageAlpha),r}v.prototype.isReady=function(){return!0},v.prototype.shouldDiscardImage=function(e){return e===this._image},Object.defineProperties(T.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}}),T.prototype.getTileCredits=function(e,t,a){var r=this._metadata,i=r.getTileInformation(e,t,a);if(Object(o["a"])(i)){var n=r.providers[i.imageryProvider];if(Object(o["a"])(n))return[n]}},T.prototype.requestImage=function(e,t,a,r){var n=this._tileDiscardPolicy._image,s=this._metadata,c=d["a"].tileXYToQuadKey(e,t,a),l=s.getTileInformation(e,t,a);if(!Object(o["a"])(l)){if(s.isValid(c)){var h=new p["a"]({throttle:r.throttle,throttleByServer:r.throttleByServer,type:r.type,priorityFunction:r.priorityFunction});return void s.populateSubtree(e,t,a,h)}return n}if(!l.hasImagery())return n;var m=b(this,l,e,t,a,r).fetchArrayBuffer();return Object(o["a"])(m)?m.then((function(e){Object(i["a"])(s.key,e);var t,a=new Uint8Array(e),r=s.protoImagery;if(Object(o["a"])(r)&&r||(t=A(a)),!Object(o["a"])(t)&&(!Object(o["a"])(r)||r)){var c=C(a);t=c.imageType,a=c.imageData}return Object(o["a"])(t)&&Object(o["a"])(a)?Object(u["a"])({uint8Array:a,format:t,flipY:!0}):n})):void 0},T.prototype.pickFeatures=function(e,t,a,r,i){},t["a"]=T},"6b72":function(e,t,a){"use strict";var r=a("2bb9"),i=a("535a"),n=a("2f63"),o=a("6dfc"),s=a("eace"),c=a("a894"),d=a("d289"),u=a("6dc0"),l=a("5770"),h=a("b7c8"),p=a("29ab"),m=a("a307"),f={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},g=f.DERIVED_COMMANDS_MAXIMUM_LENGTH,_=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function y(){this._frontFaceAlphaByDistance=new o["a"](0,1,0,1),this._backFaceAlphaByDistance=new o["a"](0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=s["a"].clone(s["a"].MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(g),this._derivedBlendCommandTypes=new Array(g),this._derivedPickCommandTypes=new Array(g),this._derivedCommandTypesToUpdate=new Array(g),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function v(e,t,a,r){return e?Object(n["a"])(a)?(o["a"].clone(a,r),r.nearValue*=t,r.farValue*=t,r):(r.nearValue=t,r.farValue=t,r):(r.nearValue=1,r.farValue=1,r)}function T(e,t,a){return e&&(a.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function b(e,t){var a=e._frontFaceTranslucent,r=e._backFaceTranslucent;return a&&(t.cameraUnderground||r)}function A(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function C(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function S(e,t,a){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!a.depthTestAgainstTerrain&&t.mode!==m["a"].SCENE2D&&t.context.depthTexture}function O(e){var t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function x(e,t){var a;e._derivedCommandsLength=E(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=E(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=E(e,t,!1,!0,e._derivedPickCommandTypes);var r=0;for(a=0;a<e._derivedCommandsLength;++a)r|=1<<e._derivedCommandTypes[a];for(a=0;a<e._derivedBlendCommandsLength;++a)r|=1<<e._derivedBlendCommandTypes[a];for(a=0;a<e._derivedPickCommandsLength;++a)r|=1<<e._derivedPickCommandTypes[a];var i=0;for(a=0;a<g;++a)(r&1<<a)>0&&(e._derivedCommandTypesToUpdate[i++]=a);e._derivedCommandsToUpdateLength=i;var o=r!==e._derivedCommandKey;e._derivedCommandKey=r,e._derivedCommandsDirty=o,!Object(n["a"])(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=J())}function E(e,t,a,r,i){var n=0,o=e._frontFaceTranslucent,s=e._backFaceTranslucent;if(!o)return n;var c=t.cameraUnderground,d=e._requiresManualDepthTest,u=r?f.PICK_FRONT_FACE:d?f.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:f.TRANSLUCENT_FRONT_FACE,l=r?f.PICK_BACK_FACE:d?f.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:f.TRANSLUCENT_BACK_FACE;return t.mode===m["a"].SCENE2D?(i[n++]=f.DEPTH_ONLY_FRONT_FACE,i[n++]=u,n):(s?(a||(i[n++]=f.DEPTH_ONLY_FRONT_AND_BACK_FACE),c?(i[n++]=u,i[n++]=l):(i[n++]=l,i[n++]=u)):c?(a||(i[n++]=f.DEPTH_ONLY_BACK_FACE),i[n++]=f.OPAQUE_FRONT_FACE,i[n++]=l):(a||(i[n++]=f.DEPTH_ONLY_FRONT_FACE),i[n++]=f.OPAQUE_BACK_FACE,i[n++]=u),n)}function D(e,t){var a=e.indexOf(t);a>-1&&e.splice(a,1)}function F(e,t){return e.indexOf(t)>-1}function w(e,t){D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function L(e,t){D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG"),D(e.defines,"TRANSLUCENT"),D(t.defines,"TRANSLUCENT")}function P(e,t){if(!F(t.defines,"TILE_LIMIT_RECTANGLE")&&!F(t.defines,"ENABLE_CLIPPING_PLANES")){var a="void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n";t.sources=[a]}}function N(e,t){for(var a=t.sources,r=a.length,i=0;i<r;++i)a[i]=l["a"].replaceMain(a[i],"czm_globe_translucency_main");var n="\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture2D(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    gl_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + gl_FragColor * (1.0 - classificationColor.a); \n} \n";a.push(n)}function R(e,t){N(e,t),D(e.defines,"GROUND_ATMOSPHERE"),D(t.defines,"GROUND_ATMOSPHERE"),D(e.defines,"FOG"),D(t.defines,"FOG")}function I(e,t){N(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function M(e,t){R(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function B(e,t){var a="uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture2D(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    gl_FragColor = pickColor; \n} \n";t.sources=[a]}function j(e,t,a,r,i,o){if(!Object(n["a"])(i))return t;if(!r&&Object(n["a"])(a))return a;var s=e.shaderCache.getDerivedShaderProgram(t,o);if(!Object(n["a"])(s)){var c=t._attributeLocations,d=t.vertexShaderSource.clone(),u=t.fragmentShaderSource.clone();d.defines=Object(n["a"])(d.defines)?d.defines.slice(0):[],u.defines=Object(n["a"])(u.defines)?u.defines.slice(0):[],i(d,u),s=e.shaderCache.createDerivedShaderProgram(t,o,{vertexShaderSource:d,fragmentShaderSource:u,attributeLocations:c})}return s}function k(e){e.cull.face=p["a"].BACK,e.cull.enabled=!0}function U(e){e.cull.face=p["a"].FRONT,e.cull.enabled=!0}function H(e){e.cull.face=p["a"].BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function G(e){e.cull.face=p["a"].FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function V(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function Y(e){e.cull.face=p["a"].BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function q(e){e.cull.face=p["a"].FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=h["a"].ALPHA_BLEND}function W(e){e.cull.face=p["a"].BACK,e.cull.enabled=!0,e.blending.enabled=!1}function z(e){e.cull.face=p["a"].FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function K(e,t,a,r,i){if(!Object(n["a"])(r))return e;if(!a&&Object(n["a"])(t))return t;var o=i[e.id];if(!Object(n["a"])(o)){var s=u["a"].getState(e);r(s),o=u["a"].fromCache(s),i[e.id]=o}return o}function X(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function Q(e,t,a,i,o){return Object(n["a"])(o)?!i&&Object(n["a"])(a)?a:Object(r["a"])(t,o(e),!1):t}function Z(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function J(){return[new Z({pass:d["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:w,getRenderStateFunction:k,getUniformMapFunction:void 0}),new Z({pass:d["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:L,getRenderStateFunction:U,getUniformMapFunction:void 0}),new Z({pass:d["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:H,getUniformMapFunction:void 0}),new Z({pass:d["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:G,getUniformMapFunction:void 0}),new Z({pass:d["a"].GLOBE,pickOnly:!1,getShaderProgramFunction:P,getRenderStateFunction:V,getUniformMapFunction:void 0}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:N,getRenderStateFunction:Y,getUniformMapFunction:X}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:R,getRenderStateFunction:q,getUniformMapFunction:X}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:I,getRenderStateFunction:Y,getUniformMapFunction:X}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:M,getRenderStateFunction:q,getUniformMapFunction:X}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:B,getRenderStateFunction:W,getUniformMapFunction:X}),new Z({pass:d["a"].TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:B,getRenderStateFunction:z,getUniformMapFunction:X})]}Object.defineProperties(y.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),y.prototype.update=function(e){var t=e.globe;if(!Object(n["a"])(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=v(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=v(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=T(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=T(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=S(this,e,t),this._sunVisibleThroughGlobe=b(this,e),this._environmentVisible=A(this,e),this._useDepthPlane=C(this,e),this._numberOfTextureUniforms=O(this),this._rectangle=s["a"].clone(t.translucency.rectangle,this._rectangle),x(this,e)};var $=new Array(g),ee=new Array(g);function te(e,t,a,r,o,s,d){var u=t.derivedCommands.globeTranslucency,l=e._derivedCommandsDirty;if(t.dirty||!Object(n["a"])(u)||l){t.dirty=!1,Object(n["a"])(u)||(u={},t.derivedCommands.globeTranslucency=u);var h=d.frameNumber,p=Object(i["a"])(u.uniformMapDirtyFrame,0),m=Object(i["a"])(u.shaderProgramDirtyFrame,0),f=Object(i["a"])(u.renderStateDirtyFrame,0),g=u.uniformMap!==t.uniformMap,_=u.shaderProgramId!==t.shaderProgram.id,y=u.renderStateId!==t.renderState.id;g&&(u.uniformMapDirtyFrame=h),_&&(u.shaderProgramDirtyFrame=h),y&&(u.renderStateDirtyFrame=h),u.uniformMap=t.uniformMap,u.shaderProgramId=t.shaderProgram.id,u.renderStateId=t.renderState.id;for(var v=0;v<a;++v){var T,b,A,C=s[v],S=r[v],O=o[v],x=u[O];Object(n["a"])(x)?(T=x.uniformMap,b=x.shaderProgram,A=x.renderState):(T=void 0,b=void 0,A=void 0),x=c["a"].shallowClone(t,x),u[O]=x;var E=Object(i["a"])(x.derivedCommands.uniformMapDirtyFrame,0),D=Object(i["a"])(x.derivedCommands.shaderProgramDirtyFrame,0),F=Object(i["a"])(x.derivedCommands.renderStateDirtyFrame,0),w=g||E<p,L=_||D<m,P=y||F<f;w&&(x.derivedCommands.uniformMapDirtyFrame=h),L&&(x.derivedCommands.shaderProgramDirtyFrame=h),P&&(x.derivedCommands.renderStateDirtyFrame=h),x.derivedCommands.type=S,x.pass=C.pass,x.pickOnly=C.pickOnly,x.uniformMap=Q(e,t.uniformMap,T,w,C.getUniformMapFunction),x.shaderProgram=j(d.context,t.shaderProgram,b,L,C.getShaderProgramFunction,O),x.renderState=K(t.renderState,A,P,C.getRenderStateFunction,C.renderStateCache)}}}function ae(e,t,a,r,i,o,s){for(var c=0;c<t;++c){var d=e[c],u=d.derivedCommands.type;(!Object(n["a"])(s)||s.indexOf(u)>-1)&&a(d,r,i,o)}}function re(e,t,a,r,i,n){for(var o=0;o<t;++o)a(e[o],r,i,n)}y.prototype.updateDerivedCommands=function(e,t){var a=this._derivedCommandTypesToUpdate,r=this._derivedCommandsToUpdateLength;if(0!==r){for(var i=0;i<r;++i)ee[i]=this._derivedCommandPacks[a[i]],$[i]=_[a[i]];te(this,e,r,a,$,ee,t)}},y.prototype.pushDerivedCommands=function(e,t,a){var r=a.passes.pick;if(!r||!t){var i=this._derivedCommandTypes,n=this._derivedCommandsLength;if(r?(i=this._derivedPickCommandTypes,n=this._derivedPickCommandsLength):t&&(i=this._derivedBlendCommandTypes,n=this._derivedBlendCommandsLength),0!==n)for(var o=e.derivedCommands.globeTranslucency,s=0;s<n;++s){var c=_[i[s]];a.commandList.push(o[c])}else a.commandList.push(e)}};var ie=[f.OPAQUE_FRONT_FACE,f.OPAQUE_BACK_FACE],ne=[f.DEPTH_ONLY_FRONT_FACE,f.DEPTH_ONLY_BACK_FACE,f.DEPTH_ONLY_FRONT_AND_BACK_FACE];y.prototype.executeGlobeCommands=function(e,t,a,r,i){var n=r.context,o=e.commands[d["a"].GLOBE],s=e.indices[d["a"].GLOBE];0!==s&&(this._globeTranslucencyFramebuffer=a,a.clearClassification(n,i),ae(o,s,t,r,n,i,ie))},y.prototype.executeGlobeClassificationCommands=function(e,t,a,r,i){var n=r.context,o=e.commands[d["a"].GLOBE],s=e.indices[d["a"].GLOBE],c=e.commands[d["a"].TERRAIN_CLASSIFICATION],u=e.indices[d["a"].TERRAIN_CLASSIFICATION];if(0!==s&&0!==u){var l=this._frontFaceTranslucent,h=this._backFaceTranslucent;if(l&&h||re(c,u,t,r,n,i),l||h){this._globeTranslucencyFramebuffer=a;var p=n.uniformState.globeDepthTexture,m=i.framebuffer;if(i.framebuffer=a.classificationFramebuffer,ae(o,s,t,r,n,i,ne),n.depthTexture){var f=a.packDepth(n,i);n.uniformState.globeDepthTexture=f}re(c,u,t,r,n,i),n.uniformState.globeDepthTexture=p,i.framebuffer=m}}},t["a"]=y},8004:function(e,t,a){"use strict";var r=a("77af"),i=a("bd8d"),n=a("2f63"),o=a("7d62"),s=a("e42d"),c=a("f845"),d=a("ac3b"),u=a("6ef5"),l=a("8a65"),h=a("3550"),p=a("6dc0"),m=a("6c84"),f=a("a913"),g=a("987b");function _(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._framebuffer=void 0,this._packedDepthTexture=void 0,this._packedDepthFramebuffer=void 0,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new r["a"],this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}function y(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&!e._depthStencilRenderbuffer.isDestroyed()&&e._depthStencilRenderbuffer.destroy(),e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy(),e._packedDepthTexture=e._packedDepthTexture&&!e._packedDepthTexture.isDestroyed()&&e._packedDepthTexture.destroy(),e._packedDepthFramebuffer=e._packedDepthFramebuffer&&!e._packedDepthFramebuffer.isDestroyed()&&e._packedDepthFramebuffer.destroy()}function v(e,t,a,r,i){var n=i?t.halfFloatingPointTexture?u["a"].HALF_FLOAT:u["a"].FLOAT:u["a"].UNSIGNED_BYTE;e._colorTexture=new f["a"]({context:t,width:a,height:r,pixelFormat:s["a"].RGBA,pixelDatatype:n,sampler:m["a"].NEAREST}),t.depthTexture?e._depthStencilTexture=new f["a"]({context:t,width:a,height:r,pixelFormat:s["a"].DEPTH_STENCIL,pixelDatatype:u["a"].UNSIGNED_INT_24_8}):e._depthStencilRenderbuffer=new l["a"]({context:t,width:a,height:r,format:h["a"].DEPTH_STENCIL}),e._framebuffer=new d["a"]({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,depthStencilRenderbuffer:e._depthStencilRenderbuffer,destroyAttachments:!1}),e._packedDepthTexture=new f["a"]({context:t,width:a,height:r,pixelFormat:s["a"].RGBA,pixelDatatype:u["a"].UNSIGNED_BYTE,sampler:m["a"].NEAREST}),e._packedDepthFramebuffer=new d["a"]({context:t,colorTextures:[e._packedDepthTexture],destroyAttachments:!1})}function T(e,t,a,r,i){var o=e._colorTexture,s=!Object(n["a"])(o)||o.width!==a||o.height!==r||i!==e._useHdr;s&&(y(e),v(e,t,a,r,i))}function b(e,t,a,o,s){e._viewport.width=a,e._viewport.height=o;var d=!r["a"].equals(e._viewport,s.viewport),u=d!==e._useScissorTest;e._useScissorTest=d,r["a"].equals(e._scissorRectangle,s.viewport)||(e._scissorRectangle=r["a"].clone(s.viewport,e._scissorRectangle),u=!0),Object(n["a"])(e._renderState)&&r["a"].equals(e._viewport,e._renderState.viewport)&&!u||(e._renderState=p["a"].fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),Object(n["a"])(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(g["a"],{uniformMap:{u_depthTexture:function(){return e._depthStencilTexture}},owner:e})),Object(n["a"])(e._clearCommand)||(e._clearCommand=new c["a"]({color:new i["a"](0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e._framebuffer,e._clearCommand.renderState=e._renderState}Object.defineProperties(_.prototype,{classificationTexture:{get:function(){return this._colorTexture}},classificationFramebuffer:{get:function(){return this._framebuffer}}}),_.prototype.updateAndClear=function(e,t,a,r){var i=t.width,n=t.height;T(this,a,i,n,e),b(this,a,i,n,r),this._useHdr=e},_.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},_.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this._packedDepthTexture},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return y(this),Object(o["a"])(this)},t["a"]=_}}]);