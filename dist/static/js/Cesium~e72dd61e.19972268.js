(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~e72dd61e"],{"9dbf":function(t,a,i){"use strict";var o=i("cef5"),e=i("670c"),n=i("be18"),r=i("a561"),s=i("bef8"),c=i("535a"),u=i("2f63"),h=i("55f9"),l=i("c52f"),m=i("1e13"),d=i("21d7"),p=i("ddf7"),f=i("4f77"),_=i("8dd9"),g=i("66bf"),v=i("5410"),C=i("93da"),T=i("df07"),y=i("52f0"),E=i("713f"),O=i("4e1a"),w=i("0260"),W=i("2ac3"),b=i("eace"),I=i("f806"),P=i("b137"),j=i("482f"),x=i("a307");function M(t){this._scene=t,this._transform=y["a"].clone(y["a"].IDENTITY),this._invTransform=y["a"].clone(y["a"].IDENTITY),this._actualTransform=y["a"].clone(y["a"].IDENTITY),this._actualInvTransform=y["a"].clone(y["a"].IDENTITY),this._transformChanged=!1,this.position=new n["a"],this._position=new n["a"],this._positionWC=new n["a"],this._positionCartographic=new s["a"],this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new n["a"],this._direction=new n["a"],this._directionWC=new n["a"],this.up=new n["a"],this._up=new n["a"],this._upWC=new n["a"],this.right=new n["a"],this._right=new n["a"],this._rightWC=new n["a"],this.frustum=new O["a"],this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=C["a"].toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new d["a"],this._moveEnd=new d["a"],this._changed=new d["a"],this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new y["a"],this._invViewMatrix=new y["a"],N(this),this._mode=x["a"].SCENE3D,this._modeChanged=!0;var a=t.mapProjection;this._projection=a,this._maxCoord=a.project(new s["a"](Math.PI,C["a"].PI_OVER_TWO)),this._max2Dfrustum=void 0,ta(this,M.DEFAULT_VIEW_RECTANGLE,this.position,!0);var i=n["a"].magnitude(this.position);i+=i*M.DEFAULT_VIEW_FACTOR,n["a"].normalize(this.position,this.position),n["a"].multiplyByScalar(this.position,i,this.position)}function N(t){y["a"].computeView(t._position,t._direction,t._up,t._right,t._viewMatrix),y["a"].multiply(t._viewMatrix,t._actualInvTransform,t._viewMatrix),y["a"].inverseTransformation(t._viewMatrix,t._invViewMatrix)}function S(t){if(Object(u["a"])(t._oldPositionWC)){t.positionWCDeltaMagnitudeLastFrame=t.positionWCDeltaMagnitude;var a=n["a"].subtract(t.positionWC,t._oldPositionWC,t._oldPositionWC);t.positionWCDeltaMagnitude=n["a"].magnitude(a),t._oldPositionWC=n["a"].clone(t.positionWC,t._oldPositionWC),t.positionWCDeltaMagnitude>0?(t.timeSinceMoved=0,t._lastMovedTimestamp=Object(p["a"])()):t.timeSinceMoved=Math.max(Object(p["a"])()-t._lastMovedTimestamp,0)/1e3}else t._oldPositionWC=n["a"].clone(t.positionWC,t._oldPositionWC)}function R(t){I["a"].basisTo2D(t._projection,t._transform,t._actualTransform)}M.TRANSFORM_2D=new y["a"](0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),M.TRANSFORM_2D_INVERSE=y["a"].inverseTransformation(M.TRANSFORM_2D,new y["a"]),M.DEFAULT_VIEW_RECTANGLE=b["a"].fromDegrees(-95,-20,-70,90),M.DEFAULT_VIEW_FACTOR=.5,M.DEFAULT_OFFSET=new f["a"](0,-C["a"].PI_OVER_FOUR,0),M.prototype.canPreloadFlight=function(){return Object(u["a"])(this._currentFlight)&&this._mode!==x["a"].SCENE2D},M.prototype._updateCameraChanged=function(){var t=this;if(S(t),0!==t._changed.numberOfListeners){var a=t.percentageChanged;if(t._mode!==x["a"].SCENE2D){if(!Object(u["a"])(t._changedDirection))return t._changedPosition=n["a"].clone(t.positionWC,t._changedPosition),void(t._changedDirection=n["a"].clone(t.directionWC,t._changedDirection));var i,o=C["a"].acosClamped(n["a"].dot(t.directionWC,t._changedDirection));i=Object(u["a"])(t.frustum.fovy)?o/(.5*t.frustum.fovy):o;var e=n["a"].distance(t.positionWC,t._changedPosition),r=e/t.positionCartographic.height;(i>a||r>a)&&(t._changed.raiseEvent(Math.max(i,r)),t._changedPosition=n["a"].clone(t.positionWC,t._changedPosition),t._changedDirection=n["a"].clone(t.directionWC,t._changedDirection))}else{if(!Object(u["a"])(t._changedFrustum))return t._changedPosition=n["a"].clone(t.position,t._changedPosition),void(t._changedFrustum=t.frustum.clone());var s,c=t.position,h=t._changedPosition,l=t.frustum,m=t._changedFrustum,d=c.x+l.left,p=c.x+l.right,f=h.x+m.left,_=h.x+m.right,g=c.y+l.bottom,v=c.y+l.top,T=h.y+m.bottom,y=h.y+m.top,E=Math.max(d,f),O=Math.min(p,_),w=Math.max(g,T),W=Math.min(v,y);if(E>=O||w>=v)s=1;else{var b=m;d<f&&p>_&&g<T&&v>y&&(b=l),s=1-(O-E)*(W-w)/((b.right-b.left)*(b.top-b.bottom))}s>a&&(t._changed.raiseEvent(s),t._changedPosition=n["a"].clone(t.position,t._changedPosition),t._changedFrustum=t.frustum.clone(t._changedFrustum))}}};var A=new s["a"],D=new n["a"],F=new n["a"],V=new r["a"],B=new r["a"],z=new r["a"],L=new r["a"],U=new r["a"];function k(t){var a=t._projection,i=a.ellipsoid,o=y["a"].getColumn(t._transform,3,V),e=i.cartesianToCartographic(o,A),s=a.project(e,D),c=B;c.x=s.z,c.y=s.x,c.z=s.y,c.w=1;var u=r["a"].clone(r["a"].UNIT_X,U),h=r["a"].add(y["a"].getColumn(t._transform,0,F),o,F);i.cartesianToCartographic(h,e),a.project(e,s);var l=z;l.x=s.z,l.y=s.x,l.z=s.y,l.w=0,n["a"].subtract(l,c,l),l.x=0;var m=L;if(n["a"].magnitudeSquared(l)>C["a"].EPSILON10)n["a"].cross(u,l,m);else{var d=r["a"].add(y["a"].getColumn(t._transform,1,F),o,F);i.cartesianToCartographic(d,e),a.project(e,s),m.x=s.z,m.y=s.x,m.z=s.y,m.w=0,n["a"].subtract(m,c,m),m.x=0,n["a"].magnitudeSquared(m)<C["a"].EPSILON10&&(r["a"].clone(r["a"].UNIT_Y,l),r["a"].clone(r["a"].UNIT_Z,m))}n["a"].cross(m,u,l),n["a"].normalize(l,l),n["a"].cross(u,l,m),n["a"].normalize(m,m),y["a"].setColumn(t._actualTransform,0,l,t._actualTransform),y["a"].setColumn(t._actualTransform,1,m,t._actualTransform),y["a"].setColumn(t._actualTransform,2,u,t._actualTransform),y["a"].setColumn(t._actualTransform,3,c,t._actualTransform)}var H=new n["a"];function Y(t){var a=t._mode,i=!1,o=0;a===x["a"].SCENE2D&&(o=t.frustum.right-t.frustum.left,i=o!==t._positionCartographic.height);var e=t._position,r=!n["a"].equals(e,t.position)||i;r&&(e=n["a"].clone(t.position,t._position));var s=t._direction,c=!n["a"].equals(s,t.direction);c&&(n["a"].normalize(t.direction,t.direction),s=n["a"].clone(t.direction,t._direction));var u=t._up,h=!n["a"].equals(u,t.up);h&&(n["a"].normalize(t.up,t.up),u=n["a"].clone(t.up,t._up));var l=t._right,m=!n["a"].equals(l,t.right);m&&(n["a"].normalize(t.right,t.right),l=n["a"].clone(t.right,t._right));var d=t._transformChanged||t._modeChanged;t._transformChanged=!1,d&&(y["a"].inverseTransformation(t._transform,t._invTransform),t._mode===x["a"].COLUMBUS_VIEW||t._mode===x["a"].SCENE2D?y["a"].equals(y["a"].IDENTITY,t._transform)?y["a"].clone(M.TRANSFORM_2D,t._actualTransform):t._mode===x["a"].COLUMBUS_VIEW?R(t):k(t):y["a"].clone(t._transform,t._actualTransform),y["a"].inverseTransformation(t._actualTransform,t._actualInvTransform),t._modeChanged=!1);var p=t._actualTransform;if(r||d)if(t._positionWC=y["a"].multiplyByPoint(p,e,t._positionWC),a===x["a"].SCENE3D||a===x["a"].MORPHING)t._positionCartographic=t._projection.ellipsoid.cartesianToCartographic(t._positionWC,t._positionCartographic);else{var f=H;f.x=t._positionWC.y,f.y=t._positionWC.z,f.z=t._positionWC.x,a===x["a"].SCENE2D&&(f.z=o),t._projection.unproject(f,t._positionCartographic)}if(c||h||m){var _=n["a"].dot(s,n["a"].cross(u,l,H));if(Math.abs(1-_)>C["a"].EPSILON2){var g=1/n["a"].magnitudeSquared(u),v=n["a"].dot(u,s)*g,T=n["a"].multiplyByScalar(s,v,H);u=n["a"].normalize(n["a"].subtract(u,T,t._up),t._up),n["a"].clone(u,t.up),l=n["a"].cross(s,u,t._right),n["a"].clone(l,t.right)}}(c||d)&&(t._directionWC=y["a"].multiplyByPointAsVector(p,s,t._directionWC),n["a"].normalize(t._directionWC,t._directionWC)),(h||d)&&(t._upWC=y["a"].multiplyByPointAsVector(p,u,t._upWC),n["a"].normalize(t._upWC,t._upWC)),(m||d)&&(t._rightWC=y["a"].multiplyByPointAsVector(p,l,t._rightWC),n["a"].normalize(t._rightWC,t._rightWC)),(r||c||h||m||d)&&N(t)}function q(t,a){var i;return i=C["a"].equalsEpsilon(Math.abs(t.z),1,C["a"].EPSILON3)?Math.atan2(a.y,a.x)-C["a"].PI_OVER_TWO:Math.atan2(t.y,t.x)-C["a"].PI_OVER_TWO,C["a"].TWO_PI-C["a"].zeroToTwoPi(i)}function Z(t){return C["a"].PI_OVER_TWO-C["a"].acosClamped(t.z)}function G(t,a,i){var o=0;return C["a"].equalsEpsilon(Math.abs(t.z),1,C["a"].EPSILON3)||(o=Math.atan2(-i.z,a.z),o=C["a"].zeroToTwoPi(o+C["a"].TWO_PI)),o}var X=new y["a"],J=new y["a"];Object.defineProperties(M.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return Y(this),this._invTransform}},viewMatrix:{get:function(){return Y(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return Y(this),this._invViewMatrix}},positionCartographic:{get:function(){return Y(this),this._positionCartographic}},positionWC:{get:function(){return Y(this),this._positionWC}},directionWC:{get:function(){return Y(this),this._directionWC}},upWC:{get:function(){return Y(this),this._upWC}},rightWC:{get:function(){return Y(this),this._rightWC}},heading:{get:function(){if(this._mode!==x["a"].MORPHING){var t=this._projection.ellipsoid,a=y["a"].clone(this._transform,X),i=I["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);var o=q(this.direction,this.up);return this._setTransform(a),o}}},pitch:{get:function(){if(this._mode!==x["a"].MORPHING){var t=this._projection.ellipsoid,a=y["a"].clone(this._transform,X),i=I["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);var o=Z(this.direction);return this._setTransform(a),o}}},roll:{get:function(){if(this._mode!==x["a"].MORPHING){var t=this._projection.ellipsoid,a=y["a"].clone(this._transform,X),i=I["a"].eastNorthUpToFixedFrame(this.positionWC,t,J);this._setTransform(i);var o=G(this.direction,this.up,this.right);return this._setTransform(a),o}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),M.prototype.update=function(t){var a=!1;if(t!==this._mode&&(this._mode=t,this._modeChanged=t!==x["a"].MORPHING,a=this._mode===x["a"].SCENE2D),a){var i=this._max2Dfrustum=this.frustum.clone(),o=2,e=i.top/i.right;i.right=this._maxCoord.x*o,i.left=-i.right,i.top=e*i.right,i.bottom=-i.top}this._mode===x["a"].SCENE2D&&yt(this,this.position)};var Q=new n["a"],K=new n["a"],$=new n["a"];M.prototype._setTransform=function(t){var a=n["a"].clone(this.positionWC,Q),i=n["a"].clone(this.upWC,K),o=n["a"].clone(this.directionWC,$);y["a"].clone(t,this._transform),this._transformChanged=!0,Y(this);var e=this._actualInvTransform;y["a"].multiplyByPoint(e,a,this.position),y["a"].multiplyByPointAsVector(e,o,this.direction),y["a"].multiplyByPointAsVector(e,i,this.up),n["a"].cross(this.direction,this.up,this.right),Y(this)};var tt=new e["a"],at=new W["a"],it=new n["a"],ot=new n["a"];function et(t){if(!y["a"].equals(y["a"].IDENTITY,t.transform))return n["a"].magnitude(t.position);var a,i,o,e=t._scene,r=e.globe,s=tt;if(s.x=e.drawingBufferWidth/2,s.y=e.drawingBufferHeight/2,Object(u["a"])(r)){var c=t.getPickRay(s,at);a=r.pickWorldCoordinates(c,e,!0,it)}if(e.pickPositionSupported&&(i=e.pickPositionWorldCoordinates(s,ot)),Object(u["a"])(a)||Object(u["a"])(i)){var h=Object(u["a"])(i)?n["a"].distance(i,t.positionWC):Number.POSITIVE_INFINITY,l=Object(u["a"])(a)?n["a"].distance(a,t.positionWC):Number.POSITIVE_INFINITY;o=Math.min(h,l)}else o=Math.max(t.positionCartographic.height,0);return o}M.prototype._adjustOrthographicFrustum=function(t){this.frustum instanceof E["a"]&&(!t&&this._positionCartographic.height<15e4||(this.frustum.width=et(this)))};var nt=new n["a"],rt=new y["a"],st=new y["a"],ct=new w["a"],ut=new T["a"],ht=new s["a"];function lt(t,a,i){var o=y["a"].clone(t.transform,rt),e=I["a"].eastNorthUpToFixedFrame(a,t._projection.ellipsoid,st);t._setTransform(e),n["a"].clone(n["a"].ZERO,t.position),i.heading=i.heading-C["a"].PI_OVER_TWO;var r=w["a"].fromHeadingPitchRoll(i,ct),s=T["a"].fromQuaternion(r,ut);T["a"].getColumn(s,0,t.direction),T["a"].getColumn(s,2,t.up),n["a"].cross(t.direction,t.up,t.right),t._setTransform(o),t._adjustOrthographicFrustum(!0)}function mt(t,a,i,o){var e=y["a"].clone(t.transform,rt);if(t._setTransform(y["a"].IDENTITY),!n["a"].equals(a,t.positionWC)){if(o){var r=t._projection,s=r.ellipsoid.cartesianToCartographic(a,ht);a=r.project(s,nt)}n["a"].clone(a,t.position)}i.heading=i.heading-C["a"].PI_OVER_TWO;var c=w["a"].fromHeadingPitchRoll(i,ct),u=T["a"].fromQuaternion(c,ut);T["a"].getColumn(u,0,t.direction),T["a"].getColumn(u,2,t.up),n["a"].cross(t.direction,t.up,t.right),t._setTransform(e),t._adjustOrthographicFrustum(!0)}function dt(t,a,i,o){var r=y["a"].clone(t.transform,rt);if(t._setTransform(y["a"].IDENTITY),!n["a"].equals(a,t.positionWC)){if(o){var s=t._projection,c=s.ellipsoid.cartesianToCartographic(a,ht);a=s.project(c,nt)}e["a"].clone(a,t.position);var u=.5*-a.z,h=-u,l=t.frustum;if(h>u){var m=l.top/l.right;l.right=h,l.left=u,l.top=l.right*m,l.bottom=-l.top}}if(t._scene.mapMode2D===j["a"].ROTATE){i.heading=i.heading-C["a"].PI_OVER_TWO,i.pitch=-C["a"].PI_OVER_TWO,i.roll=0;var d=w["a"].fromHeadingPitchRoll(i,ct),p=T["a"].fromQuaternion(d,ut);T["a"].getColumn(p,2,t.up),n["a"].cross(t.direction,t.up,t.right)}t._setTransform(r)}var pt=new n["a"],ft=new n["a"],_t=new n["a"];function gt(t,a,i,o){var e=n["a"].clone(i.direction,pt),r=n["a"].clone(i.up,ft);if(t._scene.mode===x["a"].SCENE3D){var s=t._projection.ellipsoid,c=I["a"].eastNorthUpToFixedFrame(a,s,X),u=y["a"].inverseTransformation(c,J);y["a"].multiplyByPointAsVector(u,e,e),y["a"].multiplyByPointAsVector(u,r,r)}var h=n["a"].cross(e,r,_t);return o.heading=q(e,r),o.pitch=Z(e),o.roll=G(e,r,h),o}var vt={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},Ct=new _["a"];M.prototype.setView=function(t){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);var a=Object(c["a"])(t.orientation,c["a"].EMPTY_OBJECT),i=this._mode;if(i!==x["a"].MORPHING){Object(u["a"])(t.endTransform)&&this._setTransform(t.endTransform);var o=Object(c["a"])(t.convert,!0),e=Object(c["a"])(t.destination,n["a"].clone(this.positionWC,nt));Object(u["a"])(e)&&Object(u["a"])(e.west)&&(e=this.getRectangleCameraCoordinates(e,nt),o=!1),Object(u["a"])(a.direction)&&(a=gt(this,e,a,vt.orientation)),Ct.heading=Object(c["a"])(a.heading,0),Ct.pitch=Object(c["a"])(a.pitch,-C["a"].PI_OVER_TWO),Ct.roll=Object(c["a"])(a.roll,0),i===x["a"].SCENE3D?lt(this,e,Ct):i===x["a"].SCENE2D?dt(this,e,Ct,o):mt(this,e,Ct,o)}};var Tt=new n["a"];function yt(t,a){var i,o,e=t._scene.mapMode2D===j["a"].ROTATE,n=t._maxCoord.x,r=t._maxCoord.y;e?(o=n,i=-o):(o=a.x-2*n,i=a.x+2*n),a.x>n&&(a.x=o),a.x<-n&&(a.x=i),a.y>r&&(a.y=r),a.y<-r&&(a.y=-r)}M.prototype.flyHome=function(t){var a=this._mode;if(a===x["a"].MORPHING&&this._scene.completeMorph(),a===x["a"].SCENE2D)this.flyTo({destination:M.DEFAULT_VIEW_RECTANGLE,duration:t,endTransform:y["a"].IDENTITY});else if(a===x["a"].SCENE3D){var i=this.getRectangleCameraCoordinates(M.DEFAULT_VIEW_RECTANGLE),o=n["a"].magnitude(i);o+=o*M.DEFAULT_VIEW_FACTOR,n["a"].normalize(i,i),n["a"].multiplyByScalar(i,o,i),this.flyTo({destination:i,duration:t,endTransform:y["a"].IDENTITY})}else if(a===x["a"].COLUMBUS_VIEW){var e=this._projection.ellipsoid.maximumRadius,r=new n["a"](0,-1,1);r=n["a"].multiplyByScalar(n["a"].normalize(r,r),5*e,r),this.flyTo({destination:r,duration:t,orientation:{heading:0,pitch:-Math.acos(n["a"].normalize(r,Tt).z),roll:0},endTransform:y["a"].IDENTITY,convert:!1})}},M.prototype.worldToCameraCoordinates=function(t,a){return Object(u["a"])(a)||(a=new r["a"]),Y(this),y["a"].multiplyByVector(this._actualInvTransform,t,a)},M.prototype.worldToCameraCoordinatesPoint=function(t,a){return Object(u["a"])(a)||(a=new n["a"]),Y(this),y["a"].multiplyByPoint(this._actualInvTransform,t,a)},M.prototype.worldToCameraCoordinatesVector=function(t,a){return Object(u["a"])(a)||(a=new n["a"]),Y(this),y["a"].multiplyByPointAsVector(this._actualInvTransform,t,a)},M.prototype.cameraToWorldCoordinates=function(t,a){return Object(u["a"])(a)||(a=new r["a"]),Y(this),y["a"].multiplyByVector(this._actualTransform,t,a)},M.prototype.cameraToWorldCoordinatesPoint=function(t,a){return Object(u["a"])(a)||(a=new n["a"]),Y(this),y["a"].multiplyByPoint(this._actualTransform,t,a)},M.prototype.cameraToWorldCoordinatesVector=function(t,a){return Object(u["a"])(a)||(a=new n["a"]),Y(this),y["a"].multiplyByPointAsVector(this._actualTransform,t,a)};var Et=new n["a"];M.prototype.move=function(t,a){var i=this.position;n["a"].multiplyByScalar(t,a,Et),n["a"].add(i,Et,i),this._mode===x["a"].SCENE2D&&yt(this,i),this._adjustOrthographicFrustum(!0)},M.prototype.moveForward=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this._mode===x["a"].SCENE2D?St(this,t):this.move(this.direction,t)},M.prototype.moveBackward=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this._mode===x["a"].SCENE2D?St(this,-t):this.move(this.direction,-t)},M.prototype.moveUp=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.up,t)},M.prototype.moveDown=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.up,-t)},M.prototype.moveRight=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.right,t)},M.prototype.moveLeft=function(t){t=Object(c["a"])(t,this.defaultMoveAmount),this.move(this.right,-t)},M.prototype.lookLeft=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.up,-t)},M.prototype.lookRight=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.up,t)},M.prototype.lookUp=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.right,-t)},M.prototype.lookDown=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this._mode!==x["a"].SCENE2D&&this.look(this.right,t)};var Ot=new w["a"],wt=new T["a"];M.prototype.look=function(t,a){var i=Object(c["a"])(a,this.defaultLookAmount),o=w["a"].fromAxisAngle(t,-i,Ot),e=T["a"].fromQuaternion(o,wt),n=this.direction,r=this.up,s=this.right;T["a"].multiplyByVector(e,n,n),T["a"].multiplyByVector(e,r,r),T["a"].multiplyByVector(e,s,s)},M.prototype.twistLeft=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this.look(this.direction,t)},M.prototype.twistRight=function(t){t=Object(c["a"])(t,this.defaultLookAmount),this.look(this.direction,-t)};var Wt=new w["a"],bt=new T["a"];M.prototype.rotate=function(t,a){var i=Object(c["a"])(a,this.defaultRotateAmount),o=w["a"].fromAxisAngle(t,-i,Wt),e=T["a"].fromQuaternion(o,bt);T["a"].multiplyByVector(e,this.position,this.position),T["a"].multiplyByVector(e,this.direction,this.direction),T["a"].multiplyByVector(e,this.up,this.up),n["a"].cross(this.direction,this.up,this.right),n["a"].cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},M.prototype.rotateDown=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Mt(this,t)},M.prototype.rotateUp=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Mt(this,-t)};var It=new n["a"],Pt=new n["a"],jt=new n["a"],xt=new n["a"];function Mt(t,a){var i=t.position;if(Object(u["a"])(t.constrainedAxis)&&!n["a"].equalsEpsilon(t.position,n["a"].ZERO,C["a"].EPSILON2)){var o=n["a"].normalize(i,It),e=n["a"].equalsEpsilon(o,t.constrainedAxis,C["a"].EPSILON2),r=n["a"].equalsEpsilon(o,n["a"].negate(t.constrainedAxis,xt),C["a"].EPSILON2);if(e||r)(e&&a<0||r&&a>0)&&t.rotate(t.right,a);else{var s=n["a"].normalize(t.constrainedAxis,Pt),c=n["a"].dot(o,s),h=C["a"].acosClamped(c);a>0&&a>h&&(a=h-C["a"].EPSILON4),c=n["a"].dot(o,n["a"].negate(s,xt)),h=C["a"].acosClamped(c),a<0&&-a>h&&(a=-h+C["a"].EPSILON4);var l=n["a"].cross(s,o,jt);t.rotate(l,a)}}else t.rotate(t.right,a)}function Nt(t,a){Object(u["a"])(t.constrainedAxis)?t.rotate(t.constrainedAxis,a):t.rotate(t.up,a)}function St(t,a){var i,o=t.frustum;if(a*=.5,Math.abs(o.top)+Math.abs(o.bottom)>Math.abs(o.left)+Math.abs(o.right)){var e=o.top-a,n=o.bottom+a,r=t._maxCoord.y;t._scene.mapMode2D===j["a"].ROTATE&&(r*=t.maximumZoomFactor),n>r&&(n=r,e=-r),e<=n&&(e=1,n=-1),i=o.right/o.top,o.top=e,o.bottom=n,o.right=o.top*i,o.left=-o.right}else{var s=o.right-a,c=o.left+a,u=t._maxCoord.x;t._scene.mapMode2D===j["a"].ROTATE&&(u*=t.maximumZoomFactor),s>u&&(s=u,c=-u),s<=c&&(s=1,c=-1),i=o.top/o.right,o.right=s,o.left=c,o.top=o.right*i,o.bottom=-o.top}}function Rt(t,a){t.move(t.direction,a)}M.prototype.rotateRight=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Nt(this,-t)},M.prototype.rotateLeft=function(t){t=Object(c["a"])(t,this.defaultRotateAmount),Nt(this,t)},M.prototype.zoomIn=function(t){t=Object(c["a"])(t,this.defaultZoomAmount),this._mode===x["a"].SCENE2D?St(this,t):Rt(this,t)},M.prototype.zoomOut=function(t){t=Object(c["a"])(t,this.defaultZoomAmount),this._mode===x["a"].SCENE2D?St(this,-t):Rt(this,-t)},M.prototype.getMagnitude=function(){return this._mode===x["a"].SCENE3D?n["a"].magnitude(this.position):this._mode===x["a"].COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===x["a"].SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var At=new y["a"];M.prototype.lookAt=function(t,a){var i=I["a"].eastNorthUpToFixedFrame(t,l["a"].WGS84,At);this.lookAtTransform(i,a)};var Dt=new n["a"],Ft=new w["a"],Vt=new w["a"],Bt=new T["a"];function zt(t,a,i){a=C["a"].clamp(a,-C["a"].PI_OVER_TWO,C["a"].PI_OVER_TWO),t=C["a"].zeroToTwoPi(t)-C["a"].PI_OVER_TWO;var o=w["a"].fromAxisAngle(n["a"].UNIT_Y,-a,Ft),e=w["a"].fromAxisAngle(n["a"].UNIT_Z,-t,Vt),r=w["a"].multiply(e,o,e),s=T["a"].fromQuaternion(r,Bt),c=n["a"].clone(n["a"].UNIT_X,Dt);return T["a"].multiplyByVector(s,c,c),n["a"].negate(c,c),n["a"].multiplyByScalar(c,i,c),c}M.prototype.lookAtTransform=function(t,a){if(this._setTransform(t),Object(u["a"])(a)){var i;if(i=Object(u["a"])(a.heading)?zt(a.heading,a.pitch,a.range):a,this._mode===x["a"].SCENE2D){e["a"].clone(e["a"].ZERO,this.position),n["a"].negate(i,this.up),this.up.z=0,n["a"].magnitudeSquared(this.up)<C["a"].EPSILON10&&n["a"].clone(n["a"].UNIT_Y,this.up),n["a"].normalize(this.up,this.up),this._setTransform(y["a"].IDENTITY),n["a"].negate(n["a"].UNIT_Z,this.direction),n["a"].cross(this.direction,this.up,this.right),n["a"].normalize(this.right,this.right);var o=this.frustum,r=o.top/o.right;return o.right=.5*n["a"].magnitude(i),o.left=-o.right,o.top=r*o.right,o.bottom=-o.top,void this._setTransform(t)}n["a"].clone(i,this.position),n["a"].negate(this.position,this.direction),n["a"].normalize(this.direction,this.direction),n["a"].cross(this.direction,n["a"].UNIT_Z,this.right),n["a"].magnitudeSquared(this.right)<C["a"].EPSILON10&&n["a"].clone(n["a"].UNIT_X,this.right),n["a"].normalize(this.right,this.right),n["a"].cross(this.right,this.direction,this.up),n["a"].normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)}};var Lt,Ut=new s["a"],kt=new s["a"],Ht=new n["a"],Yt=new n["a"],qt=new n["a"],Zt=new n["a"],Gt=new n["a"],Xt=new n["a"],Jt=new n["a"],Qt=new n["a"],Kt={direction:new n["a"],right:new n["a"],up:new n["a"]};function $t(t,a,i,o){var e=Math.abs(n["a"].dot(a,i));return e/o-n["a"].dot(t,i)}function ta(t,a,i,o){var e=t._projection.ellipsoid,r=o?t:Kt,s=a.north,c=a.south,h=a.east,l=a.west;l>h&&(h+=C["a"].TWO_PI);var d,p=.5*(l+h);if(c<-C["a"].PI_OVER_TWO+C["a"].RADIANS_PER_DEGREE&&s>C["a"].PI_OVER_TWO-C["a"].RADIANS_PER_DEGREE)d=0;else{var f=Ut;f.longitude=p,f.latitude=s,f.height=0;var _=kt;_.longitude=p,_.latitude=c,_.height=0;var g=Lt;Object(u["a"])(g)&&g.ellipsoid===e||(Lt=g=new m["a"](void 0,void 0,e)),g.setEndPoints(f,_),d=g.interpolateUsingFraction(.5,Ut).latitude}var v=Ut;v.longitude=p,v.latitude=d,v.height=0;var T=e.cartographicToCartesian(v,Jt),y=Ut;y.longitude=h,y.latitude=s;var O=e.cartographicToCartesian(y,Ht);y.longitude=l;var w=e.cartographicToCartesian(y,qt);y.longitude=p;var W=e.cartographicToCartesian(y,Gt);y.latitude=c;var b=e.cartographicToCartesian(y,Xt);y.longitude=h;var I=e.cartographicToCartesian(y,Zt);y.longitude=l;var P=e.cartographicToCartesian(y,Yt);n["a"].subtract(w,T,w),n["a"].subtract(I,T,I),n["a"].subtract(O,T,O),n["a"].subtract(P,T,P),n["a"].subtract(W,T,W),n["a"].subtract(b,T,b);var j=e.geodeticSurfaceNormal(T,r.direction);n["a"].negate(j,j);var x=n["a"].cross(j,n["a"].UNIT_Z,r.right);n["a"].normalize(x,x);var M,N=n["a"].cross(x,j,r.up);if(t.frustum instanceof E["a"]){var S,R,A=Math.max(n["a"].distance(O,w),n["a"].distance(I,P)),D=Math.max(n["a"].distance(O,I),n["a"].distance(w,P)),F=t.frustum._offCenterFrustum.right/t.frustum._offCenterFrustum.top,V=D*F;A>V?(S=A,R=S/F):(R=D,S=V),M=Math.max(S,R)}else{var B=Math.tan(.5*t.frustum.fovy),z=t.frustum.aspectRatio*B;if(M=Math.max($t(j,N,w,B),$t(j,N,I,B),$t(j,N,O,B),$t(j,N,P,B),$t(j,N,W,B),$t(j,N,b,B),$t(j,x,w,z),$t(j,x,I,z),$t(j,x,O,z),$t(j,x,P,z),$t(j,x,W,z),$t(j,x,b,z)),c<0&&s>0){var L=Ut;L.longitude=l,L.latitude=0,L.height=0;var U=e.cartographicToCartesian(L,Qt);n["a"].subtract(U,T,U),M=Math.max(M,$t(j,N,U,B),$t(j,x,U,z)),L.longitude=h,U=e.cartographicToCartesian(L,Qt),n["a"].subtract(U,T,U),M=Math.max(M,$t(j,N,U,B),$t(j,x,U,z))}}return n["a"].add(T,n["a"].multiplyByScalar(j,-M,Qt),i)}var aa=new s["a"],ia=new n["a"],oa=new n["a"];function ea(t,a,i){var o=t._projection;a.west>a.east&&(a=b["a"].MAX_VALUE);var e=t._actualTransform,n=t._actualInvTransform,r=aa;r.longitude=a.east,r.latitude=a.north;var s=o.project(r,ia);y["a"].multiplyByPoint(e,s,s),y["a"].multiplyByPoint(n,s,s),r.longitude=a.west,r.latitude=a.south;var c=o.project(r,oa);if(y["a"].multiplyByPoint(e,c,c),y["a"].multiplyByPoint(n,c,c),i.x=.5*(s.x-c.x)+c.x,i.y=.5*(s.y-c.y)+c.y,Object(u["a"])(t.frustum.fovy)){var h=Math.tan(.5*t.frustum.fovy),l=t.frustum.aspectRatio*h;i.z=.5*Math.max((s.x-c.x)/l,(s.y-c.y)/h)}else{var m=s.x-c.x,d=s.y-c.y;i.z=Math.max(m,d)}return i}var na=new s["a"],ra=new n["a"],sa=new n["a"];function ca(t,a,i){var o=t._projection,e=a.east;a.west>a.east&&(t._scene.mapMode2D===j["a"].INFINITE_SCROLL?e+=C["a"].TWO_PI:(a=b["a"].MAX_VALUE,e=a.east));var n=na;n.longitude=e,n.latitude=a.north;var r=o.project(n,ra);n.longitude=a.west,n.latitude=a.south;var s,c,u=o.project(n,sa),h=.5*Math.abs(r.x-u.x),l=.5*Math.abs(r.y-u.y),m=t.frustum.right/t.frustum.top,d=l*m;return h>d?(s=h,c=s/m):(c=l,s=d),l=Math.max(2*s,2*c),i.x=.5*(r.x-u.x)+u.x,i.y=.5*(r.y-u.y)+u.y,n=o.unproject(i,n),n.height=l,i=o.project(n,i),i}M.prototype.getRectangleCameraCoordinates=function(t,a){var i=this._mode;return Object(u["a"])(a)||(a=new n["a"]),i===x["a"].SCENE3D?ta(this,t,a):i===x["a"].COLUMBUS_VIEW?ea(this,t,a):i===x["a"].SCENE2D?ca(this,t,a):void 0};var ua=new W["a"];function ha(t,a,i,o){i=Object(c["a"])(i,l["a"].WGS84);var e=t.getPickRay(a,ua),n=v["a"].rayEllipsoid(e,i);if(n){var r=n.start>0?n.start:n.stop;return W["a"].getPoint(e,r,o)}}var la=new W["a"];function ma(t,a,i,o){var e=t.getPickRay(a,la),r=e.origin;r=n["a"].fromElements(r.y,r.z,0,r);var s=i.unproject(r);if(!(s.latitude<-C["a"].PI_OVER_TWO||s.latitude>C["a"].PI_OVER_TWO))return i.ellipsoid.cartographicToCartesian(s,o)}var da=new W["a"];function pa(t,a,i,o){var e=t.getPickRay(a,da),r=-e.origin.x/e.direction.x;W["a"].getPoint(e,r,o);var s=i.unproject(new n["a"](o.y,o.z,0));if(!(s.latitude<-C["a"].PI_OVER_TWO||s.latitude>C["a"].PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(s,o)}M.prototype.pickEllipsoid=function(t,a,i){var o=this._scene.canvas;if(0!==o.clientWidth&&0!==o.clientHeight){if(Object(u["a"])(i)||(i=new n["a"]),a=Object(c["a"])(a,l["a"].WGS84),this._mode===x["a"].SCENE3D)i=ha(this,t,a,i);else if(this._mode===x["a"].SCENE2D)i=ma(this,t,this._projection,i);else{if(this._mode!==x["a"].COLUMBUS_VIEW)return;i=pa(this,t,this._projection,i)}return i}};var fa=new n["a"],_a=new n["a"],ga=new n["a"];function va(t,a,i){var o=t._scene.canvas,e=o.clientWidth,r=o.clientHeight,s=Math.tan(.5*t.frustum.fovy),c=t.frustum.aspectRatio*s,u=t.frustum.near,h=2/e*a.x-1,l=2/r*(r-a.y)-1,m=t.positionWC;n["a"].clone(m,i.origin);var d=n["a"].multiplyByScalar(t.directionWC,u,fa);n["a"].add(m,d,d);var p=n["a"].multiplyByScalar(t.rightWC,h*u*c,_a),f=n["a"].multiplyByScalar(t.upWC,l*u*s,ga),_=n["a"].add(d,p,i.direction);return n["a"].add(_,f,_),n["a"].subtract(_,m,_),n["a"].normalize(_,_),i}var Ca=new n["a"];function Ta(t,a,i){var o=t._scene.canvas,e=o.clientWidth,r=o.clientHeight,s=t.frustum;Object(u["a"])(s._offCenterFrustum)&&(s=s._offCenterFrustum);var c=2/e*a.x-1;c*=.5*(s.right-s.left);var h=2/r*(r-a.y)-1;h*=.5*(s.top-s.bottom);var l=i.origin;return n["a"].clone(t.position,l),n["a"].multiplyByScalar(t.right,c,Ca),n["a"].add(Ca,l,l),n["a"].multiplyByScalar(t.up,h,Ca),n["a"].add(Ca,l,l),n["a"].clone(t.directionWC,i.direction),t._mode!==x["a"].COLUMBUS_VIEW&&t._mode!==x["a"].SCENE2D||n["a"].fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin),i}M.prototype.getPickRay=function(t,a){Object(u["a"])(a)||(a=new W["a"]);var i=this.frustum;return Object(u["a"])(i.aspectRatio)&&Object(u["a"])(i.fov)&&Object(u["a"])(i.near)?va(this,t,a):Ta(this,t,a)};var ya=new n["a"],Ea=new n["a"];M.prototype.distanceToBoundingSphere=function(t){var a=n["a"].subtract(this.positionWC,t.center,ya),i=n["a"].multiplyByScalar(this.directionWC,n["a"].dot(a,this.directionWC),Ea);return Math.max(0,n["a"].magnitude(i)-t.radius)};var Oa=new e["a"];function wa(t,a,i,o,e,r){var s=n["a"].clone(a);function c(i){var o=n["a"].lerp(a,s,i.time,new n["a"]);t.worldToCameraCoordinatesPoint(o,t.position)}return i.y>o?s.y-=i.y-o:i.y<-o&&(s.y+=-o-i.y),i.z>e?s.z-=i.z-e:i.z<-e&&(s.z+=-e-i.z),{easingFunction:h["a"].EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:r,update:c}}M.prototype.getPixelSize=function(t,a,i){var o=this.distanceToBoundingSphere(t),e=this.frustum.getPixelDimensions(a,i,o,this._scene.pixelRatio,Oa);return Math.max(e.x,e.y)};var Wa=new n["a"],ba=new n["a"],Ia=new n["a"],Pa=new n["a"];function ja(t,a){var i=t.position,o=t.direction,e=t.worldToCameraCoordinatesVector(n["a"].UNIT_X,Wa),r=-n["a"].dot(e,i)/n["a"].dot(e,o),s=n["a"].add(i,n["a"].multiplyByScalar(o,r,ba),ba);t.cameraToWorldCoordinatesPoint(s,s),i=t.cameraToWorldCoordinatesPoint(t.position,Ia);var c=Math.tan(.5*t.frustum.fovy),u=t.frustum.aspectRatio*c,h=n["a"].magnitude(n["a"].subtract(i,s,Pa)),l=u*h,m=c*h,d=t._maxCoord.x,p=t._maxCoord.y,f=Math.max(l-d,d),_=Math.max(m-p,p);if(i.z<-f||i.z>f||i.y<-_||i.y>_){var g=s.y<-f||s.y>f,v=s.z<-_||s.z>_;if(g||v)return wa(t,i,s,f,_,a)}}M.prototype.createCorrectPositionTween=function(t){if(this._mode===x["a"].COLUMBUS_VIEW)return ja(this,t)};var xa=new n["a"],Ma={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};function Na(t,a){var i=t.frustum,o=Math.tan(.5*i.fovy),e=i.aspectRatio*o;return Math.max(a/e,a/o)}function Sa(t,a){var i,o,e=t.frustum;Object(u["a"])(e._offCenterFrustum)&&(e=e._offCenterFrustum);var n=e.right/e.top,r=a*n;return a>r?(i=a,o=i/n):(o=a,i=r),1.5*Math.max(i,o)}M.prototype.cancelFlight=function(){Object(u["a"])(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},M.prototype.completeFlight=function(){if(Object(u["a"])(this._currentFlight)){this._currentFlight.cancelTween();var t={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};t.destination=Ma.destination,t.orientation.heading=Ma.heading,t.orientation.pitch=Ma.pitch,t.orientation.roll=Ma.roll,this.setView(t),Object(u["a"])(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}},M.prototype.flyTo=function(t){t=Object(c["a"])(t,c["a"].EMPTY_OBJECT);var a=t.destination,i=this._mode;if(i!==x["a"].MORPHING){this.cancelFlight();var o=Object(c["a"])(t.orientation,c["a"].EMPTY_OBJECT);if(Object(u["a"])(o.direction)&&(o=gt(this,a,o,vt.orientation)),Object(u["a"])(t.duration)&&t.duration<=0){var e=vt;return e.destination=t.destination,e.orientation.heading=o.heading,e.orientation.pitch=o.pitch,e.orientation.roll=o.roll,e.convert=t.convert,e.endTransform=t.endTransform,this.setView(e),void("function"===typeof t.complete&&t.complete())}var n=Object(u["a"])(a.west);n&&(a=this.getRectangleCameraCoordinates(a,xa));var r,s=this;Ma.destination=a,Ma.heading=o.heading,Ma.pitch=o.pitch,Ma.roll=o.roll,Ma.duration=t.duration,Ma.complete=function(){r===s._currentFlight&&(s._currentFlight=void 0),Object(u["a"])(t.complete)&&t.complete()},Ma.cancel=t.cancel,Ma.endTransform=t.endTransform,Ma.convert=!n&&t.convert,Ma.maximumHeight=t.maximumHeight,Ma.pitchAdjustHeight=t.pitchAdjustHeight,Ma.flyOverLongitude=t.flyOverLongitude,Ma.flyOverLongitudeWeight=t.flyOverLongitudeWeight,Ma.easingFunction=t.easingFunction;var h=this._scene,l=P["a"].createTween(h,Ma);if(0!==l.duration){r=h.tweens.add(l),this._currentFlight=r;var m=this._scene.preloadFlightCamera;this._mode!==x["a"].SCENE2D&&(Object(u["a"])(m)||(m=M.clone(this)),m.setView({destination:a,orientation:o}),this._scene.preloadFlightCullingVolume=m.frustum.computeCullingVolume(m.positionWC,m.directionWC,m.upWC))}else"function"===typeof l.complete&&l.complete()}};var Ra=100;function Aa(t,a,i){i=f["a"].clone(Object(u["a"])(i)?i:M.DEFAULT_OFFSET);var o=t._scene.screenSpaceCameraController.minimumZoomDistance,e=t._scene.screenSpaceCameraController.maximumZoomDistance,n=i.range;if(!Object(u["a"])(n)||0===n){var r=a.radius;0===r?i.range=Ra:t.frustum instanceof E["a"]||t._mode===x["a"].SCENE2D?i.range=Sa(t,r):i.range=Na(t,r),i.range=C["a"].clamp(i.range,o,e)}return i}M.prototype.viewBoundingSphere=function(t,a){a=Aa(this,t,a),this.lookAt(t.center,a)};var Da=new y["a"],Fa=new n["a"],Va=new n["a"],Ba=new n["a"],za=new n["a"],La=new r["a"],Ua=new w["a"],ka=new T["a"];M.prototype.flyToBoundingSphere=function(t,a){a=Object(c["a"])(a,c["a"].EMPTY_OBJECT);var i=this._mode===x["a"].SCENE2D||this._mode===x["a"].COLUMBUS_VIEW;this._setTransform(y["a"].IDENTITY);var o,e=Aa(this,t,a.offset);o=i?n["a"].multiplyByScalar(n["a"].UNIT_Z,e.range,Fa):zt(e.heading,e.pitch,e.range);var r,s,u=I["a"].eastNorthUpToFixedFrame(t.center,l["a"].WGS84,Da);if(y["a"].multiplyByPoint(u,o,o),!i){if(r=n["a"].subtract(t.center,o,Va),n["a"].normalize(r,r),s=y["a"].multiplyByPointAsVector(u,n["a"].UNIT_Z,Ba),1-Math.abs(n["a"].dot(r,s))<C["a"].EPSILON6){var h=w["a"].fromAxisAngle(r,e.heading,Ua),m=T["a"].fromQuaternion(h,ka);n["a"].fromCartesian4(y["a"].getColumn(u,1,La),s),T["a"].multiplyByVector(m,s,s)}var d=n["a"].cross(r,s,za);n["a"].cross(d,r,s),n["a"].normalize(s,s)}this.flyTo({destination:o,orientation:{direction:r,up:s},duration:a.duration,complete:a.complete,cancel:a.cancel,endTransform:a.endTransform,maximumHeight:a.maximumHeight,easingFunction:a.easingFunction,flyOverLongitude:a.flyOverLongitude,flyOverLongitudeWeight:a.flyOverLongitudeWeight,pitchAdjustHeight:a.pitchAdjustHeight})};var Ha=new n["a"],Ya=new n["a"],qa=new n["a"],Za=new n["a"],Ga=[new n["a"],new n["a"],new n["a"],new n["a"]];function Xa(t,a){var i,o,e=a.radii,r=t.positionWC,s=n["a"].multiplyComponents(a.oneOverRadii,r,Ha),c=n["a"].magnitude(s),u=n["a"].normalize(s,Ya);n["a"].equalsEpsilon(u,n["a"].UNIT_Z,C["a"].EPSILON10)?(i=new n["a"](0,1,0),o=new n["a"](0,0,1)):(i=n["a"].normalize(n["a"].cross(n["a"].UNIT_Z,u,qa),qa),o=n["a"].normalize(n["a"].cross(u,i,Za),Za));var h=Math.sqrt(n["a"].magnitudeSquared(s)-1),l=n["a"].multiplyByScalar(u,1/c,Ha),m=h/c,d=n["a"].multiplyByScalar(i,m,Ya),p=n["a"].multiplyByScalar(o,m,qa),f=n["a"].add(l,p,Ga[0]);n["a"].subtract(f,d,f),n["a"].multiplyComponents(e,f,f);var _=n["a"].subtract(l,p,Ga[1]);n["a"].subtract(_,d,_),n["a"].multiplyComponents(e,_,_);var g=n["a"].subtract(l,p,Ga[2]);n["a"].add(g,d,g),n["a"].multiplyComponents(e,g,g);var v=n["a"].add(l,p,Ga[3]);return n["a"].add(v,d,v),n["a"].multiplyComponents(e,v,v),Ga}var Ja=new e["a"],Qa=new n["a"],Ka=[new s["a"],new s["a"],new s["a"],new s["a"]];function $a(t,a,i,o,e,n){Ja.x=t,Ja.y=a;var r=o.pickEllipsoid(Ja,e,Qa);return Object(u["a"])(r)?(Ka[i]=e.cartesianToCartographic(r,Ka[i]),1):(Ka[i]=e.cartesianToCartographic(n[i],Ka[i]),0)}M.prototype.computeViewRectangle=function(t,a){t=Object(c["a"])(t,l["a"].WGS84);var i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),e=new o["a"](n["a"].ZERO,t.maximumRadius),r=i.computeVisibility(e);if(r!==g["a"].OUTSIDE){var s=this._scene.canvas,u=s.clientWidth,h=s.clientHeight,m=0,d=Xa(this,t);if(m+=$a(0,0,0,this,t,d),m+=$a(0,h,1,this,t,d),m+=$a(u,h,2,this,t,d),m+=$a(u,0,3,this,t,d),m<2)return b["a"].MAX_VALUE;a=b["a"].fromCartographicArray(Ka,a);for(var p=0,f=Ka[3].longitude,_=0;_<4;++_){var v=Ka[_].longitude,T=Math.abs(v-f);T>C["a"].PI?p+=C["a"].TWO_PI-T:p+=T,f=v}return C["a"].equalsEpsilon(Math.abs(p),C["a"].TWO_PI,C["a"].EPSILON9)&&(a.west=-C["a"].PI,a.east=C["a"].PI,Ka[0].latitude>=0?a.north=C["a"].PI_OVER_TWO:a.south=-C["a"].PI_OVER_TWO),a}},M.prototype.switchToPerspectiveFrustum=function(){if(!(this._mode===x["a"].SCENE2D||this.frustum instanceof O["a"])){var t=this._scene;this.frustum=new O["a"],this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.fov=C["a"].toRadians(60)}},M.prototype.switchToOrthographicFrustum=function(){if(!(this._mode===x["a"].SCENE2D||this.frustum instanceof E["a"])){var t=et(this),a=this._scene;this.frustum=new E["a"],this.frustum.aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,this.frustum.width=t}},M.clone=function(t,a){return Object(u["a"])(a)||(a=new M(t._scene)),n["a"].clone(t.position,a.position),n["a"].clone(t.direction,a.direction),n["a"].clone(t.up,a.up),n["a"].clone(t.right,a.right),y["a"].clone(t._transform,a.transform),a._transformChanged=!0,a.frustum=t.frustum.clone(),a},a["a"]=M}}]);