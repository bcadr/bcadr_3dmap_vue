(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~66537c81"],{"2a1b":function(e,t,a){"use strict";var i=a("670c"),r=a("be18"),n=a("bef8"),s=a("abab"),o=a("535a"),u=a("2f63"),h=a("6cbd"),c=a("c888"),d=a("93da"),m=a("52f0"),p=a("eace"),l=a("f806"),_=a("5770"),f=a("3a8e"),w=a("001c");function g(e,t,a){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};var i=new E;i.requiresTextureCoordinates=e,i.requiresEC=!a.flat;var r=new E;if(r.requiresTextureCoordinates=e,a instanceof f["a"])i.requiresNormalEC=!a.flat;else{var n=a.material.shaderSource+"\n"+a.fragmentShaderSource;i.normalEC=-1!==n.indexOf("materialInput.normalEC")||-1!==n.indexOf("czm_getDefaultMaterial"),i.positionToEyeEC=-1!==n.indexOf("materialInput.positionToEyeEC"),i.tangentToEyeMatrix=-1!==n.indexOf("materialInput.tangentToEyeMatrix"),i.st=-1!==n.indexOf("materialInput.st")}this._colorShaderDependencies=i,this._pickShaderDependencies=r,this._appearance=a,this._extentsCulling=e,this._planarExtents=t}g.prototype.createFragmentShader=function(e){var t=this._appearance,a=this._colorShaderDependencies,i=[];e||this._planarExtents||i.push("SPHERICAL"),a.requiresEC&&i.push("REQUIRES_EC"),a.requiresWC&&i.push("REQUIRES_WC"),a.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),a.requiresNormalEC&&i.push("NORMAL_EC"),t instanceof f["a"]&&i.push("PER_INSTANCE_COLOR"),a.normalEC&&i.push("USES_NORMAL_EC"),a.positionToEyeEC&&i.push("USES_POSITION_TO_EYE_EC"),a.tangentToEyeMatrix&&i.push("USES_TANGENT_TO_EYE"),a.st&&i.push("USES_ST"),t.flat&&i.push("FLAT");var r="";return t instanceof f["a"]||(r=t.material.shaderSource),new _["a"]({defines:i,sources:[r,w["a"]]})},g.prototype.createPickFragmentShader=function(e){var t=this._pickShaderDependencies,a=["PICK"];return e||this._planarExtents||a.push("SPHERICAL"),t.requiresEC&&a.push("REQUIRES_EC"),t.requiresWC&&a.push("REQUIRES_WC"),t.requiresTextureCoordinates&&a.push("TEXTURE_COORDINATES"),this._extentsCulling&&a.push("CULL_FRAGMENTS"),new _["a"]({defines:a,sources:[w["a"]],pickColorQualifier:"varying"})},g.prototype.createVertexShader=function(e,t,a,i){return x(this._colorShaderDependencies,this._planarExtents,a,e,t,this._appearance,i,this._projectionExtentDefines)},g.prototype.createPickVertexShader=function(e,t,a,i){return x(this._pickShaderDependencies,this._planarExtents,a,e,t,void 0,i,this._projectionExtentDefines)};var v=new r["a"],C=new n["a"],S={high:0,low:0};function x(e,t,a,i,r,n,s,o){var c=i.slice();if(""===o.eastMostYhighDefine){var m=C;m.longitude=d["a"].PI,m.latitude=0,m.height=0;var p=s.project(m,v),l=h["a"].encode(p.x,S);o.eastMostYhighDefine="EAST_MOST_X_HIGH "+l.high.toFixed((l.high+"").length+1),o.eastMostYlowDefine="EAST_MOST_X_LOW "+l.low.toFixed((l.low+"").length+1);var w=C;w.longitude=-d["a"].PI,w.latitude=0,w.height=0;var g=s.project(w,v);l=h["a"].encode(g.x,S),o.westMostYhighDefine="WEST_MOST_X_HIGH "+l.high.toFixed((l.high+"").length+1),o.westMostYlowDefine="WEST_MOST_X_LOW "+l.low.toFixed((l.low+"").length+1)}return a&&(c.push(o.eastMostYhighDefine),c.push(o.eastMostYlowDefine),c.push(o.westMostYhighDefine),c.push(o.westMostYlowDefine)),Object(u["a"])(n)&&n instanceof f["a"]&&c.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(c.push("TEXTURE_COORDINATES"),t||a||c.push("SPHERICAL"),a&&c.push("COLUMBUS_VIEW_2D")),new _["a"]({defines:c,sources:[r]})}function E(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}function b(e,t,a){return Math.abs((t.y-e.y)*a.x-(t.x-e.x)*a.y+t.x*e.y-t.y*e.x)/i["a"].distance(t,e)}Object.defineProperties(E.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});var y=[new i["a"],new i["a"],new i["a"],new i["a"]];function O(e,t){var a=y,r=i["a"].unpack(t,0,a[0]),n=i["a"].unpack(t,2,a[1]),o=i["a"].unpack(t,4,a[2]);e.uMaxVmax=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:4,normalize:!1,value:[n.x,n.y,o.x,o.y]});var u=1/b(r,n,o),h=1/b(r,o,n);e.uvMinAndExtents=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,u,h]})}var M=new n["a"],P=new r["a"],A=new r["a"],T=new r["a"],D={high:0,low:0};function L(e,t,a){var i=M;i.height=0,i.longitude=e.west,i.latitude=e.south;var r=t.project(i,P);i.latitude=e.north;var n=t.project(i,A);i.longitude=e.east,i.latitude=e.south;var o=t.project(i,T),u=[0,0,0,0],d=[0,0,0,0],m=h["a"].encode(r.x,D);u[0]=m.high,d[0]=m.low,m=h["a"].encode(r.y,D),u[1]=m.high,d[1]=m.low,m=h["a"].encode(n.y,D),u[2]=m.high,d[2]=m.low,m=h["a"].encode(o.x,D),u[3]=m.high,d[3]=m.low,a.planes2D_HIGH=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:4,normalize:!1,value:u}),a.planes2D_LOW=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:4,normalize:!1,value:d})}var N=new m["a"],F=new m["a"],z=new r["a"],I=new n["a"],R=[new n["a"],new n["a"],new n["a"],new n["a"],new n["a"],new n["a"],new n["a"],new n["a"]];function V(e,t,a,i,s,o){var u=p["a"].center(e,I);u.height=a;var h=n["a"].toCartesian(u,t,z),c=l["a"].eastNorthUpToFixedFrame(h,t,N),d=m["a"].inverse(c,F),_=e.west,f=e.east,w=e.north,g=e.south,v=R;v[0].latitude=g,v[0].longitude=_,v[1].latitude=w,v[1].longitude=_,v[2].latitude=w,v[2].longitude=f,v[3].latitude=g,v[3].longitude=f;var C=.5*(_+f),S=.5*(w+g);v[4].latitude=g,v[4].longitude=C,v[5].latitude=w,v[5].longitude=C,v[6].latitude=S,v[6].longitude=_,v[7].latitude=S,v[7].longitude=f;for(var x=Number.POSITIVE_INFINITY,E=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,O=0;O<8;O++){v[O].height=a;var M=n["a"].toCartesian(v[O],t,z);m["a"].multiplyByPoint(d,M,M),M.z=0,x=Math.min(x,M.x),E=Math.max(E,M.x),b=Math.min(b,M.y),y=Math.max(y,M.y)}var P=i;P.x=x,P.y=b,P.z=0,m["a"].multiplyByPoint(c,P,P);var A=s;A.x=E,A.y=b,A.z=0,m["a"].multiplyByPoint(c,A,A),r["a"].subtract(A,P,s);var T=o;T.x=x,T.y=y,T.z=0,m["a"].multiplyByPoint(c,T,T),r["a"].subtract(T,P,o)}var W=new r["a"],j=new r["a"],B=new h["a"];g.getPlanarTextureCoordinateAttributes=function(e,t,a,i,n){var u=P,d=W,m=j;V(e,a,Object(o["a"])(n,0),u,d,m);var p={};O(p,t);var l=h["a"].fromCartesian(u,B);return p.southWest_HIGH=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:3,normalize:!1,value:r["a"].pack(l.high,[0,0,0])}),p.southWest_LOW=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:3,normalize:!1,value:r["a"].pack(l.low,[0,0,0])}),p.eastward=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:3,normalize:!1,value:r["a"].pack(d,[0,0,0])}),p.northward=new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:3,normalize:!1,value:r["a"].pack(m,[0,0,0])}),L(e,i,p),p};var U=new r["a"];function H(e,t,a,i){var r=M;r.latitude=e,r.longitude=t,r.height=0;var s=n["a"].toCartesian(r,a,U),o=Math.sqrt(s.x*s.x+s.y*s.y),u=d["a"].fastApproximateAtan2(o,s.z),h=d["a"].fastApproximateAtan2(s.x,s.y);return i.x=u,i.y=h,i}var k=new i["a"];function q(e){return Math.max(e.width,e.height)>g.MAX_WIDTH_FOR_PLANAR_EXTENTS}g.getSphericalExtentGeometryInstanceAttributes=function(e,t,a,i){var r=H(e.south,e.west,a,k),n=r.x,o=r.y,u=H(e.north,e.east,a,k),h=u.x,m=u.y,p=0;o>m&&(p=d["a"].PI-o,o=-d["a"].PI,m+=p),n-=d["a"].EPSILON5,o-=d["a"].EPSILON5,h+=d["a"].EPSILON5,m+=d["a"].EPSILON5;var l=1/(m-o),_=1/(h-n),f={sphericalExtents:new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:4,normalize:!1,value:[n,o,_,l]}),longitudeRotation:new c["a"]({componentDatatype:s["a"].FLOAT,componentsPerAttribute:1,normalize:!1,value:[p]})};return O(f,t),L(e,i,f),f},g.hasAttributesForTextureCoordinatePlanes=function(e){return Object(u["a"])(e.southWest_HIGH)&&Object(u["a"])(e.southWest_LOW)&&Object(u["a"])(e.northward)&&Object(u["a"])(e.eastward)&&Object(u["a"])(e.planes2D_HIGH)&&Object(u["a"])(e.planes2D_LOW)&&Object(u["a"])(e.uMaxVmax)&&Object(u["a"])(e.uvMinAndExtents)},g.hasAttributesForSphericalExtents=function(e){return Object(u["a"])(e.sphericalExtents)&&Object(u["a"])(e.longitudeRotation)&&Object(u["a"])(e.planes2D_HIGH)&&Object(u["a"])(e.planes2D_LOW)&&Object(u["a"])(e.uMaxVmax)&&Object(u["a"])(e.uvMinAndExtents)},g.shouldUseSphericalCoordinates=function(e){return q(e)},g.MAX_WIDTH_FOR_PLANAR_EXTENTS=d["a"].toRadians(1),t["a"]=g},"569f":function(e,t,a){"use strict";var i=a("77af"),r=a("cef5"),n=a("b081"),s=a("670c"),o=a("be18"),u=a("a561"),h=a("bef8"),c=a("dc1c"),d=a("bd8d"),m=a("9541"),p=a("2bb9"),l=a("2384"),_=a("535a"),f=a("2f63"),w=a("7d62"),g=a("5e57"),v=a("d9403"),C=a("66bf"),S=a("93da"),x=a("52f0"),E=a("c34a"),b=a("4e1a"),y=a("e42d"),O=a("0260"),M=a("98f6"),P=a("daa2"),A=a("f845"),T=a("b997"),D=a("9ab9"),L=a("a894"),N=a("ac3b"),F=a("d289"),z=a("00f8"),I=a("6ef5"),R=a("8a65"),V=a("3550"),W=a("6dc0"),j=a("6c84"),B=a("a913"),U=a("9dbf"),H=a("29ab"),k=a("c965"),q=a("3a8e"),Y=a("894b"),G=a("8ef2");function X(e){e=Object(_["a"])(e,_["a"].EMPTY_OBJECT);var t=e.context;this._enabled=Object(_["a"])(e.enabled,!0),this._softShadows=Object(_["a"])(e.softShadows,!1),this._normalOffset=Object(_["a"])(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=Object(_["a"])(e.fromLightSource,!0),this.darkness=Object(_["a"])(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=Object(_["a"])(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var a,i=!0;(g["a"].isInternetExplorer()||g["a"].isEdge()||(g["a"].isChrome()||g["a"].isFirefox())&&g["a"].isWindows()&&!t.depthTexture)&&(i=!1),this._polygonOffsetSupported=i,this._terrainBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new x["a"],this._shadowMapTexture=void 0,this._lightDirectionEC=new o["a"],this._lightPositionEC=new u["a"],this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new ge,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new r["a"],this._isPointLight=Object(_["a"])(e.isPointLight,!1),this._pointLightRadius=Object(_["a"])(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&Object(_["a"])(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?Object(_["a"])(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new s["a"],this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new E["a"]:Object(f["a"])(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new u["a"],new u["a"]],this._cascadeMatrices=[new x["a"],new x["a"],new x["a"],new x["a"]],this._cascadeDistances=new u["a"],a=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(a);for(var n=0;n<a;++n)this._passes[n]=new K(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Z(this),this._clearCommand=new A["a"]({depth:1,color:new d["a"]}),this._clearPassState=new z["a"](t),this._size=Object(_["a"])(e.size,2048),this.size=this._size}function K(e){this.camera=new ge,this.passState=new z["a"](e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Q(e,t){return W["a"].fromCache({cull:{enabled:!0,face:H["a"].BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Z(e){var t=!e._usesDepthTexture;e._primitiveRenderState=Q(t,e._primitiveBias),e._terrainRenderState=Q(t,e._terrainBias),e._pointRenderState=Q(t,e._pointBias)}function J(e){for(var t=e._passes.length,a=0;a<t;++a){var i=e._passes[a],r=i.framebuffer;Object(f["a"])(r)&&!r.isDestroyed()&&r.destroy(),i.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function $(e,t){for(var a=new R["a"]({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V["a"].DEPTH_COMPONENT16}),i=new B["a"]({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:y["a"].RGBA,pixelDatatype:I["a"].UNSIGNED_BYTE,sampler:j["a"].NEAREST}),r=new N["a"]({context:t,depthRenderbuffer:a,colorTextures:[i],destroyAttachments:!1}),n=e._passes.length,s=0;s<n;++s){var o=e._passes[s];o.framebuffer=r,o.passState.framebuffer=r}e._shadowMapTexture=i,e._depthAttachment=a,e._colorAttachment=i}function ee(e,t){for(var a=new B["a"]({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:y["a"].DEPTH_STENCIL,pixelDatatype:I["a"].UNSIGNED_INT_24_8,sampler:j["a"].NEAREST}),i=new N["a"]({context:t,depthStencilTexture:a,destroyAttachments:!1}),r=e._passes.length,n=0;n<r;++n){var s=e._passes[n];s.framebuffer=i,s.passState.framebuffer=i}e._shadowMapTexture=a,e._depthAttachment=a}function te(e,t){for(var a=new R["a"]({context:t,width:e._textureSize.x,height:e._textureSize.y,format:V["a"].DEPTH_COMPONENT16}),i=new D["a"]({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:y["a"].RGBA,pixelDatatype:I["a"].UNSIGNED_BYTE,sampler:j["a"].NEAREST}),r=[i.negativeX,i.negativeY,i.negativeZ,i.positiveX,i.positiveY,i.positiveZ],n=0;n<6;++n){var s=new N["a"]({context:t,depthRenderbuffer:a,colorTextures:[r[n]],destroyAttachments:!1}),o=e._passes[n];o.framebuffer=s,o.passState.framebuffer=s}e._shadowMapTexture=i,e._depthAttachment=a,e._colorAttachment=i}function ae(e,t){e._isPointLight?te(e,t):e._usesDepthTexture?ee(e,t):$(e,t)}function ie(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==P["a"].FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Z(e),J(e),ae(e,t))}function re(e,t){Object(f["a"])(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(J(e),ae(e,t),ie(e,t),ne(e,t))}function ne(e,t,a){a=Object(_["a"])(a,0),(e._isPointLight||0===a)&&(e._clearCommand.framebuffer=e._passes[a].framebuffer,e._clearCommand.execute(t,e._clearPassState))}function se(e,t){e._size=t;var a=e._passes,r=a.length,n=e._textureSize;if(e._isPointLight){t=T["a"].maximumCubeMapSize>=t?t:T["a"].maximumCubeMapSize,n.x=t,n.y=t;var s=new i["a"](0,0,t,t);a[0].passState.viewport=s,a[1].passState.viewport=s,a[2].passState.viewport=s,a[3].passState.viewport=s,a[4].passState.viewport=s,a[5].passState.viewport=s}else 1===r?(t=T["a"].maximumTextureSize>=t?t:T["a"].maximumTextureSize,n.x=t,n.y=t,a[0].passState.viewport=new i["a"](0,0,t,t)):4===r&&(t=T["a"].maximumTextureSize>=2*t?t:T["a"].maximumTextureSize/2,n.x=2*t,n.y=2*t,a[0].passState.viewport=new i["a"](0,0,t,t),a[1].passState.viewport=new i["a"](t,0,t,t),a[2].passState.viewport=new i["a"](0,t,t,t),a[3].passState.viewport=new i["a"](t,t,t,t));e._clearPassState.viewport=new i["a"](0,0,n.x,n.y);for(var o=0;o<r;++o){var u=a[o],h=u.passState.viewport,c=h.x/n.x,d=h.y/n.y,m=h.width/n.x,p=h.height/n.y;u.textureOffsets=new x["a"](m,0,0,c,0,p,0,d,0,0,1,0,0,0,0,1)}}X.MAXIMUM_DISTANCE=2e4,X.prototype.debugCreateRenderStates=function(){Z(this)},Object.defineProperties(X.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){se(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var oe=new i["a"];function ue(e,t){var a;a=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var i=t.createViewportQuadCommand(a,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return i.pass=F["a"].OVERLAY,i}function he(e,t){var a=t.context,r=t.context.drawingBufferWidth,n=t.context.drawingBufferHeight,s=.3*Math.min(r,n),o=oe;o.x=r-s,o.y=0,o.width=s,o.height=s;var u=e._debugShadowViewCommand;Object(f["a"])(u)||(u=ue(e,a),e._debugShadowViewCommand=u),Object(f["a"])(u.renderState)&&i["a"].equals(u.renderState.viewport,o)||(u.renderState=W["a"].fromCache({viewport:i["a"].clone(o)})),t.commandList.push(e._debugShadowViewCommand)}var ce=new Array(8);ce[0]=new u["a"](-1,-1,-1,1),ce[1]=new u["a"](1,-1,-1,1),ce[2]=new u["a"](1,1,-1,1),ce[3]=new u["a"](-1,1,-1,1),ce[4]=new u["a"](-1,-1,1,1),ce[5]=new u["a"](1,-1,1,1),ce[6]=new u["a"](1,1,1,1),ce[7]=new u["a"](-1,1,1,1);for(var de=new x["a"],me=new Array(8),pe=0;pe<8;++pe)me[pe]=new u["a"];function le(e,t){var a=new v["a"]({geometry:new n["a"]({minimum:new o["a"](-.5,-.5,-.5),maximum:new o["a"](.5,.5,.5)}),attributes:{color:m["a"].fromColor(t)}}),i=new v["a"]({geometry:new M["a"]({radius:.5}),attributes:{color:m["a"].fromColor(t)}});return new Y["a"]({geometryInstances:[a,i],appearance:new q["a"]({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}var _e=[d["a"].RED,d["a"].GREEN,d["a"].BLUE,d["a"].MAGENTA],fe=new o["a"];function we(e,t){he(e,t);var a=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(a&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new k["a"]({camera:e._sceneCamera,color:d["a"].CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){a&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new k["a"]({camera:e._shadowMapCamera,color:d["a"].YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var i=0;i<e._numberOfCascades;++i)a&&(e._debugCascadeFrustums[i]=e._debugCascadeFrustums[i]&&e._debugCascadeFrustums[i].destroy(),e._debugCascadeFrustums[i]=new k["a"]({camera:e._passes[i].camera,color:_e[i],updateOnChange:!1})),e._debugCascadeFrustums[i].update(t)}}else if(e._isPointLight){if(!Object(f["a"])(e._debugLightFrustum)||e._needsUpdate){var r=e._shadowMapCamera.positionWC,n=O["a"].IDENTITY,s=2*e._pointLightRadius,u=o["a"].fromElements(s,s,s,fe),h=x["a"].fromTranslationQuaternionRotationScale(r,n,u,de);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=le(h,d["a"].YELLOW)}e._debugLightFrustum.update(t)}else Object(f["a"])(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new k["a"]({camera:e._shadowMapCamera,color:d["a"].YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function ge(){this.viewMatrix=new x["a"],this.inverseViewMatrix=new x["a"],this.frustum=void 0,this.positionCartographic=new h["a"],this.positionWC=new o["a"],this.directionWC=o["a"].clone(o["a"].UNIT_Z),this.upWC=o["a"].clone(o["a"].UNIT_Y),this.rightWC=o["a"].clone(o["a"].UNIT_X),this.viewProjectionMatrix=new x["a"]}ge.prototype.clone=function(e){x["a"].clone(e.viewMatrix,this.viewMatrix),x["a"].clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),h["a"].clone(e.positionCartographic,this.positionCartographic),o["a"].clone(e.positionWC,this.positionWC),o["a"].clone(e.directionWC,this.directionWC),o["a"].clone(e.upWC,this.upWC),o["a"].clone(e.rightWC,this.rightWC)};var ve=new x["a"](.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);ge.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return x["a"].multiply(t,e,this.viewProjectionMatrix),x["a"].multiply(ve,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var Ce=new Array(5),Se=new b["a"],xe=new Array(4),Ee=new o["a"],be=new o["a"];function ye(e,t){var a,i=e._shadowMapCamera,r=e._sceneCamera,n=r.frustum.near,s=r.frustum.far,h=e._numberOfCascades,c=s-n,d=s/n,m=.9,p=!1;t.shadowState.closestObjectSize<200&&(p=!0,m=.9);var l=xe,_=Ce;for(_[0]=n,_[h]=s,a=0;a<h;++a){var f=(a+1)/h,w=n*Math.pow(d,f),g=n+c*f,v=S["a"].lerp(g,w,m);_[a+1]=v,l[a]=v-_[a]}if(p){for(a=0;a<h;++a)l[a]=Math.min(l[a],e._maximumCascadeDistances[a]);var C=_[0];for(a=0;a<h-1;++a)C+=l[a],_[a+1]=C}u["a"].unpack(_,0,e._cascadeSplits[0]),u["a"].unpack(_,1,e._cascadeSplits[1]),u["a"].unpack(l,0,e._cascadeDistances);var E=i.frustum,b=E.left,y=E.right,O=E.bottom,M=E.top,P=E.near,A=E.far,T=i.positionWC,D=i.directionWC,L=i.upWC,N=r.frustum.clone(Se),F=i.getViewProjection();for(a=0;a<h;++a){N.near=_[a],N.far=_[a+1];for(var z=x["a"].multiply(N.projectionMatrix,r.viewMatrix,de),I=x["a"].inverse(z,de),R=x["a"].multiply(F,I,de),V=o["a"].fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Ee),W=o["a"].fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,be),j=0;j<8;++j){var B=u["a"].clone(ce[j],me[j]);x["a"].multiplyByVector(R,B,B),o["a"].divideByScalar(B,B.w,B),o["a"].minimumByComponent(B,V,V),o["a"].maximumByComponent(B,W,W)}V.x=Math.max(V.x,0),V.y=Math.max(V.y,0),V.z=0,W.x=Math.min(W.x,1),W.y=Math.min(W.y,1),W.z=Math.min(W.z,1);var U=e._passes[a],H=U.camera;H.clone(i);var k=H.frustum;k.left=b+V.x*(y-b),k.right=b+W.x*(y-b),k.bottom=O+V.y*(M-O),k.top=O+W.y*(M-O),k.near=P+V.z*(A-P),k.far=P+W.z*(A-P),U.cullingVolume=H.frustum.computeCullingVolume(T,D,L);var q=e._cascadeMatrices[a];x["a"].multiply(H.getViewProjection(),r.inverseViewMatrix,q),x["a"].multiply(U.textureOffsets,q,q)}}var Oe=new x["a"],Me=new o["a"],Pe=new o["a"],Ae=new o["a"];function Te(e,t){var a=e._shadowMapCamera,i=e._sceneCamera,r=x["a"].multiply(i.frustum.projectionMatrix,i.viewMatrix,de),n=x["a"].inverse(r,de),s=a.directionWC,h=i.directionWC;o["a"].equalsEpsilon(s,h,S["a"].EPSILON10)&&(h=i.upWC);var c=o["a"].cross(s,h,Me);h=o["a"].cross(c,s,Pe),o["a"].normalize(h,h),o["a"].normalize(c,c);for(var d=o["a"].fromElements(0,0,0,Ae),m=x["a"].computeView(d,s,h,c,Oe),p=x["a"].multiply(m,n,de),l=o["a"].fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Ee),_=o["a"].fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,be),f=0;f<8;++f){var w=u["a"].clone(ce[f],me[f]);x["a"].multiplyByVector(p,w,w),o["a"].divideByScalar(w,w.w,w),o["a"].minimumByComponent(w,l,l),o["a"].maximumByComponent(w,_,_)}_.z+=1e3,l.z-=10;var g=Ae;g.x=-.5*(l.x+_.x),g.y=-.5*(l.y+_.y),g.z=-_.z;var v=x["a"].fromTranslation(g,de);m=x["a"].multiply(v,m,m);var C=.5*(_.x-l.x),E=.5*(_.y-l.y),b=_.z-l.z,y=a.frustum;y.left=-C,y.right=C,y.bottom=-E,y.top=E,y.near=.01,y.far=b,x["a"].clone(m,a.viewMatrix),x["a"].inverse(m,a.inverseViewMatrix),x["a"].getTranslation(a.inverseViewMatrix,a.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(a.positionWC,a.positionCartographic),o["a"].clone(s,a.directionWC),o["a"].clone(h,a.upWC),o["a"].clone(c,a.rightWC)}var De=[new o["a"](-1,0,0),new o["a"](0,-1,0),new o["a"](0,0,-1),new o["a"](1,0,0),new o["a"](0,1,0),new o["a"](0,0,1)],Le=[new o["a"](0,-1,0),new o["a"](0,0,-1),new o["a"](0,-1,0),new o["a"](0,-1,0),new o["a"](0,0,1),new o["a"](0,-1,0)],Ne=[new o["a"](0,0,1),new o["a"](1,0,0),new o["a"](-1,0,0),new o["a"](0,0,-1),new o["a"](1,0,0),new o["a"](1,0,0)];function Fe(e,t){var a=new b["a"];a.fov=S["a"].PI_OVER_TWO,a.near=1,a.far=e._pointLightRadius,a.aspectRatio=1;for(var i=0;i<6;++i){var r=e._passes[i].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=De[i],r.upWC=Le[i],r.rightWC=Ne[i],x["a"].computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),x["a"].inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=a}}var ze=new o["a"],Ie=new o["a"],Re=new r["a"],Ve=Re.center;function We(e,t){var a=e._sceneCamera,i=e._shadowMapCamera,n=Re;if(e._cascadesEnabled){if(a.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var s=t.mapProjection.ellipsoid.geodeticSurfaceNormal(a.positionWC,ze),u=o["a"].negate(i.directionWC,Ie),h=o["a"].dot(s,u),c=S["a"].clamp(h/.1,0,1);if(e._darkness=S["a"].lerp(1,e.darkness,c),h<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)n.center=i.positionWC,n.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(n)===C["a"].OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(n),r["a"].clone(n,e._boundingSphere);else{var d=i.frustum.far/2,m=o["a"].add(i.positionWC,o["a"].multiplyByScalar(i.directionWC,d,Ve),Ve);n.center=m,n.radius=d,e._outOfView=t.cullingVolume.computeVisibility(n)===C["a"].OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(n),r["a"].clone(n,e._boundingSphere)}}function je(e,t){var a=t.camera,i=e._lightCamera,r=e._sceneCamera,n=e._shadowMapCamera;e._cascadesEnabled?o["a"].clone(i.directionWC,n.directionWC):e._isPointLight?o["a"].clone(i.positionWC,n.positionWC):n.clone(i);var s,u,h=e._lightDirectionEC;x["a"].multiplyByPointAsVector(a.viewMatrix,n.directionWC,h),o["a"].normalize(h,h),o["a"].negate(h,h),x["a"].multiplyByPoint(a.viewMatrix,n.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(s=Math.min(t.shadowState.nearPlane,e.maximumDistance),u=Math.min(t.shadowState.farPlane,e.maximumDistance),u=Math.max(u,s+1)):(s=a.frustum.near,u=e.maximumDistance),e._sceneCamera=U["a"].clone(a,r),a.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=s,e._sceneCamera.frustum.far=u,e._distance=u-s,We(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}X.prototype.update=function(e){if(je(this,e),this._needsUpdate)if(re(this,e.context),this._isPointLight&&Fe(this,e),this._cascadesEnabled&&(Te(this,e),this._numberOfCascades>1&&ye(this,e)),this._isPointLight)this._shadowMapCullingVolume=l["a"].fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,a=t.positionWC,i=t.directionWC,r=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(a,i,r),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var n=this._sceneCamera.inverseViewMatrix;x["a"].multiply(this._shadowMapCamera.getViewProjection(),n,this._shadowMapMatrix)}this.debugShow&&we(this,e)},X.prototype.updatePass=function(e,t){ne(this,e,t)};var Be=new s["a"];function Ue(e,t,a){var i=e._isPointLight?e._pointBias:a?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=Be;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,u["a"].fromElements(t.x,t.y,i.depthBias,i.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return u["a"].fromElements(i.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new u["a"],combinedUniforms2:new u["a"]};return Object(p["a"])(t,r,!1)}function He(e,t,a,i,r,n){var s,o,u;if(Object(f["a"])(n)&&(s=n.shaderProgram,o=n.renderState,u=n.uniformMap),n=L["a"].shallowClone(a,n),n.castShadows=!0,n.receiveShadows=!1,!Object(f["a"])(s)||r!==a.shaderProgram.id||t){var h=a.shaderProgram,d=a.pass===F["a"].GLOBE,m=a.pass!==F["a"].TRANSLUCENT,p=e._isPointLight,l=e._usesDepthTexture,_=G["a"].getShadowCastShaderKeyword(p,d,l,m);if(s=i.shaderCache.getDerivedShaderProgram(h,_),!Object(f["a"])(s)){var w=h.vertexShaderSource,g=h.fragmentShaderSource,v=G["a"].createShadowCastVertexShader(w,p,d),C=G["a"].createShadowCastFragmentShader(g,p,l,m);s=i.shaderCache.createDerivedShaderProgram(h,_,{vertexShaderSource:v,fragmentShaderSource:C,attributeLocations:h._attributeLocations})}o=e._primitiveRenderState,p?o=e._pointRenderState:d&&(o=e._terrainRenderState);var S=a.renderState.cull.enabled;S||(o=Object(c["a"])(o,!1),o.cull=Object(c["a"])(o.cull,!1),o.cull.enabled=!1,o=W["a"].fromCache(o)),u=Ue(e,a.uniformMap,d)}return n.shaderProgram=s,n.renderState=o,n.uniformMap=u,n}X.createReceiveDerivedCommand=function(e,t,a,i,r){Object(f["a"])(r)||(r={});var n=e.length>0,s=t.shaderProgram,o=s.vertexShaderSource,u=s.fragmentShaderSource,h=t.pass===F["a"].GLOBE,c=!1;if(h&&(c=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&n){var d,m;Object(f["a"])(r.receiveCommand)&&(d=r.receiveCommand.shaderProgram,m=r.receiveCommand.uniformMap),r.receiveCommand=L["a"].shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var p=r.receiveShaderCastShadows!==t.castShadows,l=r.receiveShaderProgramId!==t.shaderProgram.id;if(!Object(f["a"])(d)||l||a||p){var _=G["a"].getShadowReceiveShaderKeyword(e[0],t.castShadows,h,c);if(d=i.shaderCache.getDerivedShaderProgram(s,_),!Object(f["a"])(d)){var w=G["a"].createShadowReceiveVertexShader(o,h,c),g=G["a"].createShadowReceiveFragmentShader(u,e[0],t.castShadows,h,c);d=i.shaderCache.createDerivedShaderProgram(s,_,{vertexShaderSource:w,fragmentShaderSource:g,attributeLocations:s._attributeLocations})}m=Ue(e[0],t.uniformMap,h)}r.receiveCommand.shaderProgram=d,r.receiveCommand.uniformMap=m,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},X.createCastDerivedCommand=function(e,t,a,i,r){if(Object(f["a"])(r)||(r={}),t.castShadows){var n=r.castCommands;Object(f["a"])(n)||(n=r.castCommands=[]);var s=r.castShaderProgramId,o=e.length;n.length=o;for(var u=0;u<o;++u)n[u]=He(e[u],a,t,i,s,n[u]);r.castShaderProgramId=t.shaderProgram.id}return r},X.prototype.isDestroyed=function(){return!1},X.prototype.destroy=function(){J(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return Object(w["a"])(this)},t["a"]=X},"8ef2":function(e,t,a){"use strict";var i=a("2f63"),r=a("5770");function n(){}n.getShadowCastShaderKeyword=function(e,t,a,i){return"castShadow "+e+" "+t+" "+a+" "+i},n.createShadowCastVertexShader=function(e,t,a){var n=e.defines.slice(0),s=e.sources.slice(0);n.push("SHADOW_MAP"),a&&n.push("GENERATE_POSITION");var o=r["a"].findPositionVarying(e),u=Object(i["a"])(o);if(t&&!u){for(var h=s.length,c=0;c<h;++c)s[c]=r["a"].replaceMain(s[c],"czm_shadow_cast_main");var d="varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}";s.push(d)}return new r["a"]({defines:n,sources:s})},n.createShadowCastFragmentShader=function(e,t,a,n){var s=e.defines.slice(0),o=e.sources.slice(0),u=r["a"].findPositionVarying(e),h=Object(i["a"])(u);h||(u="v_positionEC");for(var c=o.length,d=0;d<c;++d)o[d]=r["a"].replaceMain(o[d],"czm_shadow_cast_main");var m="";return t&&(h||(m+="varying vec3 v_positionEC; \n"),m+="uniform vec4 shadowMap_lightPositionEC; \n"),m+=n?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",m+=t?"    float distance = length("+u+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":a?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",m+="} \n",o.push(m),new r["a"]({defines:s,sources:o})},n.getShadowReceiveShaderKeyword=function(e,t,a,i){var r=e._usesDepthTexture,n=e._polygonOffsetSupported,s=e._isPointLight,o=e._isSpotLight,u=e._numberOfCascades>1,h=e.debugCascadeColors,c=e.softShadows;return"receiveShadow "+r+n+s+o+u+h+c+t+a+i},n.createShadowReceiveVertexShader=function(e,t,a){var i=e.defines.slice(0),n=e.sources.slice(0);return i.push("SHADOW_MAP"),t&&(a?i.push("GENERATE_POSITION_AND_NORMAL"):i.push("GENERATE_POSITION")),new r["a"]({defines:i,sources:n})},n.createShadowReceiveFragmentShader=function(e,t,a,n,s){for(var o=r["a"].findNormalVarying(e),u=!n&&Object(i["a"])(o)||n&&s,h=r["a"].findPositionVarying(e),c=Object(i["a"])(h),d=t._usesDepthTexture,m=t._polygonOffsetSupported,p=t._isPointLight,l=t._isSpotLight,_=t._numberOfCascades>1,f=t.debugCascadeColors,w=t.softShadows,g=p?t._pointBias:n?t._terrainBias:t._primitiveBias,v=e.defines.slice(0),C=e.sources.slice(0),S=C.length,x=0;x<S;++x)C[x]=r["a"].replaceMain(C[x],"czm_shadow_receive_main");p?v.push("USE_CUBE_MAP_SHADOW"):d&&v.push("USE_SHADOW_DEPTH_TEXTURE"),w&&!p&&v.push("USE_SOFT_SHADOWS"),_&&a&&n&&(u?v.push("ENABLE_VERTEX_LIGHTING"):v.push("ENABLE_DAYNIGHT_SHADING")),a&&g.normalShading&&u&&(v.push("USE_NORMAL_SHADING"),g.normalShadingSmooth>0&&v.push("USE_NORMAL_SHADING_SMOOTH"));var E,b="";return b+=p?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",E=c?"    return vec4("+h+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n",b+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+E+"} \nvec3 getNormalEC() \n{ \n"+(u?"    return normalize("+o+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(g.normalOffset&&u?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",b+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",b+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",n?b+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":m||(b+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),b+=p?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":l?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":_?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(f?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",b+="    gl_FragColor.rgb *= visibility; \n} \n",C.push(b),new r["a"]({defines:v,sources:C})},t["a"]=n},a098:function(e,t,a){"use strict";var i=a("b482"),r=a("be18"),n=a("535a"),s=a("2f63"),o=a("7d62"),u=a("c1e2"),h=a("52f0"),c=a("0541"),d=a("8b68"),m=a("9ab9"),p=a("a894"),l=a("b0b5"),_=a("6dc0"),f=a("e90c"),w=a("5770"),g=a("7c5e"),v=a("8167"),C=a("688e"),S=a("b7c8"),x=a("a307");function E(e){this.sources=e.sources,this._sources=void 0,this.show=Object(n["a"])(e.show,!0),this._command=new p["a"]({modelMatrix:h["a"].clone(h["a"].IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}E.prototype.update=function(e,t){var a=this;if(this.show&&(e.mode===x["a"].SCENE3D||e.mode===x["a"].MORPHING)&&e.passes.render){var n=e.context;if(this._sources!==this.sources){this._sources=this.sources;var o=this.sources;"string"===typeof o.positiveX?Object(l["a"])(n,this._sources).then((function(e){a._cubeMap=a._cubeMap&&a._cubeMap.destroy(),a._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new m["a"]({context:n,source:o}))}var h=this._command;if(!Object(s["a"])(h.vertexArray)){h.uniformMap={u_cubeMap:function(){return a._cubeMap}};var p=i["a"].createGeometry(i["a"].fromDimensions({dimensions:new r["a"](2,2,2),vertexFormat:c["a"].POSITION_ONLY})),E=this._attributeLocations=u["a"].createAttributeLocations(p);h.vertexArray=g["a"].fromGeometry({context:n,geometry:p,attributeLocations:E,bufferUsage:d["a"].STATIC_DRAW}),h.renderState=_["a"].fromCache({blending:S["a"].ALPHA_BLEND})}if(!Object(s["a"])(h.shaderProgram)||this._useHdr!==t){var b=new w["a"]({defines:[t?"HDR":""],sources:[v["a"]]});h.shaderProgram=f["a"].fromCache({context:n,vertexShaderSource:C["a"],fragmentShaderSource:b,attributeLocations:this._attributeLocations}),this._useHdr=t}if(Object(s["a"])(this._cubeMap))return h}},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),Object(o["a"])(this)},t["a"]=E},a12c:function(e,t,a){"use strict";var i=a("be18"),r=a("535a"),n=a("2f63"),s=a("7d62"),o=a("c52f"),u=a("6cae"),h=a("c1e2"),c=a("93da"),d=a("52f0"),m=a("0541"),p=a("8b68"),l=a("a894"),_=a("6dc0"),f=a("e90c"),w=a("5770"),g=a("7c5e"),v=a("aeca"),C=a("ef10"),S=a("2a08"),x=a("b08e"),E=a("b7c8"),b=a("29ab"),y=a("a307");function O(e){e=Object(r["a"])(e,o["a"].WGS84),this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=e;var t=1.025,a=i["a"].multiplyByScalar(e.radii,t,new i["a"]);this._scaleMatrix=d["a"].fromScale(a),this._modelMatrix=new d["a"],this._command=new l["a"]({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new i["a"];var n=new i["a"];n.x=e.maximumRadius*t,n.y=e.maximumRadius,n.z=0,this._radiiAndDynamicAtmosphereColor=n;var s=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return s._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return s._hueSaturationBrightness.x=s.hueShift,s._hueSaturationBrightness.y=s.saturationShift,s._hueSaturationBrightness.z=s.brightnessShift,s._hueSaturationBrightness}}}Object.defineProperties(O.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),O.prototype.setDynamicAtmosphereColor=function(e,t){var a=e?t?2:1:0;this._radiiAndDynamicAtmosphereColor.z=a};var M=new d["a"];function P(e){return!(c["a"].equalsEpsilon(e.hueShift,0,c["a"].EPSILON7)&&c["a"].equalsEpsilon(e.saturationShift,0,c["a"].EPSILON7)&&c["a"].equalsEpsilon(e.brightnessShift,0,c["a"].EPSILON7))}O.prototype.update=function(e,t){if(this.show){var a=e.mode;if((a===y["a"].SCENE3D||a===y["a"].MORPHING)&&e.passes.render){var r=d["a"].fromRotationTranslation(e.context.uniformState.inverseViewRotation,i["a"].ZERO,M),s=d["a"].multiplyTransformation(r,x["a"].Y_UP_TO_Z_UP,M),o=d["a"].multiply(this._scaleMatrix,s,M);d["a"].clone(o,this._modelMatrix);var c=e.context,l=P(this),O=e.globeTranslucencyState.translucent,A=this.perFragmentAtmosphere||O||!Object(n["a"])(t)||!t.show,T=this._command;if(!Object(n["a"])(T.vertexArray)){var D=u["a"].createGeometry(new u["a"]({radii:new i["a"](1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:m["a"].POSITION_ONLY}));T.vertexArray=g["a"].fromGeometry({context:c,geometry:D,attributeLocations:h["a"].createAttributeLocations(D),bufferUsage:p["a"].STATIC_DRAW}),T.renderState=_["a"].fromCache({cull:{enabled:!0,face:b["a"].FRONT},blending:E["a"].ALPHA_BLEND,depthMask:!1})}var L=l|A<<2|O<<3;if(L!==this._flags){this._flags=L;var N=[];l&&N.push("COLOR_CORRECT"),A&&N.push("PER_FRAGMENT_ATMOSPHERE"),O&&N.push("GLOBE_TRANSLUCENT");var F=new w["a"]({defines:N.concat("SKY_FROM_SPACE"),sources:[v["a"],S["a"]]}),z=new w["a"]({defines:N.concat("SKY_FROM_SPACE"),sources:[v["a"],C["a"]]});this._spSkyFromSpace=f["a"].fromCache({context:c,vertexShaderSource:F,fragmentShaderSource:z}),F=new w["a"]({defines:N.concat("SKY_FROM_ATMOSPHERE"),sources:[v["a"],S["a"]]}),z=new w["a"]({defines:N.concat("SKY_FROM_ATMOSPHERE"),sources:[v["a"],C["a"]]}),this._spSkyFromAtmosphere=f["a"].fromCache({context:c,vertexShaderSource:F,fragmentShaderSource:z})}var I=e.camera.positionWC,R=i["a"].magnitude(I);return R>this._radiiAndDynamicAtmosphereColor.x?T.shaderProgram=this._spSkyFromSpace:T.shaderProgram=this._spSkyFromAtmosphere,T}}},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),Object(s["a"])(this)},t["a"]=O},b85d:function(e,t,a){"use strict";var i=a("8dfe"),r=a("535a"),n=a("21d7"),s=a("5d5c"),o=a("eace"),u=a("d4ed"),h=a("283e"),c=a("a89b"),d=a("a58e"),m=a("64ac");function p(e){e=Object(r["a"])(e,r["a"].EMPTY_OBJECT),this.defaultAlpha=void 0,this.defaultNightAlpha=void 0,this.defaultDayAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0;var t=u["a"].createIfNeeded(e.url),a=Object(r["a"])(e.rectangle,o["a"].MAX_VALUE),p=new s["a"]({rectangle:a,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=p,this._resource=t,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new n["a"],this._ready=!1,this._readyPromise=d["a"].defer();var l=e.credit;"string"===typeof l&&(l=new i["a"](l)),this._credit=l;var _,f=this;function w(e){f._image=e,f._tileWidth=e.width,f._tileHeight=e.height,f._ready=!0,f._readyPromise.resolve(!0),c["a"].handleSuccess(f._errorEvent)}function g(e){var a="Failed to load image "+t.url+".";_=c["a"].handleError(_,f,f._errorEvent,a,0,0,0,v,e),f._readyPromise.reject(new h["a"](a))}function v(){m["a"].loadImage(null,t).then(w).otherwise(g)}v()}Object.defineProperties(p.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),p.prototype.getTileCredits=function(e,t,a){},p.prototype.requestImage=function(e,t,a,i){return this._image},p.prototype.pickFeatures=function(e,t,a,i,r){},t["a"]=p},c86b:function(e,t,a){"use strict";var i={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4,castShadows:function(e){return e===i.ENABLED||e===i.CAST_ONLY},receiveShadows:function(e){return e===i.ENABLED||e===i.RECEIVE_ONLY},fromCastReceive:function(e,t){return e&&t?i.ENABLED:e?i.CAST_ONLY:t?i.RECEIVE_ONLY:i.DISABLED}};t["a"]=Object.freeze(i)}}]);