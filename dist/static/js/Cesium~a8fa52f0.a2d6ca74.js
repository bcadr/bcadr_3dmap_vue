(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Cesium~a8fa52f0"],{ce35:function(e,t,a){"use strict";var r=a("cef5"),i=a("670c"),n=a("be18"),o=a("a561"),s=a("bef8"),c=a("dc1c"),u=a("bd8d"),l=a("2bb9"),d=a("71ce"),h=a("8dfe"),m=a("535a"),f=a("2f63"),p=a("7d62"),_=a("aee6"),g=a("5e57"),v=a("a734"),b=a("e856"),x=a("974b"),y=a("129b"),O=a("0123"),S=a("0711"),C=a("d69d"),j=a("c67a"),R=a("93da"),M=a("df07"),w=a("52f0"),E=a("e42d"),T=a("1b8d"),A=a("0260"),P=a("d4ed"),L=a("f806"),B=a("daa2"),I=a("f20a"),N=a("8b68"),D=a("a894"),F=a("d289"),U=a("6dc0"),V=a("6c84"),z=a("e90c"),k=a("5770"),q=a("a913"),H=a("03f1"),G=a("23b6"),W=a("7c5e"),K=a("73b5"),Z=a("11d0"),J=a("77d1"),Y=a("6d11"),X=a("38d6"),Q=a("adba"),$=a("5c15"),ee=a("860a"),te=a("a58e"),ae=a("b08e"),re=a("b7c8"),ie=a("43ee"),ne=a("c1f7"),oe=a("06f0"),se=a("08b8"),ce=a("d663"),ue=a("0249"),le=a("2d75"),de=a("568a"),he=a("fbf1"),me=a("442b"),fe=a("6289"),pe=a("1195"),_e=a("e1d8"),ge=a("e8d6"),ve=a("5128a"),be=a("e349"),xe=a("1b40"),ye=a("082a"),Oe=a("d007"),Se=a("a307"),Ce=a("c86b"),je=a("3626"),Re=new n["a"],Me=be["a"].ModelState,we="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01",Ee=R["a"].EPSILON16;function Te(e,t){e._cachedGltf=t}function Ae(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object.defineProperties(Ae.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}}),Ae.prototype.makeReady=function(e){this.gltf=e;for(var t=this.modelsToLoad,a=t.length,r=0;r<a;++r){var i=t[r];i.isDestroyed()||Te(i,this)}this.modelsToLoad=void 0,this.ready=!0};var Pe={},Le={};function Be(e){e=Object(m["a"])(e,m["a"].EMPTY_OBJECT);var t,a=e.cacheKey;if(this._cacheKey=a,this._cachedGltf=void 0,this._releaseGltfJson=Object(m["a"])(e.releaseGltfJson,!1),Object(f["a"])(a)&&Object(f["a"])(Pe[a])&&Pe[a].ready)t=Pe[a],++t.count;else{var o=e.gltf;if(Object(f["a"])(o)){if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),o instanceof Uint8Array){var s=Object($["a"])(o);t=new Ae({gltf:s,ready:!0})}else t=new Ae({gltf:e.gltf,ready:!0});t.count=1,Object(f["a"])(a)&&(Pe[a]=t)}}Te(this,t);var c=Object(m["a"])(e.basePath,"");this._resource=P["a"].createIfNeeded(c);var l=e.credit;"string"===typeof l&&(l=new h["a"](l)),this._credit=l,this._resourceCredits=[],this.show=Object(m["a"])(e.show,!0),this.silhouetteColor=Object(m["a"])(e.silhouetteColor,u["a"].RED),this._silhouetteColor=new u["a"],this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=Object(m["a"])(e.silhouetteSize,0),this.modelMatrix=w["a"].clone(Object(m["a"])(e.modelMatrix,w["a"].IDENTITY)),this._modelMatrix=w["a"].clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=Object(m["a"])(e.scale,1),this._scale=this.scale,this.minimumPixelSize=Object(m["a"])(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=Object(m["a"])(e.heightReference,le["a"].NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;var d=e.scene;this._scene=d,Object(f["a"])(d)&&Object(f["a"])(d.terrainProviderChanged)&&(this._terrainProviderChangedCallback=d.terrainProviderChanged.addEventListener((function(){this._heightChanged=!0}),this)),this._pickObject=e.pickObject,this._allowPicking=Object(m["a"])(e.allowPicking,!0),this._ready=!1,this._readyPromise=te["a"].defer(),this.activeAnimations=new me["a"](this),this.clampAnimations=Object(m["a"])(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=Object(m["a"])(e.incrementallyLoadTextures,!0),this._asynchronous=Object(m["a"])(e.asynchronous,!0),this.shadows=Object(m["a"])(e.shadows,Ce["a"].ENABLED),this._shadows=this.shadows,this.color=u["a"].clone(Object(m["a"])(e.color,u["a"].WHITE)),this._colorPreviousAlpha=1,this.colorBlendMode=Object(m["a"])(e.colorBlendMode,ne["a"].HIGHLIGHT),this.colorBlendAmount=Object(m["a"])(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.referenceMatrix=void 0,this.backFaceCulling=Object(m["a"])(e.backFaceCulling,!0),this.debugShowBoundingVolume=Object(m["a"])(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(m["a"])(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(m["a"])(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=Object(m["a"])(e.upAxis,ae["a"].Y),this._gltfForwardAxis=ae["a"].Z,this._forwardAxis=e.forwardAxis,this.cull=Object(m["a"])(e.cull,!0),this.opaquePass=Object(m["a"])(e.opaquePass,F["a"].OPAQUE),this._computedModelMatrix=new w["a"],this._clippingPlanesMatrix=w["a"].clone(w["a"].IDENTITY),this._iblReferenceFrameMatrix=M["a"].clone(M["a"].IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new r["a"],this._state=Me.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,articulationsByName:void 0,articulationsByStageKey:void 0,stagesByKey:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._dequantizeInShader=Object(m["a"])(e.dequantizeInShader,!0),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._imageBasedLightingFactor=new i["a"](1,1),i["a"].clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this._lightColor=n["a"].clone(e.lightColor),this._luminanceAtZenith=void 0,this.luminanceAtZenith=Object(m["a"])(e.luminanceAtZenith,.2),this._sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._shouldUpdateSpecularMapAtlas=!0,this._specularEnvironmentMapAtlas=void 0,this._useDefaultSphericalHarmonics=!1,this._useDefaultSpecularMaps=!1,this._shouldRegenerateShaders=!1}function Ie(e){return e.stencilBuffer}function Ne(e){return!u["a"].equals(e.color,u["a"].WHITE)||e.colorBlendMode!==ne["a"].HIGHLIGHT}function De(e){var t=e._clippingPlanes;return Object(f["a"])(t)&&t.enabled&&0!==t.length}function Fe(e){var t=Object(x["a"])(e);return"glTF"===t}function Ue(e,t,a){return e._runtime[t][a]}Object.defineProperties(Be.prototype,{gltf:{get:function(){return Object(f["a"])(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){var e=this.modelMatrix;this.heightReference!==le["a"].NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);var t=w["a"].getScale(e,Re),a=Object(f["a"])(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;n["a"].multiplyByScalar(t,a,t);var r=this._scaledBoundingSphere;return r.center=n["a"].multiplyComponents(this._boundingSphere.center,t,r.center),r.radius=n["a"].maximumComponent(t)*this._initialRadius,Object(f["a"])(this._rtcCenter)&&n["a"].add(this._rtcCenter,r.center,r.center),r}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return Object(f["a"])(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=_["a"].clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return Object(f["a"])(this._extensionsUsed)||(this._extensionsUsed=be["a"].getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(f["a"])(this._extensionsRequired)||(this._extensionsRequired=be["a"].getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return Object(f["a"])(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&ie["a"].setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){var t=this._imageBasedLightingFactor;e===t||i["a"].equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.x>0&&0===e.x||0===this._imageBasedLightingFactor.x&&e.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.y>0&&0===e.y||0===this._imageBasedLightingFactor.y&&e.y>0,i["a"].clone(e,this._imageBasedLightingFactor))}},lightColor:{get:function(){return this._lightColor},set:function(e){var t=this._lightColor;e===t||n["a"].equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(f["a"])(t)&&!Object(f["a"])(e)||Object(f["a"])(e)&&!Object(f["a"])(t),this._lightColor=n["a"].clone(e,t))}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){var t=this._luminanceAtZenith;e!==t&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(f["a"])(t)&&!Object(f["a"])(e)||Object(f["a"])(e)&&!Object(f["a"])(t),this._luminanceAtZenith=e)}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){e!==this._sphericalHarmonicCoefficients&&(this._sphericalHarmonicCoefficients=e,this._shouldRegenerateShaders=!0)}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){this._shouldUpdateSpecularMapAtlas=this._shouldUpdateSpecularMapAtlas||e!==this._specularEnvironmentMaps,this._specularEnvironmentMaps=e}},credit:{get:function(){return this._credit}}}),Be.silhouetteSupported=function(e){return Ie(e.context)},Be.fromGltf=function(e){var t=e.url;e=Object(c["a"])(e);var a=P["a"].createIfNeeded(t),r=Object(m["a"])(e.basePath,a.clone()),i=P["a"].createIfNeeded(r),n=Object(m["a"])(e.cacheKey,Le[Object(v["a"])(a.url)]);Object(f["a"])(n)||(n=Object(d["a"])(),Le[Object(v["a"])(a.url)]=n),Object(f["a"])(e.basePath)&&!Object(f["a"])(e.cacheKey)&&(n+=i.url),e.cacheKey=n,e.basePath=i;var o=new Be(e),s=Pe[n];return Object(f["a"])(s)?s.ready||(++s.count,s.modelsToLoad.push(o)):(s=new Ae({ready:!1}),s.count=1,s.modelsToLoad.push(o),Te(o,s),Pe[n]=s,Object(f["a"])(a.headers.Accept)||(a.headers.Accept=we),a.fetchArrayBuffer().then((function(e){var t=new Uint8Array(e);if(Fe(t)){var r=Object($["a"])(t);s.makeReady(r)}else{var i=Object(b["a"])(t);s.makeReady(i)}var n=o._resourceCredits,c=a.credits;if(Object(f["a"])(c))for(var u=c.length,l=0;l<u;l++)n.push(c[l])})).otherwise(be["a"].getFailedLoadFunction(o,"model",a.url))),o},Be._gltfCache=Pe,Be.prototype.getNode=function(e){var t=Ue(this,"nodesByName",e);return Object(f["a"])(t)?t.publicNode:void 0},Be.prototype.getMesh=function(e){return Ue(this,"meshesByName",e)},Be.prototype.getMaterial=function(e){return Ue(this,"materialsByName",e)},Be.prototype.setArticulationStage=function(e,t){var a=Ue(this,"stagesByKey",e),r=Ue(this,"articulationsByStageKey",e);Object(f["a"])(a)&&Object(f["a"])(r)&&(t=R["a"].clamp(t,a.minimumValue,a.maximumValue),R["a"].equalsEpsilon(a.currentValue,t,Ee)||(a.currentValue=t,r.isDirty=!0))};var Ve=new n["a"],ze=new M["a"];function ke(e,t){var a,r=e.currentValue,i=Ve;switch(e.type){case"xRotate":a=M["a"].fromRotationX(R["a"].toRadians(r),ze),w["a"].multiplyByMatrix3(t,a,t);break;case"yRotate":a=M["a"].fromRotationY(R["a"].toRadians(r),ze),w["a"].multiplyByMatrix3(t,a,t);break;case"zRotate":a=M["a"].fromRotationZ(R["a"].toRadians(r),ze),w["a"].multiplyByMatrix3(t,a,t);break;case"xTranslate":i.x=r,i.y=0,i.z=0,w["a"].multiplyByTranslation(t,i,t);break;case"yTranslate":i.x=0,i.y=r,i.z=0,w["a"].multiplyByTranslation(t,i,t);break;case"zTranslate":i.x=0,i.y=0,i.z=r,w["a"].multiplyByTranslation(t,i,t);break;case"xScale":i.x=r,i.y=1,i.z=1,w["a"].multiplyByScale(t,i,t);break;case"yScale":i.x=1,i.y=r,i.z=1,w["a"].multiplyByScale(t,i,t);break;case"zScale":i.x=1,i.y=1,i.z=r,w["a"].multiplyByScale(t,i,t);break;case"uniformScale":w["a"].multiplyByUniformScale(t,r,t);break;default:break}return t}var qe=new w["a"];function He(e){var t=e.gltf,a=e._loadResources;J["a"].buffer(t,(function(e,t){a.buffers[t]=e.extras._pipeline.source}))}function Ge(e,t){return function(a){var r=e._loadResources,i=new Uint8Array(a);--r.pendingBufferLoads,e.gltf.buffers[t].extras._pipeline.source=i}}function We(e){var t=e.gltf.bufferViews,a=e._loadResources.vertexBuffersToCreate;J["a"].bufferView(e.gltf,(function(e,t){e.target===B["a"].ARRAY_BUFFER&&a.enqueue(t)}));var r=e._loadResources.indexBuffersToCreate,i={};J["a"].accessor(e.gltf,(function(e){var a=e.bufferView;if(Object(f["a"])(a)){var n=t[a];n.target!==B["a"].ELEMENT_ARRAY_BUFFER||Object(f["a"])(i[a])||(i[a]=!0,r.enqueue({id:a,componentType:e.componentType}))}}))}function Ke(e){var t=e.gltf;if(Object(X["a"])(t,"KHR_techniques_webgl")){var a=e._sourcePrograms,r=e._sourceTechniques,i=t.extensions.KHR_techniques_webgl.programs;J["a"].technique(t,(function(e,t){r[t]=Object(c["a"])(e);var n=e.program;Object(f["a"])(a[n])||(a[n]=Object(c["a"])(i[n]))}))}}function Ze(e,t,a){return function(r){var i=e._loadResources;i.shaders[a]={source:r,type:t,bufferView:void 0},--i.pendingShaderLoads,e._rendererResources.sourceShaders[a]=r}}function Je(e){var t=e.gltf,a=t.buffers,r=t.bufferViews,i=e._rendererResources.sourceShaders;J["a"].shader(t,(function(t,n){if(Object(f["a"])(t.bufferView)){var o=t.bufferView,s=r[o],c=s.buffer,u=a[c],l=Object(y["a"])(u.extras._pipeline.source,s.byteOffset,s.byteLength);i[n]=l}else if(Object(f["a"])(t.extras._pipeline.source))i[n]=t.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;var d=e._resource.getDerivedResource({url:t.uri});d.fetchText().then(Ze(e,t.type,n)).otherwise(be["a"].getFailedLoadFunction(e,"shader",d.url))}}))}function Ye(e){var t=e._sourceTechniques;for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];e._loadResources.programsToCreate.enqueue({programId:r.program,techniqueId:a})}}function Xe(e){var t={},a={},r={};e._runtime.articulationsByName=t,e._runtime.articulationsByStageKey=a,e._runtime.stagesByKey=r;var i=e.gltf;if(Object(X["a"])(i,"AGI_articulations")&&Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.AGI_articulations)){var n=i.extensions.AGI_articulations.articulations;if(Object(f["a"])(n))for(var o=n.length,s=0;s<o;++s){var u=Object(c["a"])(n[s]);u.nodes=[],u.isDirty=!0,t[u.name]=u;for(var l=u.stages.length,d=0;d<l;++d){var h=u.stages[d];h.currentValue=h.initialValue;var m=u.name+" "+h.name;a[m]=u,r[m]=h}}}}function Qe(e,t){return function(a){var r=e._loadResources;--r.pendingTextureLoads,r.texturesToCreate.enqueue({id:t,image:a,bufferView:a.bufferView,width:a.width,height:a.height,internalFormat:a.internalFormat})}}Be.prototype.applyArticulations=function(){var e=this._runtime.articulationsByName;for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];if(a.isDirty){a.isDirty=!1;for(var r=a.nodes.length,i=0;i<r;++i){for(var n=a.nodes[i],o=w["a"].clone(n.originalMatrix,qe),s=a.stages.length,c=0;c<s;++c){var u=a.stages[c];o=ke(u,o)}n.matrix=o}}}};var $e=/(^data:image\/ktx)|(\.ktx$)/i,et=/(^data:image\/crn)|(\.crn$)/i;function tt(e,t,a){var r,i=e.gltf,n=i.images;J["a"].texture(i,(function(i,o){var s=i.source;Object(f["a"])(i.extensions)&&Object(f["a"])(i.extensions.EXT_texture_webp)&&a&&(s=i.extensions.EXT_texture_webp.source);var c=n[s],u=c.extras,l=c.bufferView,d=c.mimeType;if(r=c.uri,Object(f["a"])(u)&&Object(f["a"])(u.compressedImage3DTiles)){var h=u.compressedImage3DTiles.crunch,m=u.compressedImage3DTiles.s3tc,p=u.compressedImage3DTiles.pvrtc1,_=u.compressedImage3DTiles.etc1;t.s3tc&&Object(f["a"])(h)?(d=h.mimeType,Object(f["a"])(h.bufferView)?l=h.bufferView:r=h.uri):t.s3tc&&Object(f["a"])(m)?(d=m.mimeType,Object(f["a"])(m.bufferView)?l=m.bufferView:r=m.uri):t.pvrtc&&Object(f["a"])(p)?(d=p.mimeType,Object(f["a"])(p.bufferView)?l=p.bufferView:r=p.uri):t.etc1&&Object(f["a"])(_)&&(d=_.mimeType,Object(f["a"])(_.bufferView)?l=_.bufferView:r=_.uri)}if(Object(f["a"])(l))e._loadResources.texturesToCreateFromBufferView.enqueue({id:o,image:void 0,bufferView:l,mimeType:d});else{++e._loadResources.pendingTextureLoads;var g,v=e._resource.getDerivedResource({url:r});g=$e.test(r)?Object(j["a"])(v):et.test(r)?Object(S["a"])(v):v.fetchImage(),g.then(Qe(e,o,s)).otherwise(be["a"].getFailedLoadFunction(e,"image",v.url))}}))}var at=new w["a"];function rt(e){var t={},a={},r=[],i=e._loadResources.skinnedNodesIds,n=e._runtime.articulationsByName;J["a"].node(e.gltf,(function(o,s){var c={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new w["a"],computedMatrix:new w["a"],dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:o.jointName,weights:[],children:[],parents:[],publicNode:void 0};if(c.publicNode=new ge["a"](e,o,c,s,be["a"].getTransform(o)),t[s]=c,a[o.name]=c,Object(f["a"])(o.skin)&&(i.push(s),r.push(c)),Object(f["a"])(o.extensions)&&Object(f["a"])(o.extensions.AGI_articulations)){var u=o.extensions.AGI_articulations.articulationName;if(Object(f["a"])(u)){var l=w["a"].clone(c.publicNode.originalMatrix,at),d=n[u];d.nodes.push(c.publicNode);for(var h=d.stages.length,m=0;m<h;++m){var p=d.stages[m];l=ke(p,l)}c.publicNode.matrix=l}}})),e._runtime.nodes=t,e._runtime.nodesByName=a,e._runtime.skinnedNodes=r}function it(e){var t=e.gltf,a=e._sourceTechniques,r={},i={},n=e._uniformMaps;J["a"].material(t,(function(t,o){n[o]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};var s=new pe["a"](e,t,o);if(Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_techniques_webgl)){var u=t.extensions.KHR_techniques_webgl.technique;s._technique=u,s._program=a[u].program,J["a"].materialValue(t,(function(e,t){Object(f["a"])(s._values)||(s._values={}),s._values[t]=Object(c["a"])(e)}))}r[t.name]=s,i[o]=s})),e._runtime.materialsByName=r,e._runtime.materialsById=i}function nt(e){var t={},a=e._runtime.materialsById;J["a"].mesh(e.gltf,(function(r,i){t[r.name]=new _e["a"](r,a,i),(Object(f["a"])(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&J["a"].meshPrimitive(r,(function(t,a){var r=mt(e,t),n=e._programPrimitives[r];Object(f["a"])(n)||(n={},e._programPrimitives[r]=n),n[i+".primitive."+a]=t}))})),e._runtime.meshesByName=t}var ot=function(){this.id=void 0,this.model=void 0,this.context=void 0};function st(e,t,a){var r=t._loadResources,i=t.gltf.bufferViews,n=i[e];Object(f["a"])(n)||(n=r.createdBufferViews[e]);var o=I["a"].createVertexBuffer({context:a,typedArray:r.getBuffer(n),usage:N["a"].STATIC_DRAW});o.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=o,t._geometryByteLength+=o.sizeInBytes}ot.prototype.set=function(e,t,a){this.id=e,this.model=t,this.context=a},ot.prototype.execute=function(){st(this.id,this.model,this.context)};var ct=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};function ut(e,t,a,r){var i=a._loadResources,n=a.gltf.bufferViews,o=n[e];Object(f["a"])(o)||(o=i.createdBufferViews[e]);var s=I["a"].createIndexBuffer({context:r,typedArray:i.getBuffer(o),usage:N["a"].STATIC_DRAW,indexDatatype:t});s.vertexArrayDestroyable=!1,a._rendererResources.buffers[e]=s,a._geometryByteLength+=s.sizeInBytes}ct.prototype.set=function(e,t,a,r){this.id=e,this.componentType=t,this.model=a,this.context=r},ct.prototype.execute=function(){ut(this.id,this.componentType,this.model,this.context)};var lt=new ot,dt=new ct;function ht(e,t){var a=e._loadResources;if(0===a.pendingBufferLoads){var r,i=t.context,n=a.vertexBuffersToCreate,o=a.indexBuffersToCreate;if(e.asynchronous){while(n.length>0){if(lt.set(n.peek(),e,i),!t.jobScheduler.execute(lt,de["a"].BUFFER))break;n.dequeue()}while(o.length>0){if(r=o.peek(),dt.set(r.id,r.componentType,e,i),!t.jobScheduler.execute(dt,de["a"].BUFFER))break;o.dequeue()}}else{while(n.length>0)st(n.dequeue(),e,i);while(o.length>0)r=o.dequeue(),ut(r.id,r.componentType,e,i)}}}function mt(e,t){var a=e._runtime.materialsById[t.material];if(Object(f["a"])(a))return a._program}function ft(e,t,a){var r,i,n,o=a._programPrimitives[t];if(!Object(f["a"])(o))return e;for(i in o)if(o.hasOwnProperty(i)&&(r=o[i],mt(a,r)===t))break;if(a._programPrimitives[t]=void 0,a.extensionsUsed.WEB3D_quantized_attributes)n=be["a"].modifyShaderForQuantizedAttributes(a.gltf,r,e),a._quantizedUniforms[t]=n.uniforms;else{var s=a._decodedData[i];if(!Object(f["a"])(s))return e;n=be["a"].modifyShaderForDracoQuantizedAttributes(a.gltf,r,e,s.attributes)}return n.shader}function pt(e){return e=k["a"].replaceMain(e,"gltf_blend_main"),e+="uniform vec4 gltf_color; \nuniform float gltf_colorBlend; \nvoid main() \n{ \n    gltf_blend_main(); \n    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n    float highlight = ceil(gltf_colorBlend); \n    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n    gl_FragColor.a *= gltf_color.a; \n} \n",e}function _t(e,t,a){return Object(f["a"])(a)&&(e=a(e,t)),e}var gt=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};function vt(e,t,a){var r=e.programId,i=e.techniqueId,n=t._sourcePrograms[r],o=t._rendererResources.sourceShaders,s=o[n.vertexShader],c=o[n.fragmentShader],u=t._quantizedVertexShaders;if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){var l=u[r];Object(f["a"])(l)||(l=ft(s,r,t),u[r]=l),s=l}var d=_t(s,r,t._vertexShaderLoaded),h=_t(c,r,t._fragmentShaderLoaded);Object(f["a"])(t._uniformMapLoaded)||(h="uniform vec4 czm_pickColor;\n"+h);var m=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(m&&(h="#define USE_IBL_LIGHTING \n\n"+h),Object(f["a"])(t._lightColor)&&(h="#define USE_CUSTOM_LIGHT_COLOR \n\n"+h),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(h=k["a"].replaceMain(h,"non_gamma_corrected_main"),h+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),xe["a"].isSupported(a)){var p=Object(f["a"])(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,_=Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps,g=p||_||m;g&&(h="uniform mat3 gltf_iblReferenceFrameMatrix; \n"+h),Object(f["a"])(t._sphericalHarmonicCoefficients)?h="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+h:t._useDefaultSphericalHarmonics&&(h="#define DIFFUSE_IBL \n"+h),Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?h="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+h:t._useDefaultSpecularMaps&&(h="#define SPECULAR_IBL \n"+h)}Object(f["a"])(t._luminanceAtZenith)&&(h="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+h),xt(r,i,h,d,t,a)}function bt(e,t,a){var r=e.programId,i=e.techniqueId,n=t._sourcePrograms[r],o=t._rendererResources.sourceShaders,s=t._quantizedVertexShaders,c=t.clippingPlanes,u=De(t),l=o[n.vertexShader],d=o[n.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(l=s[r]);var h=d;Ne(t)&&(h=Be._modifyShaderForColor(h)),u&&(h=za(h,c,a));var m=_t(l,r,t._vertexShaderLoaded),p=_t(h,r,t._fragmentShaderLoaded);Object(f["a"])(t._uniformMapLoaded)||(p="uniform vec4 czm_pickColor;\n"+p);var _=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(_&&(p="#define USE_IBL_LIGHTING \n\n"+p),Object(f["a"])(t._lightColor)&&(p="#define USE_CUSTOM_LIGHT_COLOR \n\n"+p),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(p=k["a"].replaceMain(p,"non_gamma_corrected_main"),p+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),xe["a"].isSupported(a)){var g=Object(f["a"])(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,v=Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps,b=g||v||_;b&&(p="uniform mat3 gltf_iblReferenceFrameMatrix; \n"+p),Object(f["a"])(t._sphericalHarmonicCoefficients)?p="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+p:t._useDefaultSphericalHarmonics&&(p="#define DIFFUSE_IBL \n"+p),Object(f["a"])(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?p="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+p:t._useDefaultSpecularMaps&&(p="#define SPECULAR_IBL \n"+p)}Object(f["a"])(t._luminanceAtZenith)&&(p="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+p),xt(r,i,p,m,t,a)}function xt(e,t,a,r,i,n){var o=i._sourceTechniques[t],s=be["a"].createAttributeLocations(o,i._precreatedAttributes);i._rendererResources.programs[e]=z["a"].fromCache({context:n,vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:s})}gt.prototype.set=function(e,t,a){this.programToCreate=e,this.model=t,this.context=a},gt.prototype.execute=function(){vt(this.programToCreate,this.model,this.context)};var yt=new gt;function Ot(e,t){var a=e._loadResources,r=a.programsToCreate;if(0===a.pendingShaderLoads&&0===a.pendingBufferLoads){var i=t.context;if(e.asynchronous)while(r.length>0){if(yt.set(r.peek(),e,i),!t.jobScheduler.execute(yt,de["a"].PROGRAM))break;r.dequeue()}else while(r.length>0)vt(r.dequeue(),e,i)}}function St(e,t){return function(a){e.texturesToCreate.enqueue({id:t.id,image:a,bufferView:void 0}),--e.pendingBufferViewToImage}}function Ct(e){var t=e._loadResources;if(0===t.pendingBufferLoads)while(t.texturesToCreateFromBufferView.length>0){var a=t.texturesToCreateFromBufferView.dequeue(),r=e.gltf,i=r.bufferViews[a.bufferView],n=r.textures[a.id].source,o=be["a"].getFailedLoadFunction(e,"image","id: "+a.id+", bufferView: "+a.bufferView);if("image/ktx"===a.mimeType)Object(j["a"])(t.getBuffer(i)).then(Qe(e,a.id,n)).otherwise(o),++e._loadResources.pendingTextureLoads;else if("image/crn"===a.mimeType)Object(S["a"])(t.getBuffer(i)).then(Qe(e,a.id,n)).otherwise(o),++e._loadResources.pendingTextureLoads;else{var s=St(t,a);Object(C["a"])({uint8Array:t.getBuffer(i),format:a.mimeType,flipY:!1}).then(s).otherwise(o),++t.pendingBufferViewToImage}}}function jt(e){var t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;var a=e._rendererResources.samplers;J["a"].sampler(e.gltf,(function(e,t){a[t]=new V["a"]({wrapS:e.wrapS,wrapT:e.wrapT,minificationFilter:e.minFilter,magnificationFilter:e.magFilter})}))}}var Rt=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};function Mt(e,t,a){var r=t.gltf.textures,i=r[e.id],n=t._rendererResources.samplers,o=n[i.sampler];Object(f["a"])(o)||(o=new V["a"]({wrapS:G["a"].REPEAT,wrapT:G["a"].REPEAT}));for(var s=!1,c=t.gltf.materials,u=c.length,l=0;l<u;++l){var d=c[l];if(Object(f["a"])(d.extensions)&&Object(f["a"])(d.extensions.KHR_techniques_webgl)){var h=d.extensions.KHR_techniques_webgl.values;for(var m in h)if(h.hasOwnProperty(m)&&-1!==m.indexOf("Texture")){var p=h[m];if(p.index===e.id&&Object(f["a"])(p.extensions)&&Object(f["a"])(p.extensions.KHR_texture_transform)){s=!0;break}}}if(s)break}var _=o.wrapS,g=o.wrapT,v=o.minificationFilter;s&&v!==H["a"].LINEAR&&v!==H["a"].NEAREST&&(v=v===H["a"].NEAREST_MIPMAP_NEAREST||v===H["a"].NEAREST_MIPMAP_LINEAR?H["a"].NEAREST:H["a"].LINEAR,o=new V["a"]({wrapS:o.wrapS,wrapT:o.wrapT,textureMinificationFilter:v,textureMagnificationFilter:o.magnificationFilter}));var b,x=e.internalFormat,y=!(Object(f["a"])(x)&&E["a"].isCompressedFormat(x))&&(v===H["a"].NEAREST_MIPMAP_NEAREST||v===H["a"].NEAREST_MIPMAP_LINEAR||v===H["a"].LINEAR_MIPMAP_NEAREST||v===H["a"].LINEAR_MIPMAP_LINEAR),O=y||_===G["a"].REPEAT||_===G["a"].MIRRORED_REPEAT||g===G["a"].REPEAT||g===G["a"].MIRRORED_REPEAT,S=e.image;if(Object(f["a"])(x))b=new q["a"]({context:a,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:x,sampler:o});else if(Object(f["a"])(S)){var C=!R["a"].isPowerOfTwo(S.width)||!R["a"].isPowerOfTwo(S.height);if(O&&C){var j=document.createElement("canvas");j.width=R["a"].nextPowerOfTwo(S.width),j.height=R["a"].nextPowerOfTwo(S.height);var M=j.getContext("2d");M.drawImage(S,0,0,S.width,S.height,0,0,j.width,j.height),S=j}b=new q["a"]({context:a,source:S,pixelFormat:i.internalFormat,pixelDatatype:i.type,sampler:o,flipY:!1}),y&&b.generateMipmap()}Object(f["a"])(b)&&(t._rendererResources.textures[e.id]=b,t._texturesByteLength+=b.sizeInBytes)}Rt.prototype.set=function(e,t,a){this.gltfTexture=e,this.model=t,this.context=a},Rt.prototype.execute=function(){Mt(this.gltfTexture,this.model,this.context)};var wt=new Rt;function Et(e,t){var a=t.context,r=e._loadResources.texturesToCreate;if(e.asynchronous)while(r.length>0){if(wt.set(r.peek(),e,a),!t.jobScheduler.execute(wt,de["a"].TEXTURE))break;r.dequeue()}else while(r.length>0)Mt(r.dequeue(),e,a)}function Tt(e,t){var a,r,i=e._sourceTechniques,n={},o=e._runtime.materialsById[t.material];if(!Object(f["a"])(o))return n;var s=i[o._technique];if(!Object(f["a"])(s))return n;var c=s.attributes,u=e._rendererResources.programs[s.program],l=u._attributeLocations;for(a in l)if(l.hasOwnProperty(a)){var d=c[a];Object(f["a"])(d)&&(r=l[a],n[d.semantic]=r)}var h=e._precreatedAttributes;if(Object(f["a"])(h))for(a in h)h.hasOwnProperty(a)&&(r=l[a],n[a]=r);return n}function At(e,t){for(var a=e.gltf,r=a.skins,i=a.nodes,n=e._runtime.nodes,o=e._loadResources.skinnedNodesIds,s=o.length,c=0;c<s;++c){var u=o[c],l=n[u],d=i[u],h=t[d.skin];l.inverseBindMatrices=h.inverseBindMatrices,l.bindShapeMatrix=h.bindShapeMatrix;for(var m=r[d.skin].joints,f=m.length,p=0;p<f;++p){var _=m[p],g=n[_];l.joints.push(g)}}}function Pt(e){var t=e._loadResources;if(0===t.pendingBufferLoads&&t.createSkins){t.createSkins=!1;var a=e.gltf,r=a.accessors,i={};J["a"].skin(a,(function(t,a){var n,o=r[t.inverseBindMatrices];w["a"].equals(t.bindShapeMatrix,w["a"].IDENTITY)||(n=w["a"].clone(t.bindShapeMatrix)),i[a]={inverseBindMatrices:he["a"].getSkinInverseBindMatrices(e,o),bindShapeMatrix:n}})),At(e,i)}}function Lt(e,t,a,r){return function(i){Object(f["a"])(r)&&(i=e.clampAnimations?r.clampTime(i):r.wrapTime(i),t[a]=r.evaluate(i,t[a]),t.dirtyNumber=e._maxDirtyNumber)}}function Bt(e){var t=e._loadResources;if(t.finishedPendingBufferLoads()&&t.createRuntimeAnimations){t.createRuntimeAnimations=!1,e._runtime.animations=[];var a=e._runtime.nodes,r=e.gltf.accessors;J["a"].animation(e.gltf,(function(t,i){for(var n=t.channels,o=t.samplers,s=Number.MAX_VALUE,c=-Number.MAX_VALUE,u=n.length,l=new Array(u),d=0;d<u;++d){var h=n[d],m=h.target,f=m.path,p=o[h.sampler],_=he["a"].getAnimationParameterValues(e,r[p.input]),g=he["a"].getAnimationParameterValues(e,r[p.output]);s=Math.min(s,_[0]),c=Math.max(c,_[_.length-1]);var v=he["a"].getAnimationSpline(e,i,t,h.sampler,p,_,f,g);l[d]=Lt(e,a[m.node],m.path,v)}e._runtime.animations[i]={name:t.name,startTime:s,stopTime:c,channelEvaluators:l}}))}}function It(e,t){var a=e._loadResources;if(a.finishedBuffersCreation()&&a.finishedProgramCreation()&&a.createVertexArrays){a.createVertexArrays=!1;var r=e._rendererResources.buffers,i=e._rendererResources.vertexArrays,n=e.gltf,o=n.accessors;J["a"].mesh(n,(function(a,s){J["a"].meshPrimitive(a,(function(a,c){var u,l,d,h=[],m=Tt(e,a),p=e._decodedData[s+".primitive."+c];J["a"].meshPrimitiveAttribute(a,(function(e,t){if(u=m[t],Object(f["a"])(u)){if(Object(f["a"])(p)){var a=p.attributes;if(a.hasOwnProperty(t)){var i=a[t];return void h.push({index:u,vertexBuffer:r[i.bufferView],componentsPerAttribute:i.componentsPerAttribute,componentDatatype:i.componentDatatype,normalize:i.normalized,offsetInBytes:i.byteOffset,strideInBytes:i.byteStride})}}var s=o[e],c=Object(f["a"])(s.normalized)&&s.normalized;h.push({index:u,vertexBuffer:r[s.bufferView],componentsPerAttribute:Object(Q["a"])(s.type),componentDatatype:s.componentType,normalize:c,offsetInBytes:s.byteOffset,strideInBytes:Object(Y["a"])(n,s)})}}));var _,g=e._precreatedAttributes;if(Object(f["a"])(g))for(d in g)g.hasOwnProperty(d)&&(u=m[d],Object(f["a"])(u)&&(l=g[d],l.index=u,h.push(l)));if(Object(f["a"])(a.indices)){var v=o[a.indices],b=v.bufferView;Object(f["a"])(p)&&(b=p.bufferView),_=r[b]}i[s+".primitive."+c]=new W["a"]({context:t,attributes:h,indexBuffer:_})}))}))}}function Nt(e){var t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,J["a"].material(e.gltf,(function(t,a){Dt(e,t,a)})))}function Dt(e,t,a){var r=e._rendererResources.renderStates,i=[B["a"].FUNC_ADD,B["a"].FUNC_ADD],n=[B["a"].ONE,B["a"].ONE_MINUS_SRC_ALPHA,B["a"].ONE,B["a"].ONE_MINUS_SRC_ALPHA];Object(f["a"])(t.extensions)&&Object(f["a"])(t.extensions.KHR_blend)&&(i=t.extensions.KHR_blend.blendEquation,n=t.extensions.KHR_blend.blendFactors);var o=!t.doubleSided,s="BLEND"===t.alphaMode;r[a]=U["a"].fromCache({cull:{enabled:o},depthTest:{enabled:!0,func:oe["a"].LESS_OR_EQUAL},depthMask:!s,blending:{enabled:s,equationRgb:i[0],equationAlpha:i[1],functionSourceRgb:n[0],functionDestinationRgb:n[1],functionSourceAlpha:n[2],functionDestinationAlpha:n[3]}})}var Ft={MODEL:function(e,t,a){return function(){return a.computedMatrix}},VIEW:function(e,t,a){return function(){return e.view}},PROJECTION:function(e,t,a){return function(){return e.projection}},MODELVIEW:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r)}},CESIUM_RTC_MODELVIEW:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].setTranslation(r,t._rtcCenterEye,r)}},MODELVIEWPROJECTION:function(e,t,a){var r=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].multiply(e._projection,r,r)}},MODELINVERSE:function(e,t,a){var r=new w["a"];return function(){return w["a"].inverse(a.computedMatrix,r)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,a){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,a){var r=new w["a"],i=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].inverse(r,i)}},MODELVIEWPROJECTIONINVERSE:function(e,t,a){var r=new w["a"],i=new w["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].multiply(e._projection,r,r),w["a"].inverse(r,i)}},MODELINVERSETRANSPOSE:function(e,t,a){var r=new w["a"],i=new M["a"];return function(){return w["a"].inverse(a.computedMatrix,r),w["a"].getMatrix3(r,i),M["a"].transpose(i,i)}},MODELVIEWINVERSETRANSPOSE:function(e,t,a){var r=new w["a"],i=new w["a"],n=new M["a"];return function(){return w["a"].multiplyTransformation(e.view,a.computedMatrix,r),w["a"].inverse(r,i),w["a"].getMatrix3(i,n),M["a"].transpose(n,n)}},VIEWPORT:function(e,t,a){return function(){return e.viewportCartesian4}}};function Ut(e,t,a,r){var i=t._runtime.nodes[e];return Ft[a](r,t,i)}function Vt(e,t,a,r,i,n,o){var s,c,u={},l={};return J["a"].techniqueUniform(a,(function(a,d){var h;if(Object(f["a"])(r)&&Object(f["a"])(r[d]))h=be["a"].createUniformFunction(a.type,r[d],n,o),u[d]=h.func,l[d]=h;else if(Object(f["a"])(a.node))u[d]=Ut(a.node,e,a.semantic,i.uniformState);else if(Object(f["a"])(a.semantic))if("JOINTMATRIX"===a.semantic)s=d;else if("MORPHWEIGHTS"===a.semantic)c=d;else if("ALPHACUTOFF"===a.semantic){var p=t.alphaMode;if(Object(f["a"])(p)&&"MASK"===p){var _=Object(m["a"])(t.alphaCutoff,.5);h=be["a"].createUniformFunction(a.type,_,n,o),u[d]=h.func,l[d]=h}}else u[d]=be["a"].getGltfSemanticUniforms()[a.semantic](i.uniformState,e);else if(Object(f["a"])(a.value)){var g=be["a"].createUniformFunction(a.type,a.value,n,o);u[d]=g.func,l[d]=g}})),{map:u,values:l,jointMatrixUniformName:s,morphWeightsUniformName:c}}function zt(e,t){var a=e._loadResources;if(a.finishedProgramCreation()&&a.createUniformMaps){a.createUniformMaps=!1;var r=e.gltf,i=e._sourceTechniques,n=e._uniformMaps,o=e._rendererResources.textures,s=e._defaultTexture;J["a"].material(r,(function(a,r){var c=e._runtime.materialsById[r],u=i[c._technique],l=c._values,d=Vt(e,a,u,l,t,o,s),h=n[r];if(h.uniformMap=d.map,h.values=d.values,h.jointMatrixUniformName=d.jointMatrixUniformName,h.morphWeightsUniformName=d.morphWeightsUniformName,Object(f["a"])(u.attributes.a_outlineCoordinates)){var m=ve["a"].createTexture(e,t);h.uniformMap.u_outlineTexture=function(){return m}}}))}}function kt(e){return be["a"].createUniformsForDracoQuantizedAttributes(e.attributes)}function qt(e,t){var a=mt(e,t),r=e._quantizedUniforms[a];return be["a"].createUniformsForQuantizedAttributes(e.gltf,t,r)}function Ht(e){return function(){return e}}function Gt(e){return function(){return e.computedJointMatrices}}function Wt(e){return function(){return e.weights}}function Kt(e){return function(){return e.silhouetteColor}}function Zt(e){return function(){return e.silhouetteSize}}function Jt(e){return function(){return e.color}}function Yt(e){return function(){return e._clippingPlanesMatrix}}function Xt(e){return function(){return e._iblReferenceFrameMatrix}}function Qt(e){return function(){var t=e.clippingPlanes;return Object(f["a"])(t)&&t.enabled?t.texture:e._defaultTexture}}function $t(e){return function(){var t=e.clippingPlanes;if(!Object(f["a"])(t))return u["a"].WHITE.withAlpha(0);var a=u["a"].clone(t.edgeColor);return a.alpha=t.edgeWidth,a}}function ea(e){return function(){return ne["a"].getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function ta(e){return function(){return e._imageBasedLightingFactor}}function aa(e){return function(){return e._lightColor}}function ra(e){return function(){return e.luminanceAtZenith}}function ia(e){return function(){return e._sphericalHarmonicCoefficients}}function na(e){return function(){return e._specularEnvironmentMapAtlas.texture}}function oa(e){return function(){return e._specularEnvironmentMapAtlas.texture.dimensions}}function sa(e){return function(){return e._specularEnvironmentMapAtlas.maximumMipmapLevel}}function ca(e,t){switch(e.mode){case T["a"].TRIANGLES:return t/3;case T["a"].TRIANGLE_STRIP:case T["a"].TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function ua(e,t,a,i,o){for(var s=e._nodeCommands,c=e._pickIds,u=e.allowPicking,d=e._runtime.meshesByName,h=e._rendererResources,m=h.vertexArrays,p=h.programs,_=h.renderStates,g=e._uniformMaps,v=e.gltf,b=v.accessors,x=v.meshes,y=t.mesh,S=x[y],C=S.primitives,j=C.length,R=0;R<j;++R){var M,E=C[R],T=b[E.indices],A=e._runtime.materialsById[E.material],P=A._program,L=e._decodedData[y+".primitive."+R],B=E.attributes.POSITION;if(Object(f["a"])(B)){var I=be["a"].getAccessorMinMax(v,B);M=r["a"].fromCornerPoints(n["a"].fromArray(I.min),n["a"].fromArray(I.max))}var N,U,V=m[y+".primitive."+R];if(Object(f["a"])(L))U=L.numberOfIndices,N=0;else if(Object(f["a"])(T))U=T.count,N=T.byteOffset/O["a"].getSizeInBytes(T.componentType);else{var z=b[E.attributes.POSITION];U=z.count,N=0}e._trianglesLength+=ca(E,U);var k=g[E.material],q=k.uniformMap;if(Object(f["a"])(k.jointMatrixUniformName)){var H={};H[k.jointMatrixUniformName]=Gt(a),q=Object(l["a"])(q,H)}if(Object(f["a"])(k.morphWeightsUniformName)){var G={};G[k.morphWeightsUniformName]=Wt(a),q=Object(l["a"])(q,G)}q=Object(l["a"])(q,{gltf_color:Jt(e),gltf_colorBlend:ea(e),gltf_clippingPlanes:Qt(e),gltf_clippingPlanesEdgeStyle:$t(e),gltf_clippingPlanesMatrix:Yt(e),gltf_iblReferenceFrameMatrix:Xt(e),gltf_iblFactor:ta(e),gltf_lightColor:aa(e),gltf_sphericalHarmonicCoefficients:ia(e),gltf_specularMap:na(e),gltf_specularMapSize:oa(e),gltf_maxSpecularLOD:sa(e),gltf_luminanceAtZenith:ra(e)}),Object(f["a"])(e._uniformMapLoaded)&&(q=e._uniformMapLoaded(q,P,a));var W={};e.extensionsUsed.WEB3D_quantized_attributes?W=qt(e,E):e._dequantizeInShader&&Object(f["a"])(L)&&(W=kt(L)),q=Object(l["a"])(q,W);var K=_[E.material],Z=K.blending.enabled,J=e._pickObject;Object(f["a"])(J)||(J={primitive:e,id:e.id,node:a.publicNode,mesh:d[S.name]});var Y,X=Ce["a"].castShadows(e._shadows),Q=Ce["a"].receiveShadows(e._shadows);if(u&&!Object(f["a"])(e._uniformMapLoaded)){Y=i.createPickId(J),c.push(Y);var $={czm_pickColor:Ht(Y.color)};q=Object(l["a"])(q,$)}u&&(Y=Object(f["a"])(e._pickIdLoaded)&&Object(f["a"])(e._uniformMapLoaded)?e._pickIdLoaded():"czm_pickColor");var ee,te=new D["a"]({boundingVolume:new r["a"],cull:e.cull,modelMatrix:new w["a"],primitiveType:E.mode,vertexArray:V,count:U,offset:N,shaderProgram:p[P],castShadows:X,receiveShadows:Q,uniformMap:q,renderState:K,owner:J,pass:Z?F["a"].TRANSLUCENT:e.opaquePass,pickId:Y});o||(ee=D["a"].shallowClone(te),ee.boundingVolume=new r["a"],ee.modelMatrix=new w["a"]);var ae={show:!0,boundingSphere:M,command:te,command2D:ee,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,disableCullingCommand:void 0,disableCullingCommand2D:void 0,programId:P};a.commands.push(ae),s.push(ae)}}function la(e,t,a){var r=e._loadResources;if(r.finishedEverythingButTextureCreation()&&r.createRuntimeNodes){r.createRuntimeNodes=!1;for(var i=[],o=e._runtime.nodes,s=e.gltf,c=s.nodes,u=s.scenes[s.scene],l=u.nodes,d=l.length,h=[],m={},p=0;p<d;++p){h.push({parentRuntimeNode:void 0,gltfNode:c[l[p]],id:l[p]});while(h.length>0){var _=h.pop();m[_.id]=!0;var g=_.parentRuntimeNode,v=_.gltfNode,b=o[_.id];if(0===b.parents.length)if(Object(f["a"])(v.matrix))b.matrix=w["a"].fromColumnMajorArray(v.matrix);else{var x=v.rotation;b.translation=n["a"].fromArray(v.translation),b.rotation=A["a"].unpack(x),b.scale=n["a"].fromArray(v.scale)}Object(f["a"])(g)?(g.children.push(b),b.parents.push(g)):i.push(b),Object(f["a"])(v.mesh)&&ua(e,v,b,t,a);var y=v.children;if(Object(f["a"])(y))for(var O=y.length,S=0;S<O;S++){var C=y[S];m[C]||h.push({parentRuntimeNode:b,gltfNode:c[C],id:y[S]})}}}e._runtime.rootNodes=i,e._runtime.nodes=o}}function da(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&(t+=e[a].sizeInBytes);return t}function ha(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&(t+=e[a].sizeInBytes);return t}function ma(e,t){var a=t.context,r=t.scene3DOnly,i=e._quantizedVertexShaders,n=e._sourceTechniques,o=e._sourcePrograms,s=e._rendererResources,c=s.sourceShaders;for(var u in e._loadRendererResourcesFromCache&&(c=s.sourceShaders=e._cachedRendererResources.sourceShaders),n)if(n.hasOwnProperty(u)){var l=n[u].program,d=o[l],h=c[d.vertexShader];if(be["a"].checkSupportedGlExtensions(d.glExtensions,a),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){var m=i[l];Object(f["a"])(m)||(m=ft(h,l,e),i[l]=m),h=m}h=_t(h,l,e._vertexShaderLoaded)}if(e._loadRendererResourcesFromCache){var p=e._cachedRendererResources;s.buffers=p.buffers,s.vertexArrays=p.vertexArrays,s.programs=p.programs,s.silhouettePrograms=p.silhouettePrograms,s.textures=p.textures,s.samplers=p.samplers,s.renderStates=p.renderStates,Object(f["a"])(e._precreatedAttributes)&&It(e,a),e._cachedGeometryByteLength+=da(p.buffers),e._cachedTexturesByteLength+=ha(p.textures)}else ht(e,t),Ot(e,t),jt(e,a),Ct(e),Et(e,t);Pt(e),Bt(e),e._loadRendererResourcesFromCache||(It(e,a),Nt(e)),zt(e,a),la(e,a,r)}function fa(e,t){var a=e.publicNode,r=a.matrix;a.useMatrix&&Object(f["a"])(r)?w["a"].clone(r,t):Object(f["a"])(e.matrix)?w["a"].clone(e.matrix,t):(w["a"].fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),a.setMatrix(t))}var pa=[],_a=new o["a"],ga=new w["a"];function va(e,t,a,i){var s=e._maxDirtyNumber,c=e._runtime.rootNodes,u=c.length,l=pa,d=e._computedModelMatrix;if(e._mode!==Se["a"].SCENE3D&&!e._ignoreCommands){var h=w["a"].getColumn(d,3,_a);if(o["a"].equals(h,o["a"].UNIT_W)){var m=e.boundingSphere.center,p=L["a"].wgs84To2DModelMatrix(i,m,ga);d=w["a"].multiply(p,d,ga),Object(f["a"])(e._rtcCenter)&&(w["a"].setTranslation(d,o["a"].UNIT_W,d),e._rtcCenter=e._rtcCenter2D)}else d=L["a"].basisTo2D(i,d,ga),e._rtcCenter=e._rtcCenter3D}for(var _=0;_<u;++_){var g=c[_];fa(g,g.transformToRoot),l.push(g);while(l.length>0){g=l.pop();var v=g.transformToRoot,b=g.commands;if(g.dirtyNumber===s||t||a){var x=w["a"].multiplyTransformation(d,v,g.computedMatrix),y=b.length;if(y>0)for(var O=0;O<y;++O){var S=b[O],C=S.command;w["a"].clone(x,C.modelMatrix),r["a"].transform(S.boundingSphere,C.modelMatrix,C.boundingVolume),Object(f["a"])(e._rtcCenter)&&n["a"].add(e._rtcCenter,C.boundingVolume.center,C.boundingVolume.center),C=S.command2D,Object(f["a"])(C)&&e._mode===Se["a"].SCENE2D&&(w["a"].clone(x,C.modelMatrix),C.modelMatrix[13]-=2*R["a"].sign(C.modelMatrix[13])*R["a"].PI*i.ellipsoid.maximumRadius,r["a"].transform(S.boundingSphere,C.modelMatrix,C.boundingVolume))}}var j=g.children;if(Object(f["a"])(j))for(var M=j.length,E=0;E<M;++E){var T=j[E];T.dirtyNumber=Math.max(T.dirtyNumber,g.dirtyNumber),(T.dirtyNumber===s||a)&&(fa(T,T.transformToRoot),w["a"].multiplyTransformation(v,T.transformToRoot,T.transformToRoot)),l.push(T)}}}++e._maxDirtyNumber}var ba=new w["a"];function xa(e){for(var t=e._runtime.skinnedNodes,a=t.length,r=0;r<a;++r){var i=t[r];ba=w["a"].inverseTransformation(i.transformToRoot,ba);for(var n=i.computedJointMatrices,o=i.joints,s=i.bindShapeMatrix,c=i.inverseBindMatrices,u=c.length,l=0;l<u;++l)Object(f["a"])(n[l])||(n[l]=new w["a"]),n[l]=w["a"].multiplyTransformation(ba,o[l].transformToRoot,n[l]),n[l]=w["a"].multiplyTransformation(n[l],c[l],n[l]),Object(f["a"])(s)&&(n[l]=w["a"].multiplyTransformation(n[l],s,n[l]))}}function ya(e){for(var t=e._runtime.rootNodes,a=t.length,r=pa,i=0;i<a;++i){var n=t[i];n.computedShow=n.publicNode.show,r.push(n);while(r.length>0){n=r.pop();for(var o=n.computedShow,s=n.commands,c=s.length,u=0;u<c;++u)s[u].show=o;var l=n.children;if(Object(f["a"])(l))for(var d=l.length,h=0;h<d;++h){var m=l[h];m.computedShow=o&&m.publicNode.show,r.push(m)}}}}function Oa(e,t){var a=e.id;if(e._id!==a){e._id=a;for(var r=e._pickIds,i=r.length,n=0;n<i;++n)r[n].object.id=a}}function Sa(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?T["a"].LINES:T["a"].TRIANGLES,a=e._nodeCommands,r=a.length,i=0;i<r;++i)a[i].command.primitiveType=t}}function Ca(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e.debugShowBoundingVolume,a=e._nodeCommands,r=a.length,i=0;i<r;++i)a[i].command.debugShowBoundingVolume=t}}function ja(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=Ce["a"].castShadows(e.shadows),a=Ce["a"].receiveShadows(e.shadows),r=e._nodeCommands,i=r.length,n=0;n<i;n++){var o=r[n];o.command.castShadows=t,o.command.receiveShadows=a}}}function Ra(e,t){var a=Object(c["a"])(t,!0);return a.cull.enabled=!1,a.depthTest.enabled=!0,a.depthMask=!1,a.blending=re["a"].ALPHA_BLEND,e.opaquePass===F["a"].CESIUM_3D_TILE&&(a.stencilTest=je["a"].setCesium3DTileBit(),a.stencilMask=je["a"].CESIUM_3D_TILE_MASK),U["a"].fromCache(a)}function Ma(e,t){var a=D["a"].shallowClone(t);return a.pass=F["a"].TRANSLUCENT,a.renderState=Ra(e,t.renderState),a}function wa(e,t,a){var r=t.scene3DOnly,i=e.color.alpha;if(i>0&&i<1){var n=e._nodeCommands,o=n.length;if(o>0&&(!Object(f["a"])(n[0].translucentCommand)||a))for(var s=0;s<o;++s){var c=n[s],u=c.command;if(c.translucentCommand=Ma(e,u),!r){var l=c.command2D;c.translucentCommand2D=Ma(e,l)}}}}function Ea(e){var t=Object(c["a"])(e,!0);return t.cull.enabled=!1,U["a"].fromCache(t)}function Ta(e){var t=D["a"].shallowClone(e);return t.renderState=Ea(e.renderState),t}function Aa(e,t,a){var r=t.scene3DOnly,i=e.backFaceCulling;if(!i){var n=e._nodeCommands,o=n.length;if(o>0&&(!Object(f["a"])(n[0].disableCullingCommand)||a))for(var s=0;s<o;++s){var c=n[s],u=c.command;if(c.disableCullingCommand=Ta(u),!r){var l=c.command2D;c.disableCullingCommand2D=Ta(l)}}}}function Pa(e,t){var a=e._rendererResources.programs;for(var r in a)if(a.hasOwnProperty(r)&&a[r]===t)return r}function La(e,t,a){var r=t.vertexShaderSource.sources[0],i=t._attributeLocations,n=e._normalAttributeName;r=k["a"].replaceMain(r,"gltf_silhouette_main"),r+="uniform float gltf_silhouetteSize; \nvoid main() \n{ \n    gltf_silhouette_main(); \n    vec3 n = normalize(czm_normal3D * "+n+"); \n    n.x *= czm_projection[0][0]; \n    n.y *= czm_projection[1][1]; \n    vec4 clip = gl_Position; \n    clip.xy += n.xy * clip.w * gltf_silhouetteSize * czm_pixelRatio / czm_viewport.z; \n    gl_Position = clip; \n}";var o="uniform vec4 gltf_silhouetteColor; \nvoid main() \n{ \n    gl_FragColor = czm_gammaCorrect(gltf_silhouetteColor); \n}";return z["a"].fromCache({context:a.context,vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:i})}function Ba(e,t){return Ie(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&Object(f["a"])(e._normalAttributeName)}function Ia(e){for(var t=e._nodeCommands,a=t.length,r=0;r<a;++r){var i=t[r],n=i.command;if(n.pass===F["a"].TRANSLUCENT)return!0}return!1}function Na(e){return e.color.alpha>0&&e.color.alpha<1}function Da(e){return 0===e.color.alpha}function Fa(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var Ua=0;function Va(e,t){for(var a=++Ua%255,r=Ia(e)||Na(e)||e.silhouetteColor.alpha<1,i=e._rendererResources.silhouettePrograms,n=t.scene3DOnly,o=e._nodeCommands,s=o.length,u=0;u<s;++u){var d=o[u],h=d.command,m=Na(e)?d.translucentCommand:h,p=D["a"].shallowClone(m),_=Object(c["a"])(m.renderState);_.stencilTest={enabled:!0,frontFunction:B["a"].ALWAYS,backFunction:B["a"].ALWAYS,reference:a,mask:-1,frontOperation:{fail:B["a"].KEEP,zFail:B["a"].KEEP,zPass:B["a"].REPLACE},backOperation:{fail:B["a"].KEEP,zFail:B["a"].KEEP,zPass:B["a"].REPLACE}},Da(e)&&(_.colorMask={red:!1,green:!1,blue:!1,alpha:!1},_.depthMask=!1),_=U["a"].fromCache(_),p.renderState=_,d.silhouetteModelCommand=p;var g=D["a"].shallowClone(h);_=Object(c["a"])(h.renderState,!0),_.depthTest.enabled=!0,_.cull.enabled=!1,r&&(g.pass=F["a"].TRANSLUCENT,_.depthMask=!1,_.blending=re["a"].ALPHA_BLEND),_.stencilTest={enabled:!0,frontFunction:B["a"].NOTEQUAL,backFunction:B["a"].NOTEQUAL,reference:a,mask:-1,frontOperation:{fail:B["a"].KEEP,zFail:B["a"].KEEP,zPass:B["a"].KEEP},backOperation:{fail:B["a"].KEEP,zFail:B["a"].KEEP,zPass:B["a"].KEEP}},_=U["a"].fromCache(_);var v=h.shaderProgram,b=Pa(e,v),x=i[b];Object(f["a"])(x)||(x=La(e,v,t),i[b]=x);var y=Object(l["a"])(h.uniformMap,{gltf_silhouetteColor:Kt(e),gltf_silhouetteSize:Zt(e)});if(g.renderState=_,g.shaderProgram=x,g.uniformMap=y,g.castShadows=!1,g.receiveShadows=!1,d.silhouetteColorCommand=g,!n){var O=d.command2D,S=D["a"].shallowClone(p);S.boundingVolume=O.boundingVolume,S.modelMatrix=O.modelMatrix,d.silhouetteModelCommand2D=S;var C=D["a"].shallowClone(g);S.boundingVolume=O.boundingVolume,S.modelMatrix=O.modelMatrix,d.silhouetteColorCommand2D=C}}}function za(e,t,a){return e=k["a"].replaceMain(e,"gltf_clip_main"),e+=Be._getClippingFunction(t,a)+"\n",e+="uniform highp sampler2D gltf_clippingPlanes; \nuniform mat4 gltf_clippingPlanesMatrix; \nuniform vec4 gltf_clippingPlanesEdgeStyle; \nvoid main() \n{ \n    gltf_clip_main(); \n"+Object(ce["a"])("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")+"} \n",e}function ka(e,t,a){if(Ba(e,t)){var r=e._nodeCommands,i=r.length>0&&(Fa(e.color.alpha,e._colorPreviousAlpha)||Fa(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!Object(f["a"])(r[0].silhouetteModelCommand));e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(i||a)&&Va(e,t)}}function qa(e,t){var a=e._clippingPlanes;Object(f["a"])(a)&&a.owner===e&&a.enabled&&a.update(t)}var Ha=new r["a"];function Ga(e,t,a){return Ha.center=e,Ha.radius=t,a.camera.getPixelSize(Ha,a.context.drawingBufferWidth,a.context.drawingBufferHeight)}var Wa=new n["a"],Ka=new s["a"];function Za(e,t){var a=e.scale;if(0!==e.minimumPixelSize){var r=t.context,i=Math.max(r.drawingBufferWidth,r.drawingBufferHeight),o=Object(f["a"])(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(Wa.x=o[12],Wa.y=o[13],Wa.z=o[14],Object(f["a"])(e._rtcCenter)&&n["a"].add(e._rtcCenter,Wa,Wa),e._mode!==Se["a"].SCENE3D){var s=t.mapProjection,c=s.ellipsoid.cartesianToCartographic(Wa,Ka);s.project(c,Wa),n["a"].fromElements(Wa.z,Wa.x,Wa.y,Wa)}var u=e.boundingSphere.radius,l=Ga(Wa,u,t),d=1/l,h=Math.min(d*(2*u),i);h<e.minimumPixelSize&&(a=e.minimumPixelSize*l/(2*e._initialRadius))}return Object(f["a"])(e.maximumScale)?Math.min(e.maximumScale,a):a}function Ja(e){Object(f["a"])(e._cacheKey)&&Object(f["a"])(e._cachedGltf)&&0===--e._cachedGltf.count&&delete Pe[e._cacheKey],e._cachedGltf=void 0}function Ya(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function Xa(e){for(var t in e)e.hasOwnProperty(t)&&e[t].destroy()}function Qa(e){Xa(e.buffers),Xa(e.vertexArrays),Xa(e.programs),Xa(e.silhouettePrograms),Xa(e.textures)}function $a(e,t,a){return function(r){if(e.heightReference===le["a"].RELATIVE_TO_GROUND){var i=t.cartesianToCartographic(r,Ka);i.height+=a.height,t.cartographicToCartesian(i,r)}var n=e._clampedModelMatrix;w["a"].clone(e.modelMatrix,n),n[12]=r.x,n[13]=r.y,n[14]=r.z,e._heightChanged=!0}}function er(e){Object(f["a"])(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);var t=e._scene;if(Object(f["a"])(t)&&Object(f["a"])(t.globe)&&e.heightReference!==le["a"].NONE){var a=t.globe,r=a.ellipsoid,i=e.modelMatrix;Wa.x=i[12],Wa.y=i[13],Wa.z=i[14];var n=r.cartesianToCartographic(Wa);Object(f["a"])(e._clampedModelMatrix)||(e._clampedModelMatrix=w["a"].clone(i,new w["a"]));var o=a._surface;e._removeUpdateHeightCallback=o.updateHeight(n,$a(e,r,n));var c=a.getHeight(n);if(Object(f["a"])(c)){var u=$a(e,r,n);s["a"].clone(n,Ka),Ka.height=c,r.cartographicToCartesian(Ka,Wa),u(Wa)}}else e._clampedModelMatrix=void 0}Ya.prototype.release=function(){if(0===--this.count)return Object(f["a"])(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],Qa(this),Object(p["a"])(this)};var tr=new n["a"],ar=new s["a"];function rr(e,t){var a,r=e.distanceDisplayCondition,i=r.near*r.near,o=r.far*r.far;if(t.mode===Se["a"].SCENE2D){var s=t.camera.frustum.right-t.camera.frustum.left;a=.5*s,a*=a}else{var c=w["a"].getTranslation(e.modelMatrix,tr);if(t.mode===Se["a"].COLUMBUS_VIEW){var u=t.mapProjection,l=u.ellipsoid,d=l.cartesianToCartographic(c,ar);c=u.project(d,c),n["a"].fromElements(c.z,c.x,c.y,c)}a=n["a"].distanceSquared(c,t.camera.positionWC)}return a>=i&&a<=o}var ir=new w["a"],nr=new w["a"],or=new M["a"];function sr(e,t){e.programs!==t.programs&&Xa(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&Xa(e.silhouettePrograms)}function cr(e,t){var a,r=e._rendererResources,i=e._cachedRendererResources;if(sr(r,i),De(e)||Ne(e)||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,r.programs={},r.silhouettePrograms={};var n,o={},s=e._sourceTechniques;for(var c in s)s.hasOwnProperty(c)&&(n=s[c],a=n.program,o[a]||(o[a]=!0,bt({programId:a,techniqueId:c},e,t.context)))}else r.programs=i.programs,r.silhouettePrograms=i.silhouettePrograms;for(var u=r.programs,l=e._nodeCommands,d=l.length,h=0;h<d;++h){var m=l[h];a=m.programId;var p=u[a];m.command.shaderProgram=p,Object(f["a"])(m.command2D)&&(m.command2D.shaderProgram=p)}wa(e,t,!0),Aa(e,t,!0),ka(e,t,!0)}Be.prototype.update=function(e){if(e.mode!==Se["a"].MORPHING)if(g["a"].supportsWebP.initialized){var t=g["a"].supportsWebP(),a=e.context;if(this._defaultTexture=a.defaultTexture,this._state===Me.NEEDS_LOAD&&Object(f["a"])(this.gltf)){var r,i=this.cacheKey;if(Object(f["a"])(i)){a.cache.modelRendererResourceCache=Object(m["a"])(a.cache.modelRendererResourceCache,{});var o=a.cache.modelRendererResourceCache;if(r=o[this.cacheKey],Object(f["a"])(r)){if(!r.ready)return;++r.count,this._loadRendererResourcesFromCache=!0}else r=new Ya(a,i),r.count=1,o[this.cacheKey]=r;this._cachedRendererResources=r}else r=new Ya(a),r.count=1,this._cachedRendererResources=r;if(this._state=Me.LOADING,this._state!==Me.FAILED){var s=this.gltf.extensions;if(Object(f["a"])(s)&&Object(f["a"])(s.CESIUM_RTC)){var c=n["a"].fromArray(s.CESIUM_RTC.center);if(!n["a"].equals(c,n["a"].ZERO)){this._rtcCenter3D=c;var u=e.mapProjection,l=u.ellipsoid,d=l.cartesianToCartographic(this._rtcCenter3D),h=u.project(d);n["a"].fromElements(h.z,h.x,h.y,h),this._rtcCenter2D=h,this._rtcCenterEye=new n["a"],this._rtcCenter=this._rtcCenter3D}}Object(Z["a"])(this.gltf),this._loadResources=new fe["a"],this._loadRendererResourcesFromCache||be["a"].parseBuffers(this,Ge)}}var p=this._loadResources,_=this._incrementallyLoadTextures,v=!1;if(this._state===Me.LOADING){if(0===p.pendingBufferLoads){if(!p.initialized){if(e.brdfLutGenerator.update(e),be["a"].checkSupportedExtensions(this.extensionsRequired,t),be["a"].updateForwardAxis(this),!Object(f["a"])(this.gltf.extras.sourceVersion)){var b=this.gltf;b.extras.sourceVersion=be["a"].getAssetVersion(b),b.extras.sourceKHRTechniquesWebGL=Object(f["a"])(be["a"].getUsedExtensions(b).KHR_techniques_webgl),this._sourceVersion=b.extras.sourceVersion,this._sourceKHRTechniquesWebGL=b.extras.sourceKHRTechniquesWebGL,Object(ee["a"])(b),Object(K["a"])(b);var x={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders};Object(ye["a"])(b,x),Object(Oe["a"])(b,x)}this._sourceVersion=this.gltf.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltf.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&se["a"].hasExtension(this),He(this),Xe(this),Ke(this),this._loadRendererResourcesFromCache||(We(this),Je(this),Ye(this),tt(this,a,t)),it(this),nt(this),rt(this),se["a"].parse(this,a),p.initialized=!0}p.finishedDecoding()||se["a"].decodeModel(this,a).otherwise(be["a"].getFailedLoadFunction(this,"model",this.basePath)),p.finishedDecoding()&&!p.resourcesParsed&&(this._boundingSphere=be["a"].computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,se["a"].cacheDataForModel(this),p.resourcesParsed=!0),p.resourcesParsed&&0===p.pendingShaderLoads&&(ve["a"].outlinePrimitives(this),ma(this,e))}(p.finished()||_&&p.finishedEverythingButTextureCreation())&&(this._state=Me.LOADED,v=!0)}if(Object(f["a"])(p)&&this._state===Me.LOADED&&(_&&!v&&ma(this,e),p.finished())){this._loadResources=void 0;var y=this._rendererResources,O=this._cachedRendererResources;O.buffers=y.buffers,O.vertexArrays=y.vertexArrays,O.programs=y.programs,O.sourceShaders=y.sourceShaders,O.silhouettePrograms=y.silhouettePrograms,O.textures=y.textures,O.samplers=y.samplers,O.renderStates=y.renderStates,O.ready=!0,this._normalAttributeName=be["a"].getAttributeOrUniformBySemantic(this.gltf,"NORMAL"),Object(f["a"])(this._precreatedAttributes)&&(O.vertexArrays={}),this.releaseGltfJson&&Ja(this)}var S=xe["a"].isSupported(a);if(this._shouldUpdateSpecularMapAtlas&&S){if(this._shouldUpdateSpecularMapAtlas=!1,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),this._specularEnvironmentMapAtlas=void 0,Object(f["a"])(this._specularEnvironmentMaps)){this._specularEnvironmentMapAtlas=new xe["a"](this._specularEnvironmentMaps);var C=this;this._specularEnvironmentMapAtlas.readyPromise.then((function(){C._shouldRegenerateShaders=!0})).otherwise((function(e){}))}this._shouldRegenerateShaders=!0}Object(f["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e);var j=!Object(f["a"])(this._specularEnvironmentMapAtlas)&&Object(f["a"])(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,E=!Object(f["a"])(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,T=!Object(f["a"])(this._sphericalHarmonicCoefficients)&&Object(f["a"])(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,A=!Object(f["a"])(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||j||E||T||A,this._useDefaultSpecularMaps=!Object(f["a"])(this._specularEnvironmentMapAtlas)&&Object(f["a"])(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!Object(f["a"])(this._sphericalHarmonicCoefficients)&&Object(f["a"])(e.sphericalHarmonicCoefficients);var P=Ba(this,e),L=Na(this),B=Da(this),I=this.backFaceCulling,N=!Object(f["a"])(this.distanceDisplayCondition)||rr(this,e),D=this.show&&N&&0!==this.scale&&(!B||P);if(D&&this._state===Me.LOADED||v){var F=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;var U=this.modelMatrix,V=e.mode!==this._mode;this._mode=e.mode;var z=!w["a"].equals(this._modelMatrix,U)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||V;if(z||v){w["a"].clone(U,this._modelMatrix),er(this),Object(f["a"])(this._clampedModelMatrix)&&(U=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;var k=Za(this,e),q=this._computedModelMatrix;w["a"].multiplyByUniformScale(U,k,q),this._upAxis===ae["a"].Y?w["a"].multiplyTransformation(q,ae["a"].Y_UP_TO_Z_UP,q):this._upAxis===ae["a"].X&&w["a"].multiplyTransformation(q,ae["a"].X_UP_TO_Z_UP,q),this.forwardAxis===ae["a"].Z&&w["a"].multiplyTransformation(q,ae["a"].Z_UP_TO_X_UP,q)}(F||z||v)&&(va(this,z,v,e.mapProjection),this._dirty=!0,(F||v)&&xa(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,ya(this)),Oa(this,a),Sa(this),Ca(this),ja(this),qa(this,e);var H=this._clippingPlanes,G=0,W=Object(f["a"])(H)&&H.enabled&&H.length>0,J=Object(m["a"])(this.referenceMatrix,U);if(W){var Y=ir;Y=w["a"].multiply(a.uniformState.view3D,J,Y),Y=w["a"].multiply(Y,H.modelMatrix,Y),this._clippingPlanesMatrix=w["a"].inverseTranspose(Y,this._clippingPlanesMatrix),G=H.clippingPlanesState}var X=Object(f["a"])(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics,Q=Object(f["a"])(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps;if(X||Q){var $=or,te=nr;te=w["a"].multiply(a.uniformState.view3D,J,te),$=w["a"].getMatrix3(te,$),$=M["a"].getRotation($,$),this._iblReferenceFrameMatrix=M["a"].transpose($,this._iblReferenceFrameMatrix)}var re=this._shouldRegenerateShaders;re=re||this._clippingPlanesState!==G,this._clippingPlanesState=G;var ie=Ne(this);ie!==this._colorShadingEnabled&&(this._colorShadingEnabled=ie,re=!0),re?cr(this,e):(wa(this,e,!1),Aa(this,e,!1),ka(this,e,!1))}if(v){var ne=this;e.afterRender.push((function(){ne._ready=!0,ne._readyPromise.resolve(ne)}))}else{if(D&&!this._ignoreCommands){var oe,ce,ue,le=e.commandList,de=e.passes,he=this._nodeCommands,me=he.length,pe=e.mapProjection.ellipsoid.maximumRadius*R["a"].PI;if(de.render||de.pick&&this.allowPicking){for(oe=0;oe<me;++oe)if(ce=he[oe],ce.show){var _e=ce.command;if(P?_e=ce.silhouetteModelCommand:L?_e=ce.translucentCommand:I||(_e=ce.disableCullingCommand),le.push(_e),ue=ce.command.boundingVolume,e.mode===Se["a"].SCENE2D&&(ue.center.y+ue.radius>pe||ue.center.y-ue.radius<pe)){var ge=ce.command2D;P?ge=ce.silhouetteModelCommand2D:L?ge=ce.translucentCommand2D:I||(ge=ce.disableCullingCommand2D),le.push(ge)}}if(P&&!de.pick)for(oe=0;oe<me;++oe)ce=he[oe],ce.show&&(le.push(ce.silhouetteColorCommand),ue=ce.command.boundingVolume,e.mode===Se["a"].SCENE2D&&(ue.center.y+ue.radius>pe||ue.center.y-ue.radius<pe)&&le.push(ce.silhouetteColorCommand2D))}}var Ce=this._credit;Object(f["a"])(Ce)&&e.creditDisplay.addCredit(Ce);for(var je=this._resourceCredits,Re=je.length,we=0;we<Re;we++)e.creditDisplay.addCredit(je[we])}}else g["a"].supportsWebP.initialize()},Be.prototype.isDestroyed=function(){return!1},Be.prototype.destroy=function(){Object(f["a"])(this._precreatedAttributes)&&Xa(this._rendererResources.vertexArrays),Object(f["a"])(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),Object(f["a"])(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),Object(f["a"])(this._cachedRendererResources)&&sr(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),se["a"].destroyCachedDataForModel(this);for(var e=this._pickIds,t=e.length,a=0;a<t;++a)e[a].destroy();Ja(this),this._quantizedVertexShaders=void 0;var r=this._clippingPlanes;return Object(f["a"])(r)&&!r.isDestroyed()&&r.owner===this&&r.destroy(),this._clippingPlanes=void 0,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),Object(p["a"])(this)},Be._getClippingFunction=ue["a"],Be._modifyShaderForColor=pt,t["a"]=Be}}]);